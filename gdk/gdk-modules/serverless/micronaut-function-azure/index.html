<!DOCTYPE html>
<html lang="en"><head><style type="text/css">.truste_caIcon_display {display: block !important;}</style><style type="text/css">.truste_cursor_pointer {cursor: pointer;}.truste_border_none {border: none;}</style>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:image" content="https://graal.cloud/gdk/resources/img/graalvm.png">
    <meta name="twitter:widgets:border-color" content="#55acee">

    <link rel="stylesheet" href="https://graal.cloud/gdk/resources/lib/highlight/highlight.min.js">
    <script src="https://graal.cloud/gdk/resources/lib/highlight/highlight.min.js"></script>

    <title>Create and Deploy a Micronaut Gateway Function as an Azure HTTP Function</title>
    <meta name="description" content="The Graal Development Kit for Micronaut (GDK) is a build of a curated set of Micronaut framework modules and their required libraries for building portable c...">
    <meta name="last_modified" content="2024-10-10 16:30:05 +0000">
    <meta name="last_built" content="2024-10-29 09:25:27 +0000">
    <link rel="stylesheet" href="https://graal.cloud/gdk/assets/main.css" >
    <link rel="apple-touch-icon" sizes="180x180" href="https://graal.cloud/gdk/resources/img/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://graal.cloud/gdk/resources/img/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://graal.cloud/gdk/resources/img/favicon/favicon-16x16.png">
    <link rel="manifest" href="https://graal.cloud/gdk/resources/img/favicon/site.webmanifest">
    <link rel="stylesheet" type="text/css" href="https://graal.cloud/gdk/resources/styles/codicon.css" />
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="theme-color" content="#ffffff">
    <meta name="google-site-verification" content="-vRqwa9WYn6AaQGnl88xvrLw6ac4xoKVkZkhanmlRhU">
    <link rel="canonical" href="https://www.graal.cloud/gdk/gdk-modules/database/micronaut-data-jdbc-repository/">

    <!-- TODO: move to stylesheet -->
    <style>
        @media (min-width: 768px) {
            .content {
                padding-top: 60px;
            }
        }

        .colist table {
            border: 0;

            td {
                border: 0;
            }

            tr {
                border: 0;
            }
        }

        .imageblock {
            max-width: 50%;
        }

        main{
            padding-top: 50px !important;
        }

        .content{
            padding-top: 0;
        }

        ul.sectlevel0 > li > a:first-of-type {
            color: #F68831 !important;
            font-weight: 700;
        }

        ul.sectlevel1 > li > a {
            color: #dbe6ff;
            font-weight: 400 !important;
            padding-left: 20px;
            font-size: 14px;
        }

            .conum[data-value]::after {
                content: attr(data-value);
                display: inline-block;
                border: 1px solid;
                -webkit-border-radius: 50%;
                border-radius: 50%;
                text-align: center;
                font-size: .75em;
                width: 1.67em;
                height: 1.67em;
                line-height: 1.67em;
                font-family: "Open Sans", "DejaVu Sans", sans-serif;
                font-style: normal;
                font-weight: bold;
            }
            .conum[data-value]+b {
                display: none;
            }

        .sectlevel1 a.active {
            color: #F68831;
            font-weight: bold;
        }
        .language-bash a {
            color: #d6d6d6 !important;
        }
        .language-bash a:hover {
            color: white !important;
            background-color: #1e2631 !important;
        }
        a.external {
            color: #d6d6d6   !important;
        }
        a.external:hover {
            color: white !important;
            background-color: #1e2631 !important;
        }
    </style>

    <!-- jQuery UI Tabs -->
    <link rel="stylesheet" href="//code.jquery.com/ui/1.14.0/themes/base/jquery-ui.css">
    <link rel="stylesheet" href="https://graal.cloud/gdk/resources/lib/jquery/jquery-ui.css">
    <script type="text/javascript" id="www-widgetapi-script" src="https://www.youtube.com/s/player/a8476471/www-widgetapi.vflset/www-widgetapi.js" async=""></script><script src="https://www.youtube.com/iframe_api"></script><script async="" src="https://tags.bkrtx.com/js/bk-coretag.js"></script><script src="https://graal.cloud/gdk/resources/lib/jquery/jquery-3.7.1.min.js"></script><script src="https://graal.cloud/gdk/resources/lib/bootstrap/js/bootstrap.min.js"></script><script src="https://graal.cloud/gdk/resources/lib/sticky-sidebar/resizeSensor.js"></script><script src="https://graal.cloud/gdk/resources/lib/sticky-sidebar/sticky-sidebar.min.js"></script><script async="" defer="" src="https://buttons.github.io/buttons.js"></script><script async="async" type="text/javascript" src="//consent.trustarc.com/notice?domain=oracle.com&amp;c=teconsent&amp;js=bb&amp;noticeType=bb&amp;text=true&amp;cdn=1&amp;pcookie&amp;gtm=1" crossorigin="" id="truste_0.9548969741402604"></script><script src="https://www.oracle.com/assets/truste-oraclelib.js"></script><script src="https://code.jquery.com/ui/1.14.0/jquery-ui.js"></script></head>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
        const menuLinks = document.querySelectorAll(".sectlevel1 a");

        function highlightMenu() {
            let currentSection = null;

            menuLinks.forEach(link => {
                const section = document.querySelector(link.getAttribute("href"));
                if (section) {
                    const rect = section.getBoundingClientRect();
                    if (rect.top >= 0 && rect.top < window.innerHeight / 2) {
                        currentSection = link;
                    }
                }
            });

            menuLinks.forEach(link => link.classList.remove("active"));

            if (currentSection) {
                currentSection.classList.add("active");
            }
        }

        window.addEventListener("scroll", highlightMenu);
        highlightMenu();

        });</script>
<!-- Add TRUSTe Consent Script and Analytics -->


<!-- jQuery UI Tabs -->

<body class="">
<!-- Start SiteCatalyst code -->
<script language="JavaScript" src="https://www.oracle.com/us/assets/metrics/ora_otn.js"></script><script type="text/javascript" src="https://www.oracleimg.com/us/assets/metrics/ora_code_otn.js"></script><script type="text/javascript" src="https://www.oracleimg.com/us/assets/metrics/ora_code.js"></script>
<!-- End SiteCatalyst code -->

<div class="wrapper wrapper--nofooter">

    <header class="header header--content" role="banner">
        <nav class="menu">
            <div class="menu__row">
                <div>
                    <a href="/gdk/" class="activeMenuItem">
                        <img class="logo-mobile" src="https://graal.cloud/gdk/resources/img/gdk-logo-new.svg" alt="Graal Development Kit for Micronaut logo" style="margin-left: 0px;">
                    </a>
                </div>
                <div class="menu__container">
                    <ul class="menu__list">
                        <li class="menu__item">
                            <a href="/gdk/about/" class="menu__link">About</a>
                        </li>
                        <li class="menu__item">
                            <a href="/gdk/get-started/" class="menu__link">Get Started</a>
                        </li>
                        <li class="menu__item">
                            <div class="stack-container">
                                <a href="#" class="menu__link stack__header">Docs</a>
                                <div class="stack-menu-learn">
                                    <div class="stack-row">
                                        <div class="stack-column">
                                            <div class="stack__item">
                                                <img src="https://graal.cloud/gdk/resources/img/header-navigation/modules.svg">
                                                <a href="/gdk/modules/" class="item-line">Modules</a>
                                            </div>
                                            <div class="stack__item">
                                                <img src="https://graal.cloud/gdk/resources/img/header-navigation/guides.svg">
                                                <a href="/gdk/guides/" class="item-line">Guides</a>
                                            </div>
                                            <div class="stack__item">
                                                <img src="https://graal.cloud/gdk/resources/img/header-navigation/labs.svg">
                                                <a href="/gdk/hands-on-labs/" class="item-line">Hands-On Labs</a>
                                            </div>
                                            <div class="stack__item">
                                                <img src="https://graal.cloud/gdk/resources/img/header-navigation/tools.svg">
                                                <a href="/gdk/vscode-tools/" class="item-line">Tools</a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li class="menu__item">
                            <div class="stack-container">
                                <a href="#" class="menu__link stack__header">Graal Projects</a>
                                <div class="stack-menu">
                                    <div class="stack-row">
                                        <div class="stack-column">
                                            <div class="stack__item">
                                                <img src="https://graal.cloud/gdk/resources/img/header-navigation/graalstack.svg">
                                                <a href="/" class="item-line">Graal</a>
                                            </div>
                                            <div class="stack__item">
                                                <img src="https://graal.cloud/gdk/resources/img/header-navigation/graalvm.svg">
                                                <a href="https://graalvm.org/" class="item-line">GraalVM</a>
                                            </div>
                                            <div class="stack__item">
                                                <img src="https://graal.cloud/gdk/resources/img/header-navigation/graalos.svg">
                                                <a href="/graalos/" class="item-line">GraalOS</a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li class="menu__launch__mobile">
                            <a href="/gdk/launcher/" class="btn-launch btn btn-primary" target="blank">Create App</a>
                        </li>
                    </ul>
                </div>
                <div class="menu__launch">
                    <a href="/gdk/launcher/" class="btn-launch btn btn-primary" target="blank">Create App</a>
                </div>
            </div>

            <div role="button" class="menu-btn menu-btn--menu js-show-menu" tabindex="-1" title="sweet hamburger">
                <div class="hamburger">
                    <div class="inner"></div>
                </div>
            </div>
            <button aria-label="hamburger mobile menu" class="btn btn-mobile-menu js-show-menu">
                <div class="inner"></div>
            </button>
        </nav>


    </header>


    <main class="content" aria-label="Content">
        <div class="wrapper wrapper-content">
            <article>
                <div class="row d-flex flex-wrap">
                    <div class="col-sm-3 docsimpro col-bg">
                        <div class="sidebar-wrap is-affixed" style="height: 473px; position: relative;"><div class="inner-wrapper-sticky" style="position: fixed; top: 74px; left: 0px; width: 300px;">
                            <div class="sidebar">
                                <div class="menuabout">
                                    <img id="sidebarClose" src="https://graal.cloud/gdk/resources/img/arrow_sidebar(close).svg" alt="Expand or collapse sidebar" class="btn-color no-display">
                                    <img id="sidebarOpen" src="https://graal.cloud/gdk/resources/img/arrow_sidebar.svg" alt="Expand or collapse sidebar">
                                </div>

                                                                <div class="toc-floating">
                                <div class="toc-bullets">
                                    <li class="toc-bullets-main">
                                        <a href="/gdk/docs/gdk-modules/serverless/" class="_icon-book">
                                            Serverless
                                        </a>
                                    </li>
                                    <li class="toc-bullets-sub toc-bullets-highlight">
                                        <a href="/gdk/gdk-modules/serverless/micronaut-function-azure/" class="activeMenuItem">
                                            Create and Deploy a Micronaut Gateway Function as an Azure HTTP Function
                                        </a>
                                    </li>
                                    <div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#create-the-gateway-function">1. Create the Gateway Function</a></li>
<li><a href="#run-the-tests">2. Run the Tests</a></li>
<li><a href="#run-the-application">3. Run the Application</a></li>
<li><a href="#set-up-azure-resources">4. Set up Azure Resources</a></li>
<li><a href="#deploy-the-application-to-azure-functions">5. Deploy the Application to Azure Functions</a></li>
<li><a href="#test-the-azure-function">6. Test the Azure Function</a></li>
<li><a href="#create-and-publish-a-native-executable-to-azure-functions">7. Create and Publish a Native Executable to Azure Functions</a></li>
<li><a href="#test-the-azure-function-2">8. Test the Azure Function</a></li>
<li><a href="#clean-up-cloud-resources">9. Clean up Cloud Resources</a></li>
</ul>
</div>
                                </div>
                            </div>


                            </div>
                            <div class="resize-sensor" style="position: absolute; inset: 0px; overflow: hidden; z-index: -1; visibility: hidden;"><div class="resize-sensor-expand" style="position: absolute; left: 0; top: 0; right: 0; bottom: 0; overflow: hidden; z-index: -1; visibility: hidden;"><div style="position: absolute; left: 0px; top: 0px; transition: all 0s ease 0s; width: 100000px; height: 100000px;"></div></div><div class="resize-sensor-shrink" style="position: absolute; left: 0; top: 0; right: 0; bottom: 0; overflow: hidden; z-index: -1; visibility: hidden;"><div style="position: absolute; left: 0; top: 0; transition: 0s; width: 200%; height: 200%"></div></div></div></div></div>
                        <div class="resize-sensor" style="position: absolute; inset: 0px; overflow: hidden; z-index: -1; visibility: hidden;"><div class="resize-sensor-expand" style="position: absolute; left: 0; top: 0; right: 0; bottom: 0; overflow: hidden; z-index: -1; visibility: hidden;"><div style="position: absolute; left: 0px; top: 0px; transition: all 0s ease 0s; width: 100000px; height: 100000px;"></div></div><div class="resize-sensor-shrink" style="position: absolute; left: 0; top: 0; right: 0; bottom: 0; overflow: hidden; z-index: -1; visibility: hidden;"><div style="position: absolute; left: 0; top: 0; transition: 0s; width: 200%; height: 200%"></div></div></div></div>

                    <div class="col-sm-9 docsmod">
                        <div id="content-wrapper" class="docs-content docs-content--with-sidebar"><h1>Create and Deploy a Micronaut Gateway Function as an Azure HTTP Function</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This guide describes how to use the Graal Development Kit for Micronaut (GDK) to create a Micronaut® Gateway Function and deploy it using Azure Functions. The application is compiled into a native executable using GraalVM Native Image and then built into a container image.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>A Micronaut Gateway Function acts as a serverless cloud (HTTP) API gateway function.</p>
</div>
</blockquote>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Azure Functions is a serverless solution that allows you to build robust apps while using less code, and with less infrastructure and lower costs.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>The guide consists of the following steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Use the GDK Launcher to create a Micronaut Gateway Function</p>
</li>
<li>
<p>Create the code to implement the gateway function</p>
</li>
<li>
<p>Deploy the gateway function as a container image to a <a href="https://learn.microsoft.com/en-us/azure/container-registry/">Container Registry in Azure</a></p>
</li>
<li>
<p>Create and deploy an Azure Function based on the container image of the gateway function</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Prerequisites</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>JDK 17 or higher. See <a href="/gdk/get-started/setting-up-desktop/">Setting up Your Desktop</a>.</p>
</li>
<li>
<p>An Azure account. See <a href="/gdk/get-started/setting-up-cloud-accounts/">Setting up Your Cloud Accounts</a>.</p>
</li>
<li>
<p>The Azure CLI. Follow the <a href="https://learn.microsoft.com/cli/azure/install-azure-cli">Azure documentation</a> for installing or updating the latest version of the Azure CLI.</p>
</li>
<li>
<p>An Azure user with sufficient permissions to create and manage <a href="https://learn.microsoft.com/en-us/azure/azure-functions/functions-overview">Azure Functions</a> and <a href="https://learn.microsoft.com/en-us/azure/container-registry/container-registry-intro">Azure Container Registry (ACR)</a>.</p>
</li>
<li>
<p>The Azure Functions Core Tools. Follow the <a href="https://learn.microsoft.com/en-us/azure/azure-functions/functions-run-local?tabs=macos%2Cisolated-process%2Cnode-v4%2Cpython-v2%2Chttp-trigger%2Ccontainer-apps&amp;pivots=programming-language-java">Azure documentation</a> to install the Azure Functions Core Tools.</p>
</li>
<li>
<p>A Docker-API compatible container runtime such as <a href="https://docs.rancherdesktop.io/getting-started/installation/">Rancher Desktop</a> or <a href="https://www.docker.io/gettingstarted/">Docker</a> installed and running.</p>
</li>
<li>
<p>The GDK CLI. See <a href="/gdk/get-started/setting-up-desktop/">Setting up Your Desktop</a>. (Optional.)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Follow the steps below to create the application from scratch. However, you can also download the completed example:</p>
</div>
<div class="gradle-maven-tabs ui-tabs ui-corner-all ui-widget ui-widget-content">
    <ul role="tablist" class="ui-tabs-nav ui-corner-all ui-helper-reset ui-helper-clearfix ui-widget-header">
        <li class="tabs-gradle ui-tabs-tab ui-corner-top ui-state-default ui-tabs-active ui-state-active" role="tab" tabindex="0" aria-controls="gradle" aria-labelledby="ui-id-1" aria-selected="true" aria-expanded="true"><a name="gradle" href="#gradle" tabindex="-1" class="ui-tabs-anchor" id="ui-id-1">Gradle</a></li>
        <li class="tabs-maven ui-tabs-tab ui-corner-top ui-state-default" role="tab" tabindex="-1" aria-controls="maven" aria-labelledby="ui-id-2" aria-selected="false" aria-expanded="false"><a name="maven" href="#maven" tabindex="-1" class="ui-tabs-anchor" id="ui-id-2">Maven</a></li>
    </ul>
    <div id="gradle" aria-labelledby="ui-id-1" role="tabpanel" class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="false">
        <a href="https://github.com/oracle/graal-dev-kit/releases/download/4.9.1.2/4.9.1.2_serverless_azure-serverless-demo-java-gradle.zip">Gradle Azure Serverless Example <img src="https://graal.cloud/gdk/resources/img/gdk_modules/download-archive.png" alt="Download completed example" class="download-img-guides"/></a>
    </div>
    <div id="maven" aria-labelledby="ui-id-2" role="tabpanel" class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="true" style="display: none;">
        <a href="https://github.com/oracle/graal-dev-kit/releases/download/4.9.1.2/4.9.1.2_serverless_azure-serverless-demo-java-maven.zip">Maven Azure Serverless Example <img src="https://graal.cloud/gdk/resources/img/gdk_modules/download-archive.png" alt="Download completed example" class="download-img-guides"/></a>
    </div>
</div>
<div class="paragraph">
<p>The application ZIP file will be downloaded in your default downloads directory. Unzip it and proceed to the next steps.</p>
</div>
<h4 id="a-note-regarding-your-development-environment" class="discrete">A note regarding your development environment</h4>
<div class="paragraph">
<p>Consider using Visual Studio Code, which provides native support for developing applications with the <a href="https://marketplace.visualstudio.com/items?itemName=oracle-labs-graalvm.graal-cloud-native-pack">Graal Development Kit for Micronaut Extension Pack</a>.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Note: If you use IntelliJ IDEA, <a href="/gdk/resources/img/annotationprocessorsintellij.png">enable annotation processing</a>.</p>
</div>
</blockquote>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Windows platform: The GDK guides are compatible with Gradle only. Maven support is coming soon.</p>
</div>
</blockquote>
</div>
</div>
</div>
<div class="sect1">
<h2 id="create-the-gateway-function">1. Create the Gateway Function</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes how to create a Micronaut gateway function for a simple online store. The store provides information about available items and enables the user to order items. An HTTP controller is responsible for the API implementation and a service stores the availability of items.</p>
</div>
<p>Create an application using the GDK Launcher.</p>
<ol>
    <li>
        <p>Open the <a href="https://graal.cloud/gdk/launcher/?advanced=true" target="_blank">GDK Launcher in advanced mode</a>.</p>
    </li>
    <li>Create a new project using the following selections.
        <ul>
            <li><strong>Project Type</strong>: <em>Gateway Function</em></li>
            <li><strong>Project Name</strong>: <em>azure-serverless-demo</em></li>
            <li><strong>Base Package</strong>: <em>com.example</em> (Default)</li>
            <li><strong>Clouds</strong>: <em>Azure</em></li>
            <li><strong>Build Tool</strong>: <em>Gradle (Groovy)</em> or <em>Maven</em></li>
            <li><strong>Language</strong>: <em>Java</em> (Default)</li>
            <li><strong>Test Framework</strong>: <em>JUnit</em> (Default)</li>
            <li><strong>Java Version</strong>: <em>17</em> (Default)</li>
            <li><strong>Micronaut Version</strong>: (Default)</li>
            <li><strong>Cloud Services</strong>: </li>
            <li><strong>Features</strong>: <em>GraalVM Native Image</em>, <em>Micronaut Validation</em></li>
            <li><strong>Sample Code</strong>: <em>No</em></li>
        </ul>
    </li>
    <li>Click <strong>Generate Project</strong>, then click <strong>Download Zip</strong>. The GDK Launcher creates an application with the package <code>com.example</code> in a directory named <em>azure-serverless-demo</em>. The application ZIP file will be downloaded to your default downloads directory. Unzip it, open it in your code editor, and proceed to the next steps.</li>
</ol>
<div class="paragraph">
<p>Alternatively, use the  <a href="/gdk/get-started/using-gdk-cli/">GDK CLI</a> as follows:</p>
</div>
<div class="gradle-maven-tabs ui-tabs ui-corner-all ui-widget ui-widget-content">
    <ul role="tablist" class="ui-tabs-nav ui-corner-all ui-helper-reset ui-helper-clearfix ui-widget-header">
        <li class="tabs-gradle ui-tabs-tab ui-corner-top ui-state-default ui-tabs-active ui-state-active" role="tab" tabindex="0" aria-controls="gradle" aria-labelledby="ui-id-1" aria-selected="true" aria-expanded="true"><a name="gradle" href="#gradle" tabindex="-1" class="ui-tabs-anchor" id="ui-id-1">Gradle</a></li>
        <li class="tabs-maven ui-tabs-tab ui-corner-top ui-state-default" role="tab" tabindex="-1" aria-controls="maven" aria-labelledby="ui-id-2" aria-selected="false" aria-expanded="false"><a name="maven" href="#maven" tabindex="-1" class="ui-tabs-anchor" id="ui-id-2">Maven</a></li>
    </ul>
    <div id="gradle" aria-labelledby="ui-id-1" role="tabpanel" class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="false">
        <pre><code class="language-bash hljs" data-highlighted="yes">gdk create-gateway-function com.example.azure-serverless-demo \
 --clouds=azure \
 --features=graalvm,validation \
 --example-code=false \
 --build=gradle \
 --jdk=17  \
 --lang=java</code><button>Copy</button></pre>
    </div>
    <div id="maven" aria-labelledby="ui-id-2" role="tabpanel" class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="true" style="display: none;">
        <pre><code class="language-bash hljs" data-highlighted="yes">gdk create-gateway-function com.example.azure-serverless-demo \
 --clouds=azure \
 --features=graalvm,validation \
 --example-code=false \
 --build=maven \
 --jdk=17  \
 --lang=java</code><button>Copy</button></pre>
    </div>
</div>
<div class="paragraph">
<p>Open the <em>micronaut-cli.yml</em> file, you can see what features are packaged with the application:</p>
</div>
<pre><code class="language-bash hljs" data-highlighted="yes">features: [app-name, azure-function, azure-function-http, gdk-azure-cloud-gateway-function, gdk-bom, gdk-license, graalvm, http-client, java, java-application, junit, logback, maven, maven-enforcer-plugin, micronaut-http-validation, properties, readme, serialization-jackson, static-resources, validation]</code><button>Copy</button></pre>
<div class="paragraph">
<p>The GDK Launcher creates a multi-module project with two subprojects: <strong>azure</strong> for Microsoft Azure, and <strong>lib</strong> for common code and configuration shared across cloud platforms.
You develop the application logic in the <strong>lib</strong> subproject, and keep the
Microsoft Azure-specific configurations in the <strong>azure</strong> subproject.</p>
</div>
<div class="sect2">
<h3 id="storeitem">1.1. StoreItem</h3>
<div class="paragraph">
<p>Create a <code>StoreItem</code> model to represent an item in the store in the file <em>lib/src/main/java/com/example/StoreItem.java</em> with the following contents:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package com.example;

import io.micronaut.core.annotation.Introspected;
import io.micronaut.core.annotation.NonNull;

import io.micronaut.serde.annotation.Serdeable;
import jakarta.validation.constraints.Min;
import jakarta.validation.constraints.NotBlank;

@Serdeable
@Introspected <i class="conum" data-value="1"></i><b>(1)</b>
public class StoreItem {

    @NotBlank
    @NonNull
    private final String name;

    private final String description;

    @Min(0)
    private int numberInStorage;

    public StoreItem(String name, String description, int numberInStorage) { <i class="conum" data-value="2"></i><b>(2)</b>
        this.name = name;
        this.description = description;
        this.numberInStorage = numberInStorage;
    }

    public String getName() {
        return name;
    }

    public String getDescription() {
        return description;
    }

    public Integer getNumberInStorage() {
        return numberInStorage;
    }

    public void setNumberInStorage(Integer numberInStorage) {
        this.numberInStorage = numberInStorage;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>1</strong> The <a href="https://micronaut-projects.github.io/micronaut-core/latest/api/io/micronaut/core/annotation/Introspected.html"><code>@Introspected</code></a> annotation enables Micronaut to serialize and deserialize the model from different formats including <code>JSON</code>. This provides the ability to use the type inside HTTP requests or responses.</p>
</div>
<div class="paragraph">
<p><strong>2</strong> The model has fields to store the item&#8217;s name, description, and number available.</p>
</div>
</div>
<div class="sect2">
<h3 id="storecontroller">1.2. StoreController</h3>
<div class="paragraph">
<p>Create an HTTP controller in the file <em>lib/src/main/java/com/example/StoreController.java</em>, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package com.example;

import io.micronaut.http.HttpResponse;
import io.micronaut.http.annotation.Controller;
import io.micronaut.http.annotation.Get;
import io.micronaut.http.annotation.PathVariable;
import io.micronaut.http.annotation.Post;
import io.micronaut.http.exceptions.HttpStatusException;

import jakarta.validation.constraints.Min;
import jakarta.validation.constraints.NotBlank;
import jakarta.validation.constraints.NotNull;
import java.util.Collection;
import java.util.stream.Collectors;

import static io.micronaut.http.HttpStatus.BAD_REQUEST;
import static io.micronaut.http.HttpStatus.NOT_FOUND;

@Controller("/store") <i class="conum" data-value="1"></i><b>(1)</b>
class StoreController {

    private final StorageService storageService;

    StoreController(StorageService storageService) {
        this.storageService = storageService;
    } <i class="conum" data-value="2"></i><b>(2)</b>

    @Get("/all") <i class="conum" data-value="3"></i><b>(3)</b>
    Collection&lt;StoreItem&gt; listAllItems() {
        return storageService.getItems();
    }

    @Get("/available") <i class="conum" data-value="4"></i><b>(4)</b>
    Collection&lt;StoreItem&gt; listAvailableItems() {
        return storageService.getItems().stream()
                .filter(i -&gt; i.getNumberInStorage() &gt; 0)
                .collect(Collectors.toList());
    }

    @Post(uri = "/order/{name}/{amount}", consumes = "*/*") <i class="conum" data-value="5"></i><b>(5)</b>
    HttpResponse&lt;StoreItem&gt; orderItem(@NotBlank @PathVariable String name, @Min(1) int amount) {
        if (storageService.findItem(name).isEmpty()) {
            throw new HttpStatusException(NOT_FOUND, "Item '" + name + "' not found");
        }
        try {
            storageService.orderItem(name, amount);
        } catch (StorageService.StorageException e) {
            throw new HttpStatusException(BAD_REQUEST, "Could not order item '" + name + "'. " + e.getMessage());
        }
        return HttpResponse.ok(storageService.findItem(name).orElse(null));
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>1</strong> The class is defined as a controller with the <a href="https://docs.micronaut.io/latest/api/io/micronaut/http/annotation/Controller.html"><code>@Controller</code></a> annotation mapped to the path <code>/store</code>.</p>
</div>
<div class="paragraph">
<p><strong>2</strong> Use <a href="https://docs.micronaut.io/latest/guide/#qualifiers">Micronaut argument injection</a> to inject a <code>StorageService</code> bean by defining it as the constructor argument. You will create the <code>StorageService</code> in next section.</p>
</div>
<div class="paragraph">
<p><strong>3</strong> The <a href="https://docs.micronaut.io/latest/api/io/micronaut/http/annotation/Get.html"><code>@Get</code></a> annotation maps the <code>listAllItems</code> method to an HTTP GET request on <code>/store/all</code>.</p>
</div>
<div class="paragraph">
<p><strong>4</strong> The <a href="https://docs.micronaut.io/latest/api/io/micronaut/http/annotation/Get.html"><code>@Get</code></a> annotation maps the <code>listAvailableItems</code> method to an HTTP GET request on <code>/store/available</code>.</p>
</div>
<div class="paragraph">
<p><strong>5</strong> The <a href="https://docs.micronaut.io/latest/api/io/micronaut/http/annotation/Post.html"><code>@Post</code></a> annotation maps the <code>orderItem</code> method to an HTTP POST request on <code>/store/order/{name}/{amount}</code>. Use the <code>consumes</code> argument to specify which content-types are allowed in the request. Throwing <code>HttpStatusException</code> will set the corresponding HTTP status in the response.</p>
</div>
</div>
<div class="sect2">
<h3 id="storageservice">1.3. StorageService</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create an interface for a service that represents the store&#8217;s inventory in <em>lib/src/main/java/com/example/StorageService.java</em>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package com.example;

import io.micronaut.core.annotation.NonNull;

import jakarta.validation.constraints.Min;
import jakarta.validation.constraints.NotBlank;
import java.util.Collection;
import java.util.Optional;

public interface StorageService { <i class="conum" data-value="1"></i><b>(1)</b>
    Collection&lt;StoreItem&gt; getItems();
    Optional&lt;StoreItem&gt; findItem(@NonNull @NotBlank String name);
    void orderItem(@NonNull @NotBlank String name, @Min(1) int amount);

    class StorageException extends RuntimeException { <i class="conum" data-value="2"></i><b>(2)</b>
        StorageException(String message) {
            super(message);
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>1</strong> The storage service provides information about all the items, finds an items by its name, and can place an order for an item.</p>
</div>
<div class="paragraph">
<p><strong>2</strong> The class includes a custom exception that thrown in case of invalid requests to</p>
</div>
</li>
<li>
<p>Create an implementation of the service interface in <em>lib/src/main/java/com/example/DefaultStorageService.java</em>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package com.example;

import io.micronaut.context.annotation.Requires;
import io.micronaut.core.annotation.NonNull;
import jakarta.inject.Singleton;

import java.util.ArrayList;
import java.util.Collection;
import java.util.List;
import java.util.Optional;

@Singleton <i class="conum" data-value="1"></i><b>(1)</b>
@Requires(missingBeans = StorageService.class) <i class="conum" data-value="2"></i><b>(2)</b>
class DefaultStorageService implements StorageService {

    protected List&lt;StoreItem&gt; items = List.of( <i class="conum" data-value="3"></i><b>(3)</b>
        new StoreItem("chair", "A black chair with 4 legs", 10),
        new StoreItem("table", "A quality dining table", 6),
        new StoreItem("sofa", "A grey sofa", 2),
        new StoreItem("bookshelf", "A futuristic-looking bookshelf", 0)
    );

    @Override
    public Collection&lt;StoreItem&gt; getItems() {
        return items;
    }

    @Override
    public Optional&lt;StoreItem&gt; findItem(@NonNull String name) {
        return items.stream().filter(item -&gt; item.getName().equals(name)).findFirst();
    }

    @Override
    public void orderItem(@NonNull String name, int amount) {
        findItem(name).ifPresentOrElse(item -&gt; {
            if (item.getNumberInStorage() &gt;= amount) {
                item.setNumberInStorage(item.getNumberInStorage() - amount);
            } else {
                throw new StorageException("Insufficient amount in storage");
            }
        }, () -&gt; { throw new StorageException("Item not found in storage"); });
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>1</strong> Use <code>jakarta.inject.Singleton</code> to designate a class as a singleton.</p>
</div>
<div class="paragraph">
<p><strong>2</strong> The <a href="https://docs.micronaut.io/latest/api/io/micronaut/context/annotation/Requires.html"><code>@Requires(missingBeans = StorageService.class)</code></a> annotation specifies that this implementation should only be used if no other implementations could be found.</p>
</div>
<div class="paragraph">
<p><strong>3</strong> The implementation stores the items in a <code>List</code> and populates some sample items in the list.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>If you wish to implement a more advanced <code>StorageService</code> to be used instead of this one, annotate your implementation with <code>@Singleton</code> as shown above. Use the <code>@Requires(env = "azure")</code> annotation to make it specific to Microsoft Azure. Visit the <a href="/gdk/modules/#database">Database Module</a> for details about how to store and manipulate data in a database.</p>
</div>
</div>
<div class="sect2">
<h3 id="tests-to-verify-gateway-function-logic">1.4. Tests to Verify Gateway Function Logic</h3>
<div class="paragraph">
<p>Create a test class for the controller in <em>azure/src/test/java/com/example/StoreControllerTest.java</em>, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package com.example;

import io.micronaut.context.annotation.Property;
import io.micronaut.context.annotation.Requires;
import io.micronaut.http.HttpResponse;
import io.micronaut.http.annotation.Get;
import io.micronaut.http.annotation.Post;
import io.micronaut.http.client.annotation.Client;
import io.micronaut.http.client.exceptions.HttpClientResponseException;
import io.micronaut.test.extensions.junit5.annotation.MicronautTest;
import jakarta.inject.Inject;
import jakarta.inject.Singleton;
import org.junit.jupiter.api.Test;

import java.util.ArrayList;
import java.util.List;

import static io.micronaut.http.HttpStatus.BAD_REQUEST;
import static io.micronaut.http.HttpStatus.NOT_FOUND;
import static io.micronaut.http.HttpStatus.OK;
import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.junit.jupiter.api.Assertions.assertNotNull;
import static org.junit.jupiter.api.Assertions.assertThrows;

@MicronautTest
@Property(name = "use-test-storage-service", value = "true") <i class="conum" data-value="1"></i><b>(1)</b>
class StoreControllerTest {

    @Inject
    StoreClient client;

    @Test
    void testAvailableItems() {
        List&lt;StoreItem&gt; availableItems = client.getAvailable();

        assertEquals(2, availableItems.size());
        assertEquals("pot", availableItems.get(1).getName());
        assertEquals(10, availableItems.get(1).getNumberInStorage());
        assertNotNull(availableItems.get(1).getDescription());
    }

    @Test
    void testNotFoundException() {
        HttpResponse&lt;?&gt; response = client.order("lamp", 1);

        assertEquals(NOT_FOUND, response.getStatus());
    }

    @Test
    void testNotSufficientException() {
        HttpClientResponseException e = assertThrows(HttpClientResponseException.class, () -&gt; {
            client.order("pot", 100);
        });

        assertEquals(BAD_REQUEST, e.getStatus());
    }

    @Test
    void testOrderRequest() {
        StoreItem plate = client.getAll().stream()
            .filter(i -&gt; i.getName().equals("plate"))
            .findFirst().orElse(null);
        assertNotNull(plate);
        assertEquals(100, plate.getNumberInStorage());

        HttpResponse&lt;StoreItem&gt; response = client.order("plate", 10);
        assertEquals(OK, response.getStatus());
        assertNotNull(response.body());
        assertEquals("plate", response.body().getName());
        assertEquals(90, response.body().getNumberInStorage());
    }

    @Singleton
    @Requires(property = "use-test-storage-service", value = "true") <i class="conum" data-value="2"></i><b>(2)</b>
    static class TestStorageService extends DefaultStorageService {
        TestStorageService() {
            items = List.of(
                new StoreItem("plate", "A large plate", 100),
                new StoreItem("pot", "A cooking pot", 10),
                new StoreItem("pan", "A large pan", 0)
            );
        }
    }

    @Client("/store") <i class="conum" data-value="3"></i><b>(3)</b>
    interface StoreClient {
        @Get("/all") <i class="conum" data-value="4"></i><b>(4)</b>
        List&lt;StoreItem&gt; getAll();

        @Get("/available") <i class="conum" data-value="4"></i><b>(4)</b>
        List&lt;StoreItem&gt; getAvailable();

        @Post("/order/{name}/{amount}") <i class="conum" data-value="4"></i><b>(4)</b>
        HttpResponse&lt;StoreItem&gt; order(String name, Integer amount);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>1</strong> Annotate the class with <a href="https://micronaut-projects.github.io/micronaut-test/latest/api/io/micronaut/test/annotation/MicronautTest.html"><code>@MicronautTest</code></a> so the Micronaut framework will initialize the application context. This enables you to inject beans using the Jakarta <code>@Inject</code> annotation and to send requests to the <code>StoreController</code> defined in the application. Configure this test to use an identified environment using the <code>@MicronautTest(environments="test-storage-service")</code> annotation.</p>
</div>
<div class="paragraph">
<p><strong>2</strong> Create a mock implementation of <code>StorageService</code> so that the test is independent of the current state of the storage. The <code>@Requires(env="test-storage-service")</code> annotation specifies that the bean should only be available in the identified environment. (In this case it matches the one identified in the <code>@MicronautTest</code> annotation.)</p>
</div>
<div class="paragraph">
<p><strong>3</strong> Create a <a href="https://docs.micronaut.io/latest/guide/#clientAnnotation">Micronaut Declarative Client</a> with the same <code>/store</code> path to send requests to the controller.</p>
</div>
<div class="paragraph">
<p><strong>4</strong> Create three tests using the defined client and assuming that <code>TestStorageService</code> is used.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="run-the-tests">2. Run the Tests</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Run the tests:</p>
</div>
<div class="gradle-maven-tabs ui-tabs ui-corner-all ui-widget ui-widget-content">
    <ul role="tablist" class="ui-tabs-nav ui-corner-all ui-helper-reset ui-helper-clearfix ui-widget-header">
        <li class="tabs-gradle ui-tabs-tab ui-corner-top ui-state-default ui-tabs-active ui-state-active" role="tab" tabindex="0" aria-controls="gradle" aria-labelledby="ui-id-1" aria-selected="true" aria-expanded="true"><a name="gradle" href="#gradle" tabindex="-1" class="ui-tabs-anchor" id="ui-id-1">Gradle</a></li>
        <li class="tabs-maven ui-tabs-tab ui-corner-top ui-state-default" role="tab" tabindex="-1" aria-controls="maven" aria-labelledby="ui-id-2" aria-selected="false" aria-expanded="false"><a name="maven" href="#maven" tabindex="-1" class="ui-tabs-anchor" id="ui-id-2">Maven</a></li>
    </ul>
    <div id="gradle" aria-labelledby="ui-id-1" role="tabpanel" class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="false">
        <pre><code class="language-bash hljs" data-highlighted="yes">./gradlew :azure:test</code><button>Copy</button></pre>
    </div>
    <div id="maven" aria-labelledby="ui-id-2" role="tabpanel" class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="true" style="display: none;">
        <pre><code class="language-bash hljs" data-highlighted="yes">./mvnw install -pl lib -am
./mvnw mn:test -pl azure</code><button>Copy</button></pre>
    </div>
</div>
<div class="paragraph">
<p>Then open the file <em>azure/build/reports/tests/test/index.html</em> in a browser to view the results.</p>
</div>
<div class="paragraph">
<p>Although you created this gateway function to run on Azure Functions runtime, the tests should run successfully on your local machine.</p>
</div>
<div class="paragraph">
<p>Furthermore, Micronaut has a test implementation that simulates the Azure Functions environment. Since sequential requests to a function may be processed by different instances, Micronaut creates a separate environment for each request in a test.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="run-the-application">3. Run the Application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To run the application, use the following command, which starts the application on port 7071.</p>
</div>
<div class="gradle-maven-tabs ui-tabs ui-corner-all ui-widget ui-widget-content">
    <ul role="tablist" class="ui-tabs-nav ui-corner-all ui-helper-reset ui-helper-clearfix ui-widget-header">
        <li class="tabs-gradle ui-tabs-tab ui-corner-top ui-state-default ui-tabs-active ui-state-active" role="tab" tabindex="0" aria-controls="gradle" aria-labelledby="ui-id-1" aria-selected="true" aria-expanded="true"><a name="gradle" href="#gradle" tabindex="-1" class="ui-tabs-anchor" id="ui-id-1">Gradle</a></li>
        <li class="tabs-maven ui-tabs-tab ui-corner-top ui-state-default" role="tab" tabindex="-1" aria-controls="maven" aria-labelledby="ui-id-2" aria-selected="false" aria-expanded="false"><a name="maven" href="#maven" tabindex="-1" class="ui-tabs-anchor" id="ui-id-2">Maven</a></li>
    </ul>
    <div id="gradle" aria-labelledby="ui-id-1" role="tabpanel" class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="false">
        <pre><code class="language-bash hljs" data-highlighted="yes">./gradlew :azure:azureFunctionsRun</code><button>Copy</button></pre>
    </div>
    <div id="maven" aria-labelledby="ui-id-2" role="tabpanel" class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="true" style="display: none;">
        <pre><code class="language-bash hljs" data-highlighted="yes">./mvnw install -pl lib -am; ./mvnw package azure-functions:run -pl azure</code><button>Copy</button></pre>
    </div>
</div>
<div class="paragraph">
<p>Test the application by accessing its REST endpoints.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Use <code>curl</code> to retrieve all the items:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl http://localhost:7071/store/all</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">[
  {
    "name": "chair",
    "description": "A black chair with 4 legs",
    "numberInStorage": 10
  },
  {
    "name": "table",
    "description": "A quality dining table",
    "numberInStorage": 6
  },
  {
    "name": "sofa",
    "description": "A grey sofa",
    "numberInStorage": 2
  },
  {
    "name": "bookshelf",
    "description": "A futuristic-looking bookshelf",
    "numberInStorage": 0
  }
]</code></pre>
</div>
</div>
</li>
<li>
<p>Get an error when attempting to order too many items:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl -X POST http://localhost:7071/store/order/table/10</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{"message": "Bad Request",
  "_embedded": {
    "errors": [{
      "message": "Could not order item 'table'. Insufficient amount in storage"
    }]
  }, ...
}</code></pre>
</div>
</div>
</li>
<li>
<p>Order an item and print the response status code:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl -X POST -w "\nStatus code: %{http_code}" http://localhost:7071/store/order/table/6</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "name":"table",
  "description":"A quality dining table",
  "numberInStorage":0
}
Status code: 200</code></pre>
</div>
</div>
</li>
<li>
<p>Get the available items:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl http://localhost:7071/store/available</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">[
  {
    "name": "chair",
    "description": "A black chair with 4 legs",
    "numberInStorage": 10
  },
  {
    "name": "sofa",
    "description": "A grey sofa",
    "numberInStorage": 2
  }
]</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="set-up-azure-resources">4. Set up Azure Resources</h2>
<div class="sectionbody">
<div class="paragraph">
<p>First define the environment variables:</p>
</div>
<div class="tabs-doc ui-tabs ui-corner-all ui-widget ui-widget-content" data-name="system">
<div data-value="linux" data-label="Linux and macOS" id="linux" aria-labelledby="ui-id-9" role="tabpanel"
         class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="false" style="">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">  export LOCATION=&lt;Location&gt;    <i class="conum" data-value="1"></i><b>(1)</b>
  export RESOURCE_GROUP_NAME=&lt;ServerlessResourceGroupName&gt;   <i class="conum" data-value="2"></i><b>(2)</b>
  export STORAGE_NAME=&lt;ServerlessStorageName&gt;   <i class="conum" data-value="3"></i><b>(3)</b>
  export FUNCTION_NAME=&lt;FunctionName&gt;   <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
</div>
    <div data-value="windows" data-label="Windows" id="windows" aria-labelledby="ui-id-10" role="tabpanel"
         class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="true" style="display: none;">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">set LOCATION="&lt;Location&gt;"  <i class="conum" data-value="1"></i><b>(1)</b>
set RESOURCE_GROUP_NAME="&lt;ServerlessResourceGroupName&gt;"  <i class="conum" data-value="2"></i><b>(2)</b>
set STORAGE_NAME="&lt;ServerlessStorageName&gt;"  <i class="conum" data-value="3"></i><b>(3)</b>
set FUNCTION_NAME="&lt;FunctionName&gt;"  <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><strong>1</strong> Set location Ex. <em>eastus</em></p>
</div>
<div class="paragraph">
<p><strong>2</strong> Set resource group name Ex. <em>gdkguides</em></p>
</div>
<div class="paragraph">
<p><strong>3</strong> Set storage name Ex. <em>gdkstorage</em></p>
</div>
<div class="paragraph">
<p><strong>4</strong> Set function name Ex. <em>gdkfunction</em></p>
</div>
<div class="sect2">
<h3 id="create-a-resource-group">4.1. Create a Resource Group</h3>
<div class="paragraph">
<p>We recommend that you create a new <a href="https://learn.microsoft.com/en-us/azure/azure-resource-manager/management/overview#resource-groups">resource group</a> for this guide, but you can use an existing resource group instead.</p>
</div>
<div class="paragraph">
<p>Run the <a href="https://learn.microsoft.com/en-us/cli/azure/group?view=azure-cli-latest#az-group-create">az group create</a> command to create a resource group named <em>gdkguides</em> in the <em>eastus</em> region:</p>
</div>
<div class="tabs-doc ui-tabs ui-corner-all ui-widget ui-widget-content" data-name="system">
<div data-value="linux" data-label="Linux and macOS" id="linux" aria-labelledby="ui-id-9" role="tabpanel"
         class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="false" style="">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"><a href="https://learn.microsoft.com/en-us/cli/azure/group?view=azure-cli-latest#az-group-create" class="external" target="_blank" rel="noopener">az group create --location $LOCATION --name $RESOURCE_GROUP_NAME</a></code></pre>
</div>
</div>
</div>
    <div data-value="windows" data-label="Windows" id="windows" aria-labelledby="ui-id-10" role="tabpanel"
         class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="true" style="display: none;">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"><a href="https://learn.microsoft.com/en-us/cli/azure/group?view=azure-cli-latest#az-group-create" class="external" target="_blank" rel="noopener">az group create --location %LOCATION% --name %RESOURCE_GROUP_NAME%</a></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="register-microsoft-containerregistry-as-a-resource-provider">4.2. Register Microsoft.ContainerRegistry as a Resource Provider</h3>
<div class="paragraph">
<p>Run the <a href="https://learn.microsoft.com/cli/azure/provider?view=azure-cli-latest#az-provider-register"><code>az provider register</code></a> command to register <em>Microsoft.ContainerRegistry</em> as a Resource Provider:</p>
</div>
<div class="tabs-doc ui-tabs ui-corner-all ui-widget ui-widget-content" data-name="system">
<div data-value="linux" data-label="Linux and macOS" id="linux" aria-labelledby="ui-id-9" role="tabpanel"
         class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="false" style="">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"><a href="https://learn.microsoft.com/en-us/cli/azure/provider?view=azure-cli-latest#az-provider-register" class="external" target="_blank" rel="noopener">az provider register --namespace 'Microsoft.ContainerRegistry' --wait</a></code></pre>
</div>
</div>
</div>
    <div data-value="windows" data-label="Windows" id="windows" aria-labelledby="ui-id-10" role="tabpanel"
         class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="true" style="display: none;">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"><a href="https://learn.microsoft.com/en-us/cli/azure/provider?view=azure-cli-latest#az-provider-register" class="external" target="_blank" rel="noopener">az provider register --namespace &quot;Microsoft.ContainerRegistry&quot; --wait</a></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This will take a while to execute. Check the status:</p>
</div>
<div class="tabs-doc ui-tabs ui-corner-all ui-widget ui-widget-content" data-name="system">
<div data-value="linux" data-label="Linux and macOS" id="linux" aria-labelledby="ui-id-9" role="tabpanel"
         class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="false" style="">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"><a href="https://learn.microsoft.com/en-us/cli/azure/provider?view=azure-cli-latest#az-provider-show" class="external" target="_blank" rel="noopener">export REGISTRATION_STATE=$(az provider show --namespace Microsoft.ContainerRegistry | jq -r .registrationState)</a></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">echo $REGISTRATION_STATE</code></pre>
</div>
</div>
</div>
    <div data-value="windows" data-label="Windows" id="windows" aria-labelledby="ui-id-10" role="tabpanel"
         class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="true" style="display: none;">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"><a href="https://learn.microsoft.com/en-us/cli/azure/provider?view=azure-cli-latest#az-provider-show" class="external" target="_blank" rel="noopener">az provider show --namespace Microsoft.ContainerRegistry | jq -r &quot;.registrationState&quot; &gt; tmp.txt</a>
set /p REGISTRATION_STATE=&lt;tmp.txt</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">echo %REGISTRATION_STATE%</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Once the <code>"registrationState": "Registering"</code> changes to <code>"registrationState": "Registered"</code>, the registration is complete.</p>
</div>
</div>
<div class="sect2">
<h3 id="register-microsoft-storage-as-a-resource-provider">4.3. Register Microsoft.Storage as a Resource Provider</h3>
<div class="paragraph">
<p>Run the <a href="https://learn.microsoft.com/cli/azure/provider?view=azure-cli-latest#az-provider-register"><code>az provider register</code></a> command to register <em>Microsoft.Storage</em> as a Resource Provider:</p>
</div>
<div class="tabs-doc ui-tabs ui-corner-all ui-widget ui-widget-content" data-name="system">
<div data-value="linux" data-label="Linux and macOS" id="linux" aria-labelledby="ui-id-9" role="tabpanel"
         class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="false" style="">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"><a href="https://learn.microsoft.com/en-us/cli/azure/provider?view=azure-cli-latest#az-provider-register" class="external" target="_blank" rel="noopener">az provider register --namespace 'Microsoft.Storage' --wait</a></code></pre>
</div>
</div>
</div>
    <div data-value="windows" data-label="Windows" id="windows" aria-labelledby="ui-id-10" role="tabpanel"
         class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="true" style="display: none;">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"><a href="https://learn.microsoft.com/en-us/cli/azure/provider?view=azure-cli-latest#az-provider-register" class="external" target="_blank" rel="noopener">az provider register --namespace &quot;Microsoft.Storage&quot; --wait</a></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This will take a while to execute. Check the status:</p>
</div>
<div class="tabs-doc ui-tabs ui-corner-all ui-widget ui-widget-content" data-name="system">
<div data-value="linux" data-label="Linux and macOS" id="linux" aria-labelledby="ui-id-9" role="tabpanel"
         class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="false" style="">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"><a href="https://learn.microsoft.com/en-us/cli/azure/provider?view=azure-cli-latest#az-provider-show" class="external" target="_blank" rel="noopener">export REGISTRATION_STATE=$(az provider show --namespace 'Microsoft.Storage' | jq -r .registrationState)</a></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">echo $REGISTRATION_STATE</code></pre>
</div>
</div>
</div>
    <div data-value="windows" data-label="Windows" id="windows" aria-labelledby="ui-id-10" role="tabpanel"
         class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="true" style="display: none;">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"><a href="https://learn.microsoft.com/en-us/cli/azure/provider?view=azure-cli-latest#az-provider-show" class="external" target="_blank" rel="noopener">az provider show --namespace Microsoft.Storage  | jq -r &quot;.registrationState&quot; &gt; tmp.txt</a>
set /p REGISTRATION_STATE=&lt;tmp.txt</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">echo %REGISTRATION_STATE%</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Once the <code>"registrationState": "Registering"</code> changes to <code>"registrationState": "Registered"</code>, the registration is complete.</p>
</div>
</div>
<div class="sect2">
<h3 id="register-microsoft-web-as-a-resource-provider">4.4. Register Microsoft.Web as a Resource Provider</h3>
<div class="paragraph">
<p>Run the <a href="https://learn.microsoft.com/cli/azure/provider?view=azure-cli-latest#az-provider-register"><code>az provider register</code></a> command to register <em>Microsoft.Web</em> as a Resource Provider:</p>
</div>
<div class="tabs-doc ui-tabs ui-corner-all ui-widget ui-widget-content" data-name="system">
<div data-value="linux" data-label="Linux and macOS" id="linux" aria-labelledby="ui-id-9" role="tabpanel"
         class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="false" style="">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"><a href="https://learn.microsoft.com/en-us/cli/azure/provider?view=azure-cli-latest#az-provider-register" class="external" target="_blank" rel="noopener">az provider register --namespace 'Microsoft.Web' --wait</a></code></pre>
</div>
</div>
</div>
    <div data-value="windows" data-label="Windows" id="windows" aria-labelledby="ui-id-10" role="tabpanel"
         class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="true" style="display: none;">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"><a href="https://learn.microsoft.com/en-us/cli/azure/provider?view=azure-cli-latest#az-provider-register" class="external" target="_blank" rel="noopener">az provider register --namespace &quot;Microsoft.Web&quot; --wait</a></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This will take a while to execute. Check the status:</p>
</div>
<div class="tabs-doc ui-tabs ui-corner-all ui-widget ui-widget-content" data-name="system">
<div data-value="linux" data-label="Linux and macOS" id="linux" aria-labelledby="ui-id-9" role="tabpanel"
         class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="false" style="">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"><a href="https://learn.microsoft.com/en-us/cli/azure/provider?view=azure-cli-latest#az-provider-show" class="external" target="_blank" rel="noopener">export REGISTRATION_STATE=$(az provider show --namespace 'Microsoft.Web' | jq -r .registrationState)</a></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">echo $REGISTRATION_STATE</code></pre>
</div>
</div>
</div>
    <div data-value="windows" data-label="Windows" id="windows" aria-labelledby="ui-id-10" role="tabpanel"
         class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="true" style="display: none;">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"><a href="https://learn.microsoft.com/en-us/cli/azure/provider?view=azure-cli-latest#az-provider-show" class="external" target="_blank" rel="noopener">az provider show --namespace Microsoft.Web  | jq -r &quot;.registrationState&quot; &gt; tmp.txt</a>
set /p REGISTRATION_STATE=&lt;tmp.txt</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">echo %REGISTRATION_STATE%</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Once the <code>"registrationState": "Registering"</code> changes to <code>"registrationState": "Registered"</code>, the registration is complete.</p>
</div>
</div>
<div class="sect2">
<h3 id="create-a-storage-account">4.5. Create a Storage Account</h3>
<div class="paragraph">
<p>Run the <a href="https://learn.microsoft.com/cli/azure/storage/account?view=azure-cli-latest#az-storage-account-create"><code>az storage account create</code></a> command to create a storage account:</p>
</div>
<div class="tabs-doc ui-tabs ui-corner-all ui-widget ui-widget-content" data-name="system">
<div data-value="linux" data-label="Linux and macOS" id="linux" aria-labelledby="ui-id-9" role="tabpanel"
         class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="false" style="">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"><a href="https://learn.microsoft.com/en-us/cli/azure/storage/account?view=azure-cli-latest#az-storage-account-create" class="external" target="_blank" rel="noopener">az storage account create \</a>
   --name $STORAGE_NAME \
   --resource-group $RESOURCE_GROUP_NAME \
   --encryption-services blob \
   --location $LOCATION \
   --sku Standard_ZRS</code></pre>
</div>
</div>
</div>
    <div data-value="windows" data-label="Windows" id="windows" aria-labelledby="ui-id-10" role="tabpanel"
         class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="true" style="display: none;">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"><a href="https://learn.microsoft.com/en-us/cli/azure/storage/account?view=azure-cli-latest#az-storage-account-create" class="external" target="_blank" rel="noopener">az storage account create &#94;</a>
   --name %STORAGE_NAME% ^
   --resource-group %RESOURCE_GROUP_NAME% ^
   --encryption-services blob ^
   --location %LOCATION% ^
   --sku Standard_ZRS</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="create-an-azure-function">4.6. Create an Azure Function</h3>
<div class="paragraph">
<p>Run the <a href="https://learn.microsoft.com/en-us/cli/azure/functionapp?view=azure-cli-latest#az-functionapp-create"><code>az functionapp create</code></a> command to create an Azure function:</p>
</div>
<div class="tabs-doc ui-tabs ui-corner-all ui-widget ui-widget-content" data-name="system">
<div data-value="linux" data-label="Linux and macOS" id="linux" aria-labelledby="ui-id-9" role="tabpanel"
         class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="false" style="">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"><a href="https://learn.microsoft.com/en-us/cli/azure/functionapp?view=azure-cli-latest#az-functionapp-create" class="external" target="_blank" rel="noopener">export APP_SERVICE_PLAN_ID=$(az functionapp create \</a>
    --name $FUNCTION_NAME \
    --resource-group $RESOURCE_GROUP_NAME \
    --storage-account $STORAGE_NAME \
    --consumption-plan-location $LOCATION \
    --os-type linux \
    --runtime java \
    --runtime-version 17 \
    --functions-version 4  \
    --disable-app-insights | jq -r '.serverFarmId')</code></pre>
</div>
</div>
</div>
    <div data-value="windows" data-label="Windows" id="windows" aria-labelledby="ui-id-10" role="tabpanel"
         class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="true" style="display: none;">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"><a href="https://learn.microsoft.com/en-us/cli/azure/functionapp?view=azure-cli-latest#az-functionapp-create" class="external" target="_blank" rel="noopener">az functionapp create &#94;</a>
    --name %FUNCTION_NAME% ^
    --resource-group %RESOURCE_GROUP_NAME% ^
    --storage-account %STORAGE_NAME% ^
    --consumption-plan-location %LOCATION% ^
    --os-type linux ^
    --runtime java ^
    --runtime-version 17 ^
    --functions-version 4  ^
    --disable-app-insights | jq -r '.serverFarmId') &gt; tmp.txt
set /p APP_SERVICE_PLAN_ID=&lt;tmp.txt</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The underlying App Service plan might take a few minutes to get created. Run <a href="https://learn.microsoft.com/en-us/cli/azure/functionapp/plan?view=azure-cli-latest#az-functionapp-plan-show"><code>az functionapp plan show</code></a> to check if it&#8217;s created:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"><a href="https://learn.microsoft.com/en-us/cli/azure/functionapp/plan?view=azure-cli-latest#az-functionapp-plan-show" class="external" target="_blank" rel="noopener">az functionapp plan show --ids $APP_SERVICE_PLAN_ID</a></code></pre>
</div>
</div>
<div class="paragraph">
<p>If it returns an error or empty result, wait a minute and try again. Once it shows the plan information, you can proceed.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="deploy-the-application-to-azure-functions">5. Deploy the Application to Azure Functions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Follow these steps to publish the function on Azure Functions</p>
</div>
<div class="gradle-maven-tabs ui-tabs ui-corner-all ui-widget ui-widget-content">
    <ul role="tablist" class="ui-tabs-nav ui-corner-all ui-helper-reset ui-helper-clearfix ui-widget-header">
        <li class="tabs-gradle ui-tabs-tab ui-corner-top ui-state-default ui-tabs-active ui-state-active" role="tab" tabindex="0" aria-controls="gradle" aria-labelledby="ui-id-1" aria-selected="true" aria-expanded="true"><a name="gradle" href="#gradle" tabindex="-1" class="ui-tabs-anchor" id="ui-id-1">Gradle</a></li>
        <li class="tabs-maven ui-tabs-tab ui-corner-top ui-state-default" role="tab" tabindex="-1" aria-controls="maven" aria-labelledby="ui-id-2" aria-selected="false" aria-expanded="false"><a name="maven" href="#maven" tabindex="-1" class="ui-tabs-anchor" id="ui-id-2">Maven</a></li>
    </ul>
    <div id="gradle" aria-labelledby="ui-id-1" role="tabpanel" class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="false">
<div class="paragraph">
<p>Modify the <em>azure/build.gradle</em> file and set the <code>azurefunctions</code> extension values as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy"> azurefunctions {
     resourceGroup = [RESOURCE_GROUP_NAME]
     appName = [FUNCTION_NAME]
     pricingTier = "Consumption"
     region = [LOCATION]
     runtime {
         os = "linux"
         javaVersion = "17"
     }
     localDebug = "transport=dt_socket,server=y,suspend=n,address=5005"
 }</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Replace <code>[FUNCTION_NAME]</code>, <code>[LOCATION]</code> and <code>[RESOURCE_GROUP_NAME]</code> with their corresponding values.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Run the following command to deploy the application</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./gradlew :azure:azureFunctionsDeploy</code></pre>
</div>
</div>
</div>
    <div id="maven" aria-labelledby="ui-id-2" role="tabpanel" class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="true" style="display: none;">
<div class="paragraph">
<p>Edit <em>azure/pom.xml</em> file as follows</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml"> &lt;properties&gt;
   ...
   &lt;functionAppName&gt;[FUNCTION_NAME]&lt;/functionAppName&gt;
   &lt;functionAppRegion&gt;[LOCATION]&lt;/functionAppRegion&gt;
   &lt;functionResourceGroup&gt;[RESOURCE_GROUP_NAME]&lt;/functionResourceGroup&gt;
   &lt;functionRuntimeJavaVersion&gt;17&lt;/functionRuntimeJavaVersion&gt;
   &lt;functionRuntimeOs&gt;linux&lt;/functionRuntimeOs&gt;
   ...
 &lt;/properties&gt;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Replace <code>[FUNCTION_NAME]</code>, <code>[LOCATION]</code> and <code>[RESOURCE_GROUP_NAME]</code> with their corresponding values.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Run the following command to deploy the application</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./mvnw install -pl lib -am; ./mvnw package azure-functions:deploy -pl azure</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If you visit <strong>https://[FUNCTION_NAME].azurewebsites.net</strong> you will get an HTML page informing you that the function is up and running.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="test-the-azure-function">6. Test the Azure Function</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now the application is deployed to Azure, you can test it by sending requests.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Use <code>curl</code> to retrieve all the items:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl https://$FUNCTION_NAME.azurewebsites.net/store/all</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">[
  {
    "name": "chair",
    "description": "A black chair with 4 legs",
    "numberInStorage": 10
  },
  {
    "name": "table",
    "description": "A quality dining table",
    "numberInStorage": 6
  },
  {
    "name": "sofa",
    "description": "A grey sofa",
    "numberInStorage": 2
  },
  {
    "name": "bookshelf",
    "description": "A futuristic-looking bookshelf",
    "numberInStorage": 0
  }
]</code></pre>
</div>
</div>
</li>
<li>
<p>Get an error when attempting to order too many items:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl -X POST https://$FUNCTION_NAME.azurewebsites.net/store/order/table/10</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{"message": "Bad Request",
  "_embedded": {
    "errors": [{
      "message": "Could not order item 'table'. Insufficient amount in storage"
    }]
  }, ...
}</code></pre>
</div>
</div>
</li>
<li>
<p>Order an item and print the response status code:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl -X POST -w "\nStatus code: %{http_code}" https://$FUNCTION_NAME.azurewebsites.net/store/order/table/6</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "name":"table",
  "description":"A quality dining table",
  "numberInStorage":0
}
Status code: 200</code></pre>
</div>
</div>
</li>
<li>
<p>Get the available items:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl https://$FUNCTION_NAME.azurewebsites.net/store/available</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">[
  {
    "name": "chair",
    "description": "A black chair with 4 legs",
    "numberInStorage": 10
  },
  {
    "name": "sofa",
    "description": "A grey sofa",
    "numberInStorage": 2
  }
]</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="create-and-publish-a-native-executable-to-azure-functions">7. Create and Publish a Native Executable to Azure Functions</h2>
<div class="sectionbody">
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Note: Azure Functions (and Azure Container Apps/Registry) currently support only Linux-based x86-64 (linux/amd64) container images. You cannot deploy an ARM-based container image.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Set the following environment variables:</p>
</div>
<div class="tabs-doc ui-tabs ui-corner-all ui-widget ui-widget-content" data-name="system">
<div data-value="linux" data-label="Linux and macOS" id="linux" aria-labelledby="ui-id-9" role="tabpanel"
         class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="false" style="">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">export DOCKER_IMAGE_NAME=&lt;DockerImageName&gt;    <i class="conum" data-value="1"></i><b>(1)</b>
export REPO_NAME=&lt;RepoName&gt;     <i class="conum" data-value="2"></i><b>(2)</b>
export FUNCTION_NAME_NATIVE=&lt;FunctionNameNative&gt;     <i class="conum" data-value="3"></i><b>(3)</b>
export APP_SERVICE_PLAN=&lt;AppServicePlan&gt;     <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
</div>
    <div data-value="windows" data-label="Windows" id="windows" aria-labelledby="ui-id-10" role="tabpanel"
         class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="true" style="display: none;">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">set DOCKER_IMAGE_NAME="&lt;DockerImageName&gt;"   <i class="conum" data-value="1"></i><b>(1)</b>
set REPO_NAME="&lt;RepoName&gt;"   <i class="conum" data-value="2"></i><b>(2)</b>
set FUNCTION_NAME_NATIVE="&lt;FunctionNameNative&gt;"   <i class="conum" data-value="3"></i><b>(3)</b>
set APP_SERVICE_PLAN="&lt;AppServicePlan&gt;"  <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><strong>1</strong> Set docker image name Ex. <em>gdkAzureFunction</em></p>
</div>
<div class="paragraph">
<p><strong>2</strong> Set repo name Ex. <em>gdkrepo</em></p>
</div>
<div class="paragraph">
<p><strong>3</strong> Set native function name Ex. <em>gdkfunction-native</em></p>
</div>
<div class="paragraph">
<p><strong>4</strong> Set app service name Ex. <em>gdkAppServicePlan</em></p>
</div>
<div class="sect2">
<h3 id="configure-the-application">7.1. Configure the Application</h3>
<div class="gradle-maven-tabs ui-tabs ui-corner-all ui-widget ui-widget-content">
    <ul role="tablist" class="ui-tabs-nav ui-corner-all ui-helper-reset ui-helper-clearfix ui-widget-header">
        <li class="tabs-gradle ui-tabs-tab ui-corner-top ui-state-default ui-tabs-active ui-state-active" role="tab" tabindex="0" aria-controls="gradle" aria-labelledby="ui-id-1" aria-selected="true" aria-expanded="true"><a name="gradle" href="#gradle" tabindex="-1" class="ui-tabs-anchor" id="ui-id-1">Gradle</a></li>
        <li class="tabs-maven ui-tabs-tab ui-corner-top ui-state-default" role="tab" tabindex="-1" aria-controls="maven" aria-labelledby="ui-id-2" aria-selected="false" aria-expanded="false"><a name="maven" href="#maven" tabindex="-1" class="ui-tabs-anchor" id="ui-id-2">Maven</a></li>
    </ul>
    <div id="gradle" aria-labelledby="ui-id-1" role="tabpanel" class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="false">
<div class="paragraph">
<p>In the <em>azure/build.gradle</em> file, Add the following dependency:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">implementation("io.micronaut:micronaut-http-server-netty")</code></pre>
</div>
</div>
<div class="paragraph">
<p>Add the following snippet:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.named('dockerBuildNative') {
    images = ["${System.getProperty("repoName")}.azurecr.io/gdk-function:latest"]
}</code></pre>
</div>
</div>
</div>
    <div id="maven" aria-labelledby="ui-id-2" role="tabpanel" class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="true" style="display: none;">
<div class="paragraph">
<p>In the <em>azure/pom.xml</em> file Add the following dependency:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;io.micronaut&lt;/groupId&gt;
  &lt;artifactId&gt;micronaut-http-server-netty&lt;/artifactId&gt;
  &lt;scope&gt;compile&lt;/scope&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Remove the following plugin:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;plugin&gt;
    &lt;groupId&gt;com.microsoft.azure&lt;/groupId&gt;
    &lt;artifactId&gt;azure-functions-maven-plugin&lt;/artifactId&gt;
    &lt;version&gt;${azure.functions.maven.plugin.version}&lt;/version&gt;
    &lt;configuration&gt;
      &lt;!-- function app name --&gt;
      &lt;appName&gt;${functionAppName}&lt;/appName&gt;
      &lt;!-- function app resource group --&gt;
      &lt;resourceGroup&gt;${functionResourceGroup}&lt;/resourceGroup&gt;
      &lt;!-- function app service plan name --&gt;
      &lt;appServicePlanName&gt;java-functions-app-service-plan&lt;/appServicePlanName&gt;
      &lt;!-- function app region--&gt;
      &lt;!-- refers https://github.com/microsoft/azure-maven-plugins/wiki/Azure-Functions:-Configuration-Details#supported-regions for all valid values --&gt;
      &lt;region&gt;${functionAppRegion}&lt;/region&gt;
      &lt;!-- function pricingTier, default to be consumption if not specified --&gt;
      &lt;!-- refers https://github.com/microsoft/azure-maven-plugins/wiki/Azure-Functions:-Configuration-Details#supported-pricing-tiers for all valid values --&gt;
      &lt;!-- &lt;pricingTier&gt;&lt;/pricingTier&gt; --&gt;
      &lt;!-- Whether to disable application insights, default is false --&gt;
      &lt;!-- refers https://github.com/microsoft/azure-maven-plugins/wiki/Azure-Functions:-Configuration-Details for all valid configurations for application insights--&gt;
      &lt;!-- &lt;disableAppInsights&gt;&lt;/disableAppInsights&gt; --&gt;
      &lt;runtime&gt;
        &lt;!-- runtime os, could be windows, linux or docker--&gt;
        &lt;os&gt;${functionRuntimeOs}&lt;/os&gt;
        &lt;javaVersion&gt;${functionRuntimeJavaVersion}&lt;/javaVersion&gt;
      &lt;/runtime&gt;
      &lt;appSettings&gt;
        &lt;property&gt;
          &lt;name&gt;FUNCTIONS_EXTENSION_VERSION&lt;/name&gt;
          &lt;value&gt;~4&lt;/value&gt;
        &lt;/property&gt;
      &lt;/appSettings&gt;
    &lt;/configuration&gt;
    &lt;executions&gt;
      &lt;execution&gt;
        &lt;id&gt;package-functions&lt;/id&gt;
        &lt;goals&gt;
          &lt;goal&gt;package&lt;/goal&gt;
        &lt;/goals&gt;
      &lt;/execution&gt;
    &lt;/executions&gt;
&lt;/plugin&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="create-a-app-service-plan">7.2. Create a App Service Plan</h3>
<div class="paragraph">
<p>Run the <a href="https://learn.microsoft.com/en-us/cli/azure/functionapp/plan?view=azure-cli-latest#az-functionapp-plan-create"><code>az functionapp plan create</code></a> command to create an App Service Plan:</p>
</div>
<div class="tabs-doc ui-tabs ui-corner-all ui-widget ui-widget-content" data-name="system">
<div data-value="linux" data-label="Linux and macOS" id="linux" aria-labelledby="ui-id-9" role="tabpanel"
         class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="false" style="">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"><a href="https://learn.microsoft.com/en-us/cli/azure/functionapp/plan?view=azure-cli-latest#az-functionapp-plan-create" class="external" target="_blank" rel="noopener">az functionapp plan create \</a>
   --name $APP_SERVICE_PLAN \
   --resource-group $RESOURCE_GROUP_NAME \
   --location $LOCATION \
   --sku B1 \
   --is-linux</code></pre>
</div>
</div>
</div>
    <div data-value="windows" data-label="Windows" id="windows" aria-labelledby="ui-id-10" role="tabpanel"
         class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="true" style="display: none;">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"><a href="https://learn.microsoft.com/en-us/cli/azure/functionapp/plan?view=azure-cli-latest#az-functionapp-plan-create" class="external" target="_blank" rel="noopener">az functionapp plan create  &#94;</a>
   --name %APP_SERVICE_PLAN%  ^
   --resource-group %RESOURCE_GROUP_NAME%  ^
   --location %LOCATION%  ^
   --sku B1  ^
   --is-linux</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="create-an-azure-container-registry">7.3. Create an Azure Container Registry</h3>
<div class="paragraph">
<p>Run the <a href="https://learn.microsoft.com/en-us/cli/azure/acr#az-acr-create"><code>az acr create</code></a> command to create an Azure Container Registry:</p>
</div>
<div class="tabs-doc ui-tabs ui-corner-all ui-widget ui-widget-content" data-name="system">
<div data-value="linux" data-label="Linux and macOS" id="linux" aria-labelledby="ui-id-9" role="tabpanel"
         class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="false" style="">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"><a href="https://learn.microsoft.com/en-us/cli/azure/acr?view=azure-cli-latest#az-acr-create" class="external" target="_blank" rel="noopener">az acr create \</a>
   --name $REPO_NAME \
   --resource-group $RESOURCE_GROUP_NAME \
   --sku Basic \
   --admin-enabled true</code></pre>
</div>
</div>
</div>
    <div data-value="windows" data-label="Windows" id="windows" aria-labelledby="ui-id-10" role="tabpanel"
         class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="true" style="display: none;">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"><a href="https://learn.microsoft.com/en-us/cli/azure/acr?view=azure-cli-latest#az-acr-create" class="external" target="_blank" rel="noopener">az acr create  &#94;</a>
   --name %REPO_NAME%  ^
   --resource-group %RESOURCE_GROUP_NAME%  ^
   --sku Basic  ^
   --admin-enabled true</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="authenticate-to-your-azure-container-registry">7.4. Authenticate to Your Azure Container Registry</h3>
<div class="paragraph">
<p>Run the <a href="https://learn.microsoft.com/en-us/cli/azure/acr?view=azure-cli-latest#az-acr-login"><code>az acr login</code></a> command to authenticate to your Azure Container Registry:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">az acr login --name $REPO_NAME</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternately, login using <code>docker login</code>.</p>
</div>
<div class="paragraph">
<p>Run <code>az acr login</code> with the <code>--expose-token</code> flag to generate an access token, and save it in the <code>TOKEN</code> environment variable:</p>
</div>
<div class="tabs-doc ui-tabs ui-corner-all ui-widget ui-widget-content" data-name="system">
<div data-value="linux" data-label="Linux and macOS" id="linux" aria-labelledby="ui-id-9" role="tabpanel"
         class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="false" style="">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"><a href="https://learn.microsoft.com/en-us/cli/azure/acr?view=azure-cli-latest#az-acr-login" class="external" target="_blank" rel="noopener">export TOKEN=$(az acr login --name $REPO_NAME --expose-token --output tsv --query accessToken)</a>
docker login $REPO_NAME.azurecr.io \
   --username 00000000-0000-0000-0000-000000000000 \
   --password-stdin &lt;&lt;&lt; $TOKEN</code></pre>
</div>
</div>
</div>
    <div data-value="windows" data-label="Windows" id="windows" aria-labelledby="ui-id-10" role="tabpanel"
         class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="true" style="display: none;">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"><a href="https://learn.microsoft.com/en-us/cli/azure/acr?view=azure-cli-latest#az-acr-login" class="external" target="_blank" rel="noopener">az acr login --name $REPO_NAME --expose-token --output tsv --query accessToken &gt; tmp.txt</a>
set /p TOKEN=&lt;tmp.txt
docker login %REPO_NAME%.azurecr.io  ^
   --username 00000000-0000-0000-0000-000000000000  ^
   --password-stdin &lt;&lt;&lt; %TOKEN%</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="create-and-publish-container-image">7.5. Create and Publish Container Image</h3>
<div class="paragraph">
<p>To create and publish a container image containing a native executable to Azure Container Registry run the following command:</p>
</div>
<div class="gradle-maven-tabs ui-tabs ui-corner-all ui-widget ui-widget-content">
    <ul role="tablist" class="ui-tabs-nav ui-corner-all ui-helper-reset ui-helper-clearfix ui-widget-header">
        <li class="tabs-gradle ui-tabs-tab ui-corner-top ui-state-default ui-tabs-active ui-state-active" role="tab" tabindex="0" aria-controls="gradle" aria-labelledby="ui-id-1" aria-selected="true" aria-expanded="true"><a name="gradle" href="#gradle" tabindex="-1" class="ui-tabs-anchor" id="ui-id-1">Gradle</a></li>
        <li class="tabs-maven ui-tabs-tab ui-corner-top ui-state-default" role="tab" tabindex="-1" aria-controls="maven" aria-labelledby="ui-id-2" aria-selected="false" aria-expanded="false"><a name="maven" href="#maven" tabindex="-1" class="ui-tabs-anchor" id="ui-id-2">Maven</a></li>
    </ul>
    <div id="gradle" aria-labelledby="ui-id-1" role="tabpanel" class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="false">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./gradlew :azure:dockerBuildNative -DrepoName=$REPO_NAME</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note: If you encounter problems creating a container image, run the following command from the <code>azure/build/docker/native-main/</code> directory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">docker build . -t $REPO_NAME.azurecr.io/gdk-function:latest -f DockerfileNative</code></pre>
</div>
</div>
</div>
    <div id="maven" aria-labelledby="ui-id-2" role="tabpanel" class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="true" style="display: none;">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./mvnw install -pl lib -am;./mvnw package -Dpackaging=docker-native -Pgraalvm -pl azure -Djib.to.image=$REPO_NAME.azurecr.io/gdk-function:latest</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note: If you encounter problems creating a container image, run the following command from the <code>azure/target/</code> directory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">docker build . -t $REPO_NAME.azurecr.io/gdk-function:latest -f Dockerfile</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Push the image to the container registry:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">docker push $REPO_NAME.azurecr.io/gdk-function:latest</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="create-an-azure-function-2">7.6. Create an Azure Function</h3>
<div class="paragraph">
<p>Run <a href="https://learn.microsoft.com/en-us/cli/azure/acr/credential?view=azure-cli-latest#az-acr-credential-show"><code>az acr credential show</code></a> to get the login credentials for the container registry</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">export ACR_CREDENTIALS=$(az acr credential show --name $REPO_NAME)

export ACR_USERNAME=$(echo "$ACR_CREDENTIALS" | jq -r '.username')
export ACR_PASSWORD=$(echo "$ACR_CREDENTIALS" | jq -r '.passwords[0].value')</code></pre>
</div>
</div>
<div class="paragraph">
<p>Run the <a href="https://learn.microsoft.com/en-us/cli/azure/functionapp?view=azure-cli-latest#az-functionapp-create"><code>az functionapp create</code></a> command to create an Azure function:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">az functionapp create \
   --name $FUNCTION_NAME_NATIVE \
   --resource-group $RESOURCE_GROUP_NAME \
   --storage-account $STORAGE_NAME \
   --os-type linux \
   --plan $APP_SERVICE_PLAN \
   --image $REPO_NAME.azurecr.io/gdk-function:latest \
   --registry-server $REPO_NAME.azurecr.io \
   --registry-username $ACR_USERNAME \
   --registry-password $ACR_PASSWORD \
   --functions-version 4 \
   --disable-app-insights</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="test-the-azure-function-2">8. Test the Azure Function</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now test the function running from the native image container by sending it some requests.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Use <code>curl</code> to retrieve all the items:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl https://$FUNCTION_NAME_NATIVE.azurewebsites.net/store/all</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">[
  {
    "name": "chair",
    "description": "A black chair with 4 legs",
    "numberInStorage": 10
  },
  {
    "name": "table",
    "description": "A quality dining table",
    "numberInStorage": 6
  },
  {
    "name": "sofa",
    "description": "A grey sofa",
    "numberInStorage": 2
  },
  {
    "name": "bookshelf",
    "description": "A futuristic-looking bookshelf",
    "numberInStorage": 0
  }
]</code></pre>
</div>
</div>
</li>
<li>
<p>Get an error when attempting to order too many items:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl -X POST https://$FUNCTION_NAME_NATIVE.azurewebsites.net/store/order/table/10</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{"message": "Bad Request",
  "_embedded": {
    "errors": [{
      "message": "Could not order item 'table'. Insufficient amount in storage"
    }]
  }, ...
}</code></pre>
</div>
</div>
</li>
<li>
<p>Order an item and print the response status code:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl -X POST -w "\nStatus code: %{http_code}" https://$FUNCTION_NAME_NATIVE.azurewebsites.net/store/order/table/6</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "name":"table",
  "description":"A quality dining table",
  "numberInStorage":0
}
Status code: 200</code></pre>
</div>
</div>
</li>
<li>
<p>Get the available items:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl https://$FUNCTION_NAME_NATIVE.azurewebsites.net/store/available</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">[
  {
    "name": "chair",
    "description": "A black chair with 4 legs",
    "numberInStorage": 10
  },
  {
    "name": "sofa",
    "description": "A grey sofa",
    "numberInStorage": 2
  }
]</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="clean-up-cloud-resources">9. Clean up Cloud Resources</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Once you are done with this guide, you can delete the Azure resources created to avoid incurring unnecessary charges.</p>
</div>
<div class="paragraph">
<p>Delete the resource group and all of its resources with:</p>
</div>
<div class="tabs-doc ui-tabs ui-corner-all ui-widget ui-widget-content" data-name="system">
<div data-value="linux" data-label="Linux and macOS" id="linux" aria-labelledby="ui-id-9" role="tabpanel"
         class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="false" style="">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"><a href="https://learn.microsoft.com/en-us/cli/azure/group?view=azure-cli-latest#az-group-delete" class="external" target="_blank" rel="noopener">az group delete --name $RESOURCE_GROUP_NAME --yes</a></code></pre>
</div>
</div>
</div>
    <div data-value="windows" data-label="Windows" id="windows" aria-labelledby="ui-id-10" role="tabpanel"
         class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="true" style="display: none;">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"><a href="https://learn.microsoft.com/en-us/cli/azure/group?view=azure-cli-latest#az-group-delete" class="external" target="_blank" rel="noopener">az group delete --name %RESOURCE_GROUP_NAME% --yes</a></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Alternatively, run these commands to delete resources individually:</p>
</div>
<div class="tabs-doc ui-tabs ui-corner-all ui-widget ui-widget-content" data-name="system">
<div data-value="linux" data-label="Linux and macOS" id="linux" aria-labelledby="ui-id-9" role="tabpanel"
         class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="false" style="">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"><a href="https://learn.microsoft.com/en-us/cli/azure/functionapp/function?view=azure-cli-latest#az-functionapp-function-delete" class="external" target="_blank" rel="noopener">az functionapp delete --name $FUNCTION_NAME --resource-group $RESOURCE_GROUP_NAME</a>
<a href="https://learn.microsoft.com/en-us/cli/azure/functionapp/function?view=azure-cli-latest#az-functionapp-function-delete" class="external" target="_blank" rel="noopener">az functionapp delete --name $FUNCTION_NAME_NATIVE --resource-group $RESOURCE_GROUP_NAME</a>
<a href="https://learn.microsoft.com/en-us/cli/azure/functionapp/plan?view=azure-cli-latest#az-functionapp-plan-delete" class="external" target="_blank" rel="noopener">az functionapp plan delete --name $APP_SERVICE_PLAN --resource-group $RESOURCE_GROUP_NAME --yes</a>
<a href="https://learn.microsoft.com/en-us/cli/azure/storage/account?view=azure-cli-latest#az-storage-account-delete" class="external" target="_blank" rel="noopener">az storage account delete --name $STORAGE_NAME --resource-group $RESOURCE_GROUP_NAME --yes</a>
<a href="https://learn.microsoft.com/en-us/cli/azure/acr?view=azure-cli-latest#az-acr-delete" class="external" target="_blank" rel="noopener">az acr delete --name $REPO_NAME --yes</a>
<a href="https://learn.microsoft.com/en-us/cli/azure/group?view=azure-cli-latest#az-group-delete" class="external" target="_blank" rel="noopener">az group delete --name $RESOURCE_GROUP_NAME --yes</a></code></pre>
</div>
</div>
</div>
    <div data-value="windows" data-label="Windows" id="windows" aria-labelledby="ui-id-10" role="tabpanel"
         class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="true" style="display: none;">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"><a href="https://learn.microsoft.com/en-us/cli/azure/functionapp/function?view=azure-cli-latest#az-functionapp-function-delete" class="external" target="_blank" rel="noopener">az functionapp delete --name %FUNCTION_NAME% --resource-group %RESOURCE_GROUP_NAME% -yes</a>
<a href="https://learn.microsoft.com/en-us/cli/azure/functionapp/function?view=azure-cli-latest#az-functionapp-function-delete" class="external" target="_blank" rel="noopener">az functionapp delete --name %FUNCTION_NAME_NATIVE% --resource-group %RESOURCE_GROUP_NAME% -yes</a>
<a href="https://learn.microsoft.com/en-us/cli/azure/functionapp/plan?view=azure-cli-latest#az-functionapp-plan-delete" class="external" target="_blank" rel="noopener">az functionapp plan delete --name %APP_SERVICE_PLAN% --resource-group %RESOURCE_GROUP_NAME% -yes</a>
<a href="https://learn.microsoft.com/en-us/cli/azure/storage/account?view=azure-cli-latest#az-storage-account-delete" class="external" target="_blank" rel="noopener">az storage account delete --name %STORAGE_NAME% --resource-group %RESOURCE_GROUP_NAME% --yes</a>
<a href="https://learn.microsoft.com/en-us/cli/azure/acr?view=azure-cli-latest#az-acr-delete" class="external" target="_blank" rel="noopener">az acr delete --name %REPO_NAME% --yes</a>
<a href="https://learn.microsoft.com/en-us/cli/azure/group?view=azure-cli-latest#az-group-delete" class="external" target="_blank" rel="noopener">az group delete --name %RESOURCE_GROUP_NAME% --yes</a></code></pre>
</div>
</div>
</div>
</div>
<h3 id="summary" class="discrete">Summary</h3>
<div class="paragraph">
<p>This guide demonstrated how to create a Micronaut Gateway Function, run it on Azure Functions. The guide also demonstrated how to create a native executable from the Gateway Function and deploy it in place of the original Java-based version.</p>
</div>
<h3 id="related-documentation" class="discrete">Related Documentation</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://micronaut-projects.github.io/micronaut-azure/latest/guide/#azureHttpFunctions">Micronaut Azure Functions Support</a></p>
</li>
<li>
<p><a href="https://learn.microsoft.com/en-us/azure/azure-functions/functions-overview">Azure Functions</a></p>
</li>
<li>
<p><a href="https://graalvm.github.io/native-build-tools/latest/index.html">Native Build Tools</a></p>
</li>
<li>
<p><a href="https://www.graalvm.org">GraalVM Native Image</a></p>
</li>
</ul>
</div>
</div>
</div></div>
                        <div role="button" class="menu-btn menu-btn--sidebar js-show-sidebar" title="sweet hamburger">
                            <div class="hamburger">
                                <div class="inner"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </article>



        </div>

    </main>


    <footer class="footer footer__mobile">

        <div class="container-fluid container-fluid--custom-sm">
            <div class="row">
                <div class="col-12 col-sm-12 col-md-12 col-lg-12">
                    <div class="row footer-content">
                        <div class="col-md-3 col-sm-4">
                            <h6 class="title-footer" onclick="fadeInAndOut(this)">Learn</h6>
                            <div class="grow">
                                <ul class="footer-list">
                                    <li class="footer-list__item"><a href="/gdk/get-started/">Get Started</a></li>
                                    <li class="footer-list__item"><a href="/gdk/guides/">Guides</a></li>
                                    <li class="footer-list__item"><a href="/gdk/hands-on-labs/">Labs</a></li>
                                    <li class="footer-list__github">
                                        <img class="footer__icon" src="https://graal.cloud/gdk/resources/img/footer/logo-github.svg" alt="Github icon">
                                        <a href="https://github.com/oracle/graal-dev-kit" target="blank">Github</a>
                                    </li>
                                    <li class="footer-list__github">
                                        <img class="footer__icon" src="https://graal.cloud/gdk/resources/img/footer/slack-icon.svg" alt="Github icon">
                                        <a href="https://bit.ly/odevrel_slack" target="blank">#graal-dev-kit-for-micronaut</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-md-3 col-sm-4">
                            <h6 class="title-footer" onclick="fadeInAndOut(this)">About</h6>
                            <div class="grow">
                                <ul class="footer-list">
                                    <li class="footer-list__item"><a href="/gdk/about/#gdk-support" target="blank">Commercial Support</a></li>
                                    <li class="footer-list__item"><a href="https://www.graalvm.org/" target="blank">GraalVM Native Image</a></li>
                                    <li class="footer-list__item"><a href="https://micronaut.io/" target="_blank">Micronaut<sup>®</sup> Framework</a></li>
                                    <li class="footer-list__item"><a href="https://www.oracle.com/cloud/multicloud/what-is-multicloud/" target="_blank">Multicloud</a></li>
                                    <li class="footer-list__item"><a href="https://www.oracle.com/cloud/" target="blank">Oracle Cloud Infrastructure</a></li>
                                    <li class="footer-list__item"><a href="https://marketplace.visualstudio.com/items?itemName=oracle-labs-graalvm.graal-cloud-native-pack" target="blank">VS Code Tools</a></li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-md-6 col-sm-12 aligning_1024">
                            <div class="card--footer card--hovered box">
                                <div>
                                    <div class="rubber-footer footer__oci-section">
                                        <p class="title-footer quickstart">Build, test, and deploy applications on Oracle Cloud Infrastructure for free</p>
                                        <a href="https://www.oracle.com/cloud/free/" target="_blank" class="btn btn-primary">Try Oracle Cloud Infrastructure Free Tier</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-12 col-sm-12 col-md-12 col-lg-12">
                        <div class="row">
                            <div class="col-sm-12">
                                <p class="copyright">
                                    Copyright © 2023, 2025, Oracle and/or its affiliates.
                                    All rights reserved.
                                    Oracle and Java are registered trademarks of Oracle and/or its affiliates.<br>
                                    Micronaut<sup>®</sup> is a registered trademark of Object Computing, Inc.
                                    Use is for referential purposes and does not imply any endorsement or affiliation with any third-party product.
                                    Unauthorized use is strictly prohibited. Other names may be trademarks of their respective owners.
                                </p>
                                <div id="teconsent"></div>
                            </div>
                        </div>

                    </div>
                </div>

            </div>
        </div>
    </footer>

    <script>
        function fadeInAndOut(thz) {
            var elmt = thz.nextElementSibling;//Get the element that is below the button that
            //was just clicked
            if (elmt.clientHeight) {
                elmt.style.height = 0;
            } else {
                var wrapper = elmt.querySelector('ul');
                elmt.style.height = wrapper.clientHeight + "px";
            }
            /*
                elmt.classList.toggle("acordianPanelHidden");//Toggle the class which changes
                //attributes which triggers the transition CSS
                */
        }

        // Check TRUSTe Consent for Functional or Implied Approval
        // The if test verifies if the user has given the consent
        if ( (oracle.truste.api.getGdprConsentDecision().consentDecision) &&
            (oracle.truste.api.getGdprConsentDecision().consentDecision.indexOf(0) != -1 ||
                oracle.truste.api.getGdprConsentDecision().consentDecision.indexOf(2) != -1) ) {

            //The following is a sample of a Maxymiser Tag being written to the DOM
            //If the user did not give consent, then the tag is not included and not invoked in the Browser
            document.write('<script type="text/javascript" src="//service.maxymiser.net/cdn/oracle/js/mmcore.js"><\/script>');
        }

        // Check TRUSTe Consent for Advertising or Implied Approval
        // The if test verifies if the user has given the consent
        if ( (oracle.truste.api.getGdprConsentDecision().consentDecision) &&
            (oracle.truste.api.getGdprConsentDecision().consentDecision.indexOf(0) != -1 ||
                oracle.truste.api.getGdprConsentDecision().consentDecision.indexOf(3) != -1) ) {

            //The following is a sample of a BlueKai Core Tag being written to the DOM
            //If the user did not give consent, then the tag is not included and not invoked in the Browser
            document.write('<script type="text/javascript">' +
                'window.bk_async = function() { ' +
                'BKTAG.doTag(62581, 1); }; ' +
                '(function() { ' +
                'var scripts = document.getElementsByTagName(\'script\')[0]; ' +
                'var s = document.createElement(\'script\'); ' +
                's.async = true; ' +
                's.src = "https://tags.bkrtx.com/js/bk-coretag.js"; ' +
                'scripts.parentNode.insertBefore(s, scripts); ' +
                '}()); ' +
                '<\/script>');
        }
    </script><script type="text/javascript" src="//service.maxymiser.net/cdn/oracle/js/mmcore.js"></script><script type="text/javascript">window.bk_async = function() { BKTAG.doTag(62581, 1); }; (function() { var scripts = document.getElementsByTagName('script')[0]; var s = document.createElement('script'); s.async = true; s.src = "https://tags.bkrtx.com/js/bk-coretag.js"; scripts.parentNode.insertBefore(s, scripts); }()); </script>

</div>
<div class="overlay"></div>

<!-- Start SiteCatalyst code -->
<script language="JavaScript" src="https://www.oracle.com/us/assets/metrics/ora_otn.js"></script><script type="text/javascript" src="https://www.oracleimg.com/us/assets/metrics/ora_code_otn.js"></script><script type="text/javascript" src="https://www.oracleimg.com/us/assets/metrics/ora_code.js"></script>
<!-- End SiteCatalyst code -->

<script src="https://graal.cloud/gdk/resources/lib/slick-slider/slick.min.js"></script>
<script src='https://graal.cloud/gdk/resources/js/main.js'></script>
<script src="https://graal.cloud/gdk/resources/js/ui.js"></script>
<script src="https://graal.cloud/gdk/resources/js/filters.js"></script>
<script src="https://graal.cloud/gdk/resources/js/sidebar.js"></script>
<script src="https://graal.cloud/gdk/resources/js/labs.js"></script>
<!--<script>-->
<!--    hljs.initHighlightingOnLoad();-->
<!--</script>-->


<iframe name="trustarc_notice" id="trustarcNoticeFrame" title="Trustarc Cross-Domain Consent Frame" src="https://consent.trustarc.com/get?name=crossdomain.html&amp;domain=oracle.com" style="display: none;"></iframe></body></html>
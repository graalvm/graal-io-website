<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta property="og:image" content="/gdk/resources/img/graalvm.png" />
  <meta name="twitter:widgets:border-color" content="#55acee">

  <title>
    
      Secure an Application with Oracle Identity Cloud Service and OpenID Connect
    
  </title>
  <meta name="description" content="The Graal Development Kit for Micronaut (GDK) is a build of a curated set of Micronaut framework modules and their required libraries for building portable c..."/>
  <meta name="last_modified" content="2024-07-19 14:09:51 +0000"/>
  <meta name="last_built" content="2024-08-23 07:40:16 +0000"/>
  <link rel="stylesheet" href="/gdk/assets/main.css">
  <link rel="apple-touch-icon" sizes="180x180" href="/gdk/resources/img/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/gdk/resources/img/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/gdk/resources/img/favicon/favicon-16x16.png">
  <link rel="manifest" href="/gdk/resources/img/favicon/site.webmanifest">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
  <meta name="google-site-verification" content="-vRqwa9WYn6AaQGnl88xvrLw6ac4xoKVkZkhanmlRhU" />
  <link rel="canonical" href="https://www.graal.cloud/gdk/gdk-modules/security/micronaut-cloud-oidc-oracle/">

  <!-- jQuery UI Tabs -->
  <link rel="stylesheet" href="//code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css">
  <link rel="stylesheet" href="/gdk/resources/lib/jquery/jquery-ui.css">
</head>

      <script src="/gdk/resources/lib/jquery/jquery-3.6.1.min.js"></script>
    <script src="/gdk/resources/lib/bootstrap/js/bootstrap.min.js"></script>
    <script src='/gdk/resources/lib/sticky-sidebar/resizeSensor.js'></script>
    <script src='/gdk/resources/lib/sticky-sidebar/sticky-sidebar.min.js'></script>
    <script src="/gdk/resources/lib/highlight/highlight.min.js"></script>
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <!-- Add TRUSTe Consent Script and Analytics -->
    <script async="async" type="text/javascript" src='//consent.trustarc.com/notice?domain=oracle.com&c=teconsent&js=bb&noticeType=bb&text=true&cdn=1&pcookie&gtm=1' crossorigin></script>
    <script src="https://www.oracle.com/assets/truste-oraclelib.js"></script>
    <!-- jQuery UI Tabs -->
    <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.js"></script>


  <body class="preload">
    <!-- Start SiteCatalyst code -->
    <script language="JavaScript" src="https://www.oracle.com/us/assets/metrics/ora_otn.js"></script>
    <!-- End SiteCatalyst code -->

    <div  class="wrapper wrapper--nofooter" >

      <header  class="header header--content" 
  role="banner">

  

  

    <nav class="menu">
      <div class="menu__row">
        <div>
          <a href="/gdk/">
            <img class="logo-mobile" src="/gdk/resources/img/gdk-logo-new.svg" alt="Graal Development Kit for Micronaut logo">
          </a>
        </div>
        <div class="menu__container">
          <ul class="menu__list">
            <li class="menu__item">
              <a href="/gdk/about/" class="menu__link">About</a>
            </li>
            <li class="menu__item">
              <a href="/gdk/get-started/" class="menu__link">Get Started</a>
            </li>
            <li class="menu__item">
              <div class="stack-container">
                <a href="#" class="menu__link stack__header">Docs</a>
                <div class="stack-menu-learn">
                  <div class="stack-row">
                    <div class="stack-column">
                      <div class="stack__item">
                        <img src='/gdk/resources/img/header-navigation/modules.svg'>
                        <a href="/gdk/modules/" class="item-line">Modules</a>
                      </div>
                      <div class="stack__item">
                        <img src='/gdk/resources/img/header-navigation/guides.svg'>
                        <a href="/gdk/guides/" class="item-line">Guides</a>
                      </div>
                      <div class="stack__item">
                        <img src='/gdk/resources/img/header-navigation/labs.svg'>
                        <a href="/gdk/hands-on-labs/" class="item-line">Hands-On Labs</a>
                      </div>
                      <div class="stack__item">
                        <img src='/gdk/resources/img/header-navigation/tools.svg'>
                        <a href="/gdk/vscode-tools/" class="item-line">Tools</a>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </li>
            <li class="menu__item">
              <div class="stack-container">
                <a href="#" class="menu__link stack__header">Graal Projects</a>
                <div class="stack-menu">
                  <div class="stack-row">
                    <div class="stack-column">
                      <div class="stack__item">
                        <img src='/gdk/resources/img/header-navigation/graalstack.svg'>
                        <a href="https://graal.cloud/" class="item-line">Graal</a>
                      </div>
                      <div class="stack__item">
                        <img src='/gdk/resources/img/header-navigation/graalvm.svg'>
                        <a href="https://graalvm.org/" class="item-line">GraalVM</a>
                      </div>
                      <div class="stack__item">
                        <img src='/gdk/resources/img/header-navigation/graalos.svg'>
                        <a href="https://graal.cloud/graalos/" class="item-line">GraalOS</a>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </li>
            <li class="menu__launch__mobile">
              <a href="/gdk/launcher/" class="btn-launch btn btn-primary" target="blank">Create App</a>
            </li>
          </ul>
        </div>
        <div class="menu__launch">
          <a href="/gdk/launcher/" class="btn-launch btn btn-primary" target="blank">Create App</a>
        </div>
      </div>

      <div role="button" class="menu-btn menu-btn--menu js-show-menu" tabindex="-1" title="sweet hamburger">
        <div class="hamburger">
          <div class="inner"></div>
        </div>
      </div>
      <button aria-label="hamburger mobile menu" class="btn btn-mobile-menu js-show-menu">
        <div class="inner"></div>
      </button>
    </nav>

  
</header>


      <main  class="content"   aria-label="Content">
        <div class="wrapper wrapper-content">
  <article>
  <div class="row d-flex flex-wrap">
    <div class="col-sm-3 docsimpro col-bg">
      <div class="sidebar-wrap">
        <div class="sidebar">
          <div class="menuabout">
            <img id="sidebarClose" src="/gdk/resources/img/arrow_sidebar(close).svg" alt="Expand or collapse sidebar"
              class="btn-color no-display">
            <img id="sidebarOpen" src="/gdk/resources/img/arrow_sidebar.svg" alt="Expand or collapse sidebar">
          </div>
          
<div class="toc-floating">


<div class="toc-bullets">


  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    

    
      
        
          <li class="toc-bullets-main">
        
          
          <a href="/gdk/docs/gdk-modules/security/" class="_icon-book">
            Security
          </a>
        </li>

        
        

        
        
          
          <li class="toc-bullets-sub toc-bullets-highlight">
          
            
            <a href="/gdk/gdk-modules/security/micronaut-cloud-oidc-oracle/">
              Secure an Application with Oracle Identity Cloud Service and OpenID Connect
            </a>
          </li>

          
            <div>
  <script>
    var scriptElement = document.currentScript;
    var div = $(scriptElement.parentElement);
    $(window).on("load", function () {
      $("#content-wrapper h2").each(function () {
        var li = $("<li></li>", { class: "toc-bullets-sub toc-bullets-sub-3" });
        var a = $("<a></a>", { href: "#" + $(this).attr("id") });
        a.text($(this).text().replace('#', ''));
        li.append(a);
        li.click(function (e) {
          e.preventDefault();
          var target = $(a.attr('href'));
          var scrollTo = target.offset().top - 80; // 80 - indent
          $('html, body').animate({ scrollTop: scrollTo }, 1000);
        });
        div.append(li);
      });
    });
  </script>
</div>
          
        
      
    
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

<!-- <li class="search additional-search">
  <form class="form-inline sidebar" action="/docs/search" autocomplete="on" method="get">
    <input class="input-search sidebar" type="text" id="search-box" name="query" placeholder="Search">
    <button type="submit sidebar" class="search-button"></button>
  </form>
</li> -->

</div>
  <!-- Search form -->
  <!-- <form class="search-container" action="/docs/search" autocomplete="on" method="get">
   <label for="search-box">Search</label>
    <input type="text" id="search-box" name="query">
    <button type="submit" class="searchbttn"></button>
  </form> -->
</div>

        </div>
      </div>
    </div>

    <div class="col-sm-9 docsmod">
      <div id="content-wrapper" class="docs-content docs-content--with-sidebar">
        <!--
          Include file to warn of Windows/Gradle restriction
        -->
        <h1 id="secure-an-application-with-oracle-identity-cloud-service-and-openid-connect">
        
        
          Secure an Application with Oracle Identity Cloud Service and OpenID Connect
        
        
      </h1>

<p>In this guide, you will use the Graal Development Kit for Micronaut (GDK) to create an application that authenticates users with Oracle Identity Cloud Service and OpenID Connect.
OpenID Connect (OIDC) is an identity layer on top of the open-standard  OAuth 2.0 protocol that verifies an end user’s identity and obtains basic profile information.
The OIDC APIs are easier to work with than OAuth because they use JSON instead of XML.</p>
    
      <h3 id="prerequisites">
        
        
          Prerequisites <a href="#prerequisites" class="anchor_heading">#</a>
        
        
      </h3>

<ul>
  <li>JDK 17 or higher. See <a href="/gdk/get-started/setting-up-desktop/">Setting up Your Desktop</a>.</li>
  <li>An Oracle Cloud Infrastructure account. See <a href="/gdk/get-started/setting-up-cloud-accounts/">Setting up Your Cloud Accounts</a>.</li>
  <li>The Oracle Cloud Infrastructure <a href="https://docs.cloud.oracle.com/iaas/Content/API/SDKDocs/cliinstall.htm">CLI</a> installed with <a href="https://docs.oracle.com/iaas/Content/API/SDKDocs/cliinstall.htm#configfile">local access configured</a>.</li>
  <li>An Oracle Cloud Infrastructure <a href="https://docs.oracle.com/en/cloud/paas/integration-cloud/oracle-integration-oci/creating-oci-compartment.html">compartment</a>.</li>
  <li>The GDK CLI. See <a href="/gdk/get-started/setting-up-desktop/">Setting up Your Desktop</a>. (Optional.)</li>
</ul>

<p>Follow the steps below to create the application from scratch. However, you can also download the completed example:</p>

<div id="tabs-doc1">
  <ul>
    <li class="tabs-gradle"><a name="gradle" href="#gradle">Gradle</a></li>
    <li class="tabs-maven"><a name="maven" href="#maven">Maven</a></li>
  </ul>
  <div id="gradle">
    <p><a href="https://github.com/oracle/gcn/releases/download/4.5.0.0/4.5.0.0_security_oci-security-demo-java-gradle.zip">Gradle Oracle Cloud Infrastructure Security Example <img class="download-img-guides" src="/gdk/resources/img/gdk_modules/download-archive.png" alt="Download completed example" /></a>
    </p>
  </div>
  <div id="maven">
    <p><a href="https://github.com/oracle/gcn/releases/download/4.5.0.0/4.5.0.0_security_oci-security-demo-java-maven.zip">Maven Oracle Cloud Infrastructure Security Example <img class="download-img-guides" src="/gdk/resources/img/gdk_modules/download-archive.png" alt="Download completed example" /></a>
    </p>
  </div>
</div>
    
      <h4 id="a-note-regarding-your-development-environment">
        
        
          A note regarding your development environment
        
        
      </h4>

<p>Consider using Visual Studio Code, which provides native support for developing applications with the <a href="/gdk/vscode-tools/using-gdk-vscode-tools/">Graal Development Kit extension</a>.</p>

<blockquote>
  <p>Note: If you use IntelliJ IDEA, <a href="/gdk/resources/img/annotationprocessorsintellij.png">enable annotation processing</a>.</p>
</blockquote>

<blockquote>
  <p>Windows platform: The GDK guides are compatible with Gradle only. Maven support is coming soon.</p>
</blockquote>
    
      <h2 id="1-create-the-application">
        
        
          1. Create the Application <a href="#1-create-the-application" class="anchor_heading">#</a>
        
        
      </h2>

<p>Create an application using the GDK Launcher.</p>

<ol>
  <li>
    <p>Open the <a href="/gdk/launcher/?advanced=true">GDK Launcher in advanced mode</a>.</p>
  </li>
  <li>Create a new project using the following selections.
    <ul>
      <li><strong>Project Type</strong>: <em>Application</em> (default)</li>
      <li><strong>Project Name</strong>: <em>oci-security-demo</em></li>
      <li><strong>Base Package</strong>: <em>com.example</em> (Default)</li>
      <li><strong>Clouds</strong>: <em>OCI</em></li>
      <li><strong>Language</strong>: <em>Java</em> (default)</li>
      <li><strong>Build Tool</strong>: <em>Gradle (Groovy)</em> or <em>Maven</em></li>
      <li><strong>Test Framework</strong>: <em>JUnit</em> (default)</li>
      <li><strong>Java Version</strong>: <em>17</em> (default)</li>
      <li><strong>Micronaut Version</strong>: (default)</li>
      <li><strong>Cloud Services</strong>: <em>Security</em></li>
      <li><strong>Features</strong>: <em>GraalVM Native Image</em> (Default)</li>
      <li><strong>Sample Code</strong>: <em>Yes</em> (Default)</li>
    </ul>
  </li>
  <li>Click <strong>Generate Project</strong>, then click <strong>Download Zip</strong>. The GDK Launcher creates an application with the default package <code>com.example</code> in a directory named <em>oci-security-demo</em>. The application ZIP file will be downloaded to your default downloads directory. Unzip it, open it in your code editor, and proceed to the next steps.</li>
</ol>

<p>Alternatively, use the GDK CLI as follows:</p>

<div id="tabs-doc2">
    <ul>
        <li class="tabs-gradle"><a name="gradle" href="#gradle">Gradle</a></li>
        <li class="tabs-maven"><a name="maven" href="#maven">Maven</a></li>
    </ul>
    <div id="gradle">
        <pre><code class="language-bash">gdk create-app com.example.oci-security-demo \
    --clouds=oci \
    --services=security \
    --features=graalvm \
    --build=gradle \
    --jdk=17 \
    --lang=java</code></pre>
    </div>
    <div id="maven">
        <pre><code class="language-bash">gdk create-app com.example.oci-security-demo \
    --clouds=oci \
    --services=security \
    --features=graalvm \
    --build=maven \
    --jdk=17 \
    --lang=java</code></pre>
    </div>
</div>

<p>For more information, see <a href="/gdk/get-started/using-gdk-cli/">Using the GDK CLI</a>.</p>
    
      <h3 id="11-authcontroller">
        
        
          1.1. AuthController <a href="#11-authcontroller" class="anchor_heading">#</a>
        
        
      </h3>

<p>The GDK Launcher created a class named <code>AuthController</code> to handle requests to <code>/</code>. It displays the email of an authenticated person, if any. The controller endpoint is annotated with  a <a href="https://micronaut-projects.github.io/micronaut-views/latest/api/io/micronaut/views/View.html" target="_blank"><code>@View</code></a> annotation that uses a <a href="https://micronaut-projects.github.io/micronaut-views/latest/guide/#jte" target="_blank">JTE template</a>. The file named <em>oci/src/main/java/com/example/AuthController.java</em> has the following contents:</p>

<pre><code class="language-java">package com.example;

import io.micronaut.core.annotation.Nullable;
import io.micronaut.http.annotation.Controller;
import io.micronaut.http.annotation.Get;
import io.micronaut.security.annotation.Secured;
import io.micronaut.security.authentication.Authentication;
import io.micronaut.views.View;

import java.util.Collections;
import java.util.HashMap;
import java.util.Map;

import static io.micronaut.security.rules.SecurityRule.IS_ANONYMOUS;
import static io.micronaut.security.rules.SecurityRule.IS_AUTHENTICATED;

@Controller // &lt;1&gt;
class AuthController {

    @Secured(IS_ANONYMOUS) // &lt;2&gt;
    @View("auth") // &lt;3&gt;
    @Get // &lt;4&gt;
    Map&lt;String, Object&gt; index(@Nullable Authentication authentication) { // &lt;5&gt;
        Map&lt;String, Object&gt; model = new HashMap&lt;&gt;();
        if (authentication != null) {
            model.put("username", authentication.getAttributes().get("sub"));
        } else {
            model.put("username", "Anonymous");
        }
        return model;
    }

    @Secured(IS_AUTHENTICATED) // &lt;6&gt;
    @Get("/secure") // &lt;7&gt;
    Map&lt;String, Object&gt; secured() {
        return Collections.singletonMap("secured", true); // &lt;8&gt;
    }
}
</code></pre>

<p><strong>1</strong> The class is defined as a controller with the <a href="https://docs.micronaut.io/4.2.1/api/io/micronaut/http/annotation/Controller.html" target="_blank"><code>@Controller</code></a> annotation mapped to the path <code>/</code>.</p>

<p><strong>2</strong> Annotate with <a href="https://micronaut-projects.github.io/micronaut-security/1.3.1/api/io/micronaut/security/annotation/Secured.html" target="_blank"><code>@Secured</code></a> to configure secured access. The <code>SecurityRule.IS_ANONYMOUS</code> expression allows access without authentication.</p>

<p><strong>3</strong> Use the <a href="https://micronaut-projects.github.io/micronaut-views/latest/api/io/micronaut/views/View.html" target="_blank"><code>@View</code></a> annotation to specify which template to use to render the response.</p>

<p><strong>4</strong> The <a href="https://docs.micronaut.io/4.2.1/api/io/micronaut/http/annotation/Get.html" target="_blank"><code>@Get</code></a> annotation maps the <code>index</code> method to an HTTP GET request on <code>/</code>.</p>

<p><strong>5</strong> Micronaut Security will inject the <code>Authentication</code> instance as a method parameter; by annotating with <a href="https://docs.micronaut.io/latest/api/io/micronaut/core/annotation/Nullable.html" target="_blank"><code>@Nullable</code></a>, you can determine whether the user is authenticated or not, and populate the model map accordingly.</p>

<p><strong>6</strong> Annotate with <code>@Secured</code> to configure secured access. The <code>SecurityRule.IS_AUTHENTICATED</code> expression allows access only to authenticated users.</p>

<p><strong>7</strong> The <a href="https://docs.micronaut.io/4.2.1/api/io/micronaut/http/annotation/Get.html"><code>@Get</code></a> annotation maps the <code>secured</code> method to an HTTP GET request on <code>/secure</code>.</p>

<p><strong>8</strong> This method simply returns a model map that will be rendered as JSON (because there is no <a href="https://micronaut-projects.github.io/micronaut-views/latest/api/io/micronaut/views/View.html" target="_blank"><code>@View</code></a> annotation).</p>
    
      <h3 id="12-jte-template">
        
        
          1.2. JTE Template <a href="#12-jte-template" class="anchor_heading">#</a>
        
        
      </h3>

<p>The GDK Launcher created a <a href="https://micronaut-projects.github.io/micronaut-views/latest/guide/#jte" target="_blank">JTE template</a> in a file named <em>oci/src/main/jte/auth.jte</em> to render the UI for the controller. It has the following contents:</p>

<pre><code class="language-html">@param String username
@param java.util.Map&lt;?, ?&gt; security

&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;title&gt;GDK - Oracle OpenID Connect&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;GDK - Oracle OpenID Connect&lt;/h1&gt;

&lt;h2&gt;username: &lt;span&gt;${username}&lt;/span&gt;&lt;/h2&gt;

&lt;nav&gt;
    &lt;ul&gt;
    @if(security == null)
        &lt;li&gt;&lt;a href="/oauth/login/gdk"&gt;Enter&lt;/a&gt;&lt;/li&gt;
    @else
        &lt;li&gt;&lt;a href="/logout"&gt;Logout&lt;/a&gt;&lt;/li&gt;
    @endif
    &lt;/ul&gt;
&lt;/nav&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
    
      <h2 id="2-configure-openid-connect-at-oracle-cloud-infrastructure">
        
        
          2. Configure OpenID Connect at Oracle Cloud Infrastructure <a href="#2-configure-openid-connect-at-oracle-cloud-infrastructure" class="anchor_heading">#</a>
        
        
      </h2>

<p>You will use the Oracle Cloud console to create an OAuth 2.0 “Confidential Application” with support for OpenID Connect and a federated user to demonstrate using OpenID Connect with Micronaut<sup>®</sup> and Oracle Cloud Infrastructure.</p>
    
      <h3 id="21-create-a-federated-user">
        
        
          2.1. Create a Federated User <a href="#21-create-a-federated-user" class="anchor_heading">#</a>
        
        
      </h3>

<ol>
  <li>
    <p><a href="https://cloud.oracle.com/" target="_blank">Log in to your Oracle Cloud Infrastructure tenancy</a> as an admin (or as a user with sufficient permissions to create users and applications).</p>
  </li>
  <li>
    <p>In the Oracle Cloud Console, open the navigation menu, click <strong>Identity &amp; Security</strong>. Under <strong>Identity</strong>, click <strong>Federation</strong>.</p>
  </li>
  <li>
    <p>Click <strong>OracleIdentityCloudService</strong>, and then click <strong>Create User</strong>.</p>
  </li>
  <li>
    <p>Enter a valid username, for example, “gdk_guide_oidc”, and a valid email address, along with a first and last name. Click <strong>Create</strong>.</p>
  </li>
  <li>
    <p>Open the email sent to the email address you specified and click the link to set the password for the user.</p>
  </li>
  <li>
    <p>Log in as the user to verify the password. Then log out and back in as an admin user.</p>
  </li>
</ol>
    
      <h3 id="22-create-the-oauth-application">
        
        
          2.2. Create the OAuth Application <a href="#22-create-the-oauth-application" class="anchor_heading">#</a>
        
        
      </h3>

<ol>
  <li>
    <p>Navigate again to the <strong>OracleIdentityCloudService</strong> federation and copy the link to the <strong>Oracle Identity Cloud Service Console</strong> (it will resemble <code>https://idcs-7084de14ec…….identity.oraclecloud.com/ui/v1/adminconsole</code>). Save this for later when you create the application: you will need this value to set the <code>OAUTH_ISSUER</code>.</p>
  </li>
  <li>
    <p>Click <strong>Oracle Identity Cloud Service Console</strong> to open the console.</p>
  </li>
  <li>
    <p>Click the button in the top right of the <strong>Applications and Services</strong> section to add a new application.</p>
  </li>
  <li>
    <p>Click <strong>Confidential Application</strong>. You are presented with a Wizard containing five steps.</p>
  </li>
  <li>
    <p>Step 1 of the Wizard: Enter a valid application name, for example, “gdk_guide_oidc_app” and optionally a description. Click <strong>Next</strong> to go to step 2.</p>
  </li>
  <li>
    <p>Step 2 of the Wizard: Click <strong>Configure this application as a client now</strong>, and provide the following information:</p>

    <ul>
      <li><strong>Allowed Grant Types</strong>: <em>Authorization Code</em></li>
      <li><strong>Allow non-HTTPS URLs</strong>: <em>check</em></li>
      <li><strong>Redirect URL</strong>: <em>http://localhost:8080/oauth/callback/gdk</em></li>
      <li><strong>Logout URL</strong>: <em>http://localhost:8080/logout</em></li>
      <li><strong>Post Logout Redirect URL</strong>: <em>http://localhost:8080</em></li>
    </ul>

    <p>6.1. Scroll down and in the section titled <strong>Grant the client access to Identity Cloud Service Admin APIs</strong>, click <strong>Add</strong>.</p>

    <p>6.2. Select <strong>Me</strong>.</p>
  </li>
  <li>
    <p>Click <strong>Next</strong>, and again click <strong>Next</strong> to accept the defaults for steps 3, 4, and 5 of the Wizard. Then click <strong>Finish</strong>.</p>
  </li>
  <li>
    <p>Save the <strong>Client ID</strong> and <strong>Client Secret</strong> values for later. Then click <strong>Close</strong>.</p>
  </li>
  <li>
    <p>Finally, click <strong>Activate</strong> to make the application available for use.</p>
  </li>
</ol>

<blockquote>
  <p>Note: Select <strong>Allow non-HTTPS URLs</strong> to make testing easier and avoid having to use HTTPS locally. Be sure to unselect this in production applications, which should always use HTTPS.</p>
</blockquote>
    
      <h3 id="23-enable-signing-certificate-access">
        
        
          2.3. Enable Signing Certificate Access <a href="#23-enable-signing-certificate-access" class="anchor_heading">#</a>
        
        
      </h3>

<p>Make the signing certificate available to your application for <a href="https://jwt.io/" target="_blank">JSON Web Tokens</a> (JWT) validation without being authenticated.</p>

<ol>
  <li>
    <p>In the Oracle Identity Cloud Service console, expand the <strong>Navigation Drawer</strong>, click <strong>Settings</strong>, and then click <strong>Default Settings</strong>.</p>
  </li>
  <li>
    <p>Turn on the switch under <strong>Access Signing Certificate</strong> to enable clients to access the tenant signing certificate without logging in to Oracle Identity Cloud Service.</p>
  </li>
  <li>
    <p>Click <strong>Save</strong> to save the default settings.</p>
  </li>
</ol>

<p>If you skip these steps, you will see similar errors for valid logins because Micronaut Security cannot retrieve the JSON Web Key (JWK) to validate the JWT:</p>

<pre><code>JWT signature validation failed for provider [gdk]
Exception loading JWK from https://idcs-7084de14ec.......identity.oraclecloud.com/admin/v1/SigningCert/jwk
Server returned HTTP response code: 401
</code></pre>
    
      <h3 id="24-set-the-issuer-url">
        
        
          2.4. Set the Issuer URL <a href="#24-set-the-issuer-url" class="anchor_heading">#</a>
        
        
      </h3>

<p>Configure the “issuer” URL for JWT validation to succeed.</p>

<ol>
  <li>
    <p>Return to the menu on the left and click <strong>Security</strong> and <strong>OAuth</strong>.</p>
  </li>
  <li>
    <p>Enter the issuer URL you saved (the Oracle Identity Cloud Service console URL without the <code>/ui/v1/adminconsole</code> path) in the “Issuer” field, for example, <code>https://idcs-7084de14ec…….identity.oraclecloud.com</code>.</p>
  </li>
</ol>
    
      <h3 id="25-configure-the-application">
        
        
          2.5. Configure the Application <a href="#25-configure-the-application" class="anchor_heading">#</a>
        
        
      </h3>

<p>The GDK Launcher generated an initial security configuration in <em>oci/src/main/resources/application.properties</em>, as follows:</p>

<pre><code>micronaut.application.name=oci
# &lt;1&gt;
micronaut.security.authentication=idtoken
micronaut.security.endpoints.logout.enabled=true
# &lt;2&gt;
micronaut.security.endpoints.logout.get-allowed=true
# &lt;3&gt; &lt;4&gt;
micronaut.security.oauth2.clients.gcn.client-id=${OAUTH_CLIENT_ID\:xxx}
# &lt;3&gt; &lt;4&gt;
micronaut.security.oauth2.clients.gcn.client-secret=${OAUTH_CLIENT_SECRET\:yyy}
# &lt;3&gt; &lt;4&gt;
micronaut.security.oauth2.clients.gcn.openid.issuer=${OAUTH_ISSUER\:zzz}
micronaut.security.token.jwt.signatures.secret.generator.secret=${JWT_GENERATOR_SIGNATURE_SECRET\:pleaseChangeThisSecretForANewOne}
</code></pre>

<p><strong>1</strong> Set <code>micronaut.security.authentication</code> as <code>idtoken</code>. The <code>idtoken</code> provided by your OAuth 2.0 application when the Authorization code flow ends (a signed JWT) will be saved in a cookie.</p>

<p><strong>2</strong> Accept GET requests to the <code>/logout</code> endpoint</p>

<p><strong>3</strong> The provider identifier must match the last part of the URL you entered as a redirect URL: <code>/oauth/callback/gdk</code>.</p>

<p><strong>4</strong> The <code>client-id</code>, <code>client-secret</code>, and the <code>issuer</code> URL will be set as environment variables.</p>
    
      <h2 id="3-run-the-application">
        
        
          3. Run the Application <a href="#3-run-the-application" class="anchor_heading">#</a>
        
        
      </h2>

<p>The generated <em>application.properties</em> file contains placeholders  for the <code>client-id</code>, <code>client-secret</code>, and the <code>issuer</code> URL properties. Create environment variables for those before starting the application.</p>

<ol>
  <li>
    <p>Create <code>OAUTH_CLIENT_ID</code>, <code>OAUTH_CLIENT_SECRET</code>, and <code>OAUTH_ISSUER</code> environment variables. Use the client ID and the client secret you saved when you created the Oracle Cloud Infrastructure application, and the issuer URL you saved (the Oracle Identity Cloud Service console URL without the <code>/ui/v1/adminconsole</code> path):</p>

    <div class="tabs-doc" data-name="system">
     <div data-value="linux" data-label="Linux &amp; macOS">
       <pre><code class="language-bash">export OAUTH_CLIENT_ID=XXXXXXXXXX
export OAUTH_CLIENT_SECRET=YYYYYYYYYY
export OAUTH_ISSUER=https://idcs-7084de14ec…….identity.oraclecloud.com</code></pre>
     </div>
     <div data-value="windows" data-label="Windows">
         <pre><code class="language-bash">set OAUTH_CLIENT_ID=XXXXXXXXXX
set OAUTH_CLIENT_SECRET=YYYYYYYYYY
set OAUTH_ISSUER=https://idcs-7084de14ec…….identity.oraclecloud.com</code></pre>
     </div>
     <div data-value="windows-powershell" data-label="Windows PowerShell">
         <pre><code class="language-bash">$ENV:OAUTH_CLIENT_ID = "XXXXXXXXXX"
$ENV:OAUTH_CLIENT_SECRET = "YYYYYYYYYY"
$ENV:OAUTH_ISSUER = "https://idcs-7084de14ec…….identity.oraclecloud.com"</code></pre>
     </div>
 </div>
  </li>
  <li>
    <p>Run the application, using the following command, which starts the application on port 8080.</p>

    <div id="tabs-doc3">
     <ul>
         <li class="tabs-gradle"><a name="gradle" href="#gradle">Gradle</a></li>
         <li class="tabs-maven"><a name="maven" href="#maven">Maven</a></li>
     </ul>
     <div id="gradle">
         <pre><code class="language-bash">./gradlew :oci:run</code></pre>
     </div>
     <div id="maven">
         <pre><code class="language-bash">./mvnw install -pl lib -am
./mvnw mn:run -pl oci</code></pre>
     </div>
 </div>
  </li>
  <li>
    <p>Open <a href="http://localhost:8080/secure">http://localhost:8080/secure</a> in a browser, and you will be redirected to the home page (because the controller method is annotated with <code>@Secured(IS_AUTHENTICATED)</code>, and you are not yet authenticated):</p>

    <p><img src="/gdk/docs/gdk-modules/security/images/run1.png" alt="run1" /></p>
  </li>
  <li>
    <p>Sign in with the username and password for the federated user you created.</p>
  </li>
  <li>
    <p>Click <strong>Allow</strong> on the next screen.</p>
  </li>
  <li>
    <p>When redirected to the home page, you will see that you are authenticated and now have a <strong>Logout</strong> link. Several authentication details are also displayed.</p>
  </li>
  <li>
    <p>Navigate again to <a href="http://localhost:8080/secure">http://localhost:8080/secure</a> in a browser, and you will see a simple JSON response:</p>

    <p><img src="/gdk/docs/gdk-modules/security/images/run5.png" alt="run5" /></p>
  </li>
</ol>
    
      <h2 id="4-generate-a-native-executable-using-graalvm">
        
        
          4. Generate a Native Executable Using GraalVM <a href="#4-generate-a-native-executable-using-graalvm" class="anchor_heading">#</a>
        
        
      </h2>

<p>The GDK supports compiling a Java application ahead-of-time into a native executable using <a href="https://www.graalvm.org/">GraalVM Native Image</a>. You can use the <em><a href="https://graalvm.github.io/native-build-tools/latest/gradle-plugin.html">Gradle plugin for GraalVM Native Image building</a>/<a href="https://graalvm.github.io/native-build-tools/latest/maven-plugin.html">Maven plugin for GraalVM Native Image building</a></em>. Packaged as a native executable, it significantly reduces application startup time and memory footprint.</p>

<p>To generate a native executable, run the following command:</p>

<div id="tabs-doc4">
  <ul>
    <li class="tabs-gradle"><a name="gradle" href="#gradle">Gradle</a></li>
    <li class="tabs-maven"><a name="maven" href="#maven">Maven</a></li>
  </ul>
  <div id="gradle">
    <pre><code class="language-bash">./gradlew :oci:nativeCompile</code></pre>
    <p>The native executable is created in the <em>oci/build/native/nativeCompile/</em> directory and can be run with the following command:</p>
    <pre><code class="language-bash">oci/build/native/nativeCompile/oci</code></pre>
  </div>
  <div id="maven">
    <pre><code class="language-bash">./mvnw install -pl lib -am
./mvnw package -pl oci -Dpackaging=native-image</code></pre>
    <p>The native executable is created in the <em>oci/target/</em> directory and can be run with the following command:</p>
    <pre><code class="language-bash">oci/target/oci-security-demo-oci</code></pre>
  </div>
</div>
    
      <h2 id="5-run-and-test-the-native-executable">
        
        
          5. Run and Test the Native Executable <a href="#5-run-and-test-the-native-executable" class="anchor_heading">#</a>
        
        
      </h2>

<p>Run the native executable, and then perform the same tests as in step <strong>3</strong>.</p>
    
      <h3 id="summary">
        
        
          Summary <a href="#summary" class="anchor_heading">#</a>
        
        
      </h3>

<p>This guide demonstrated how to use the GDK to create a secure OAuth 2.0 Confidential Application with support for OpenID Connect and a federated user to demonstrate using OpenID Connect with Oracle Cloud Infrastructure. Then you packaged that application into a native executable with GraalVM Native Image.</p>
    
      <h3 id="related-documentation">
        
        
          Related Documentation <a href="#related-documentation" class="anchor_heading">#</a>
        
        
      </h3>

<ul>
  <li><a href="https://micronaut-projects.github.io/micronaut-security/latest/guide/">Micronaut Security</a>.</li>
  <li><a href="https://openid.net/connect/">OpenID Connect</a></li>
  <li><a href="https://www.graalvm.org/">GraalVM Native Image</a></li>
  <li>Check out <a href="https://blogs.oracle.com/developers/post/authenticating-users-with-oracle-idcs-via-openid-connect-and-micronaut">this blog post</a> on using OpenID Connect with Micronaut and Oracle Cloud Infrastructure</li>
</ul>

      </div>

      <div role="button" class="menu-btn menu-btn--sidebar js-show-sidebar" title="sweet hamburger">
        <div class="hamburger">
          <div class="inner"></div>
        </div>
      </div>
    </div>
  </div>
</article>



</div>

      </main>

      
<footer class="footer footer__mobile">

  <div class="container-fluid container-fluid--custom-sm">
    <div class="row">
      <div class="col-12 col-sm-12 col-md-12 col-lg-12">
        <div class="row footer-content">
          <div class="col-md-3 col-sm-4">
            <h6 class="title-footer" onclick="fadeInAndOut(this)">Learn</h6>
            <div class="grow">
              <ul class="footer-list">
                <li class="footer-list__item"><a href="/gdk/get-started/">Get Started</a></li>
                <li class="footer-list__item"><a href="/gdk/guides/">Guides</a></li>
                <li class="footer-list__item"><a href="/gdk/hands-on-labs/">Labs</a></li>
                <li class="footer-list__github">
                  <img class="footer__icon" src="/gdk/resources/img/footer/logo-github.svg" alt="Github icon">
                  <a href="https://github.com/oracle/graal-dev-kit" target="blank">Github</a>
                </li>
                <li class="footer-list__github">
                  <img class="footer__icon" src="/gdk/resources/img/footer/slack-icon.svg" alt="Github icon">
                  <a href="https://bit.ly/odevrel_slack" target="blank">#graal-dev-kit-for-micronaut</a>
                </li>
              </ul>
            </div>
          </div>
          <div class="col-md-3 col-sm-4">
            <h6 class="title-footer" onclick="fadeInAndOut(this)">About</h6>
            <div class="grow">
              <ul class="footer-list">
                <li class="footer-list__item"><a href="/gdk/about/#gdk-support" target="blank">Commercial Support</a></li>
                <li class="footer-list__item"><a href="https://www.graalvm.org/" target="blank">GraalVM Native Image</a></li>
                <li class="footer-list__item"><a href="https://micronaut.io/" target="_blank">Micronaut<sup>&reg;</sup> Framework</a></li>
                <li class="footer-list__item"><a href="https://www.oracle.com/cloud/multicloud/what-is-multicloud/" target="_blank">Multicloud</a></li>
                <li class="footer-list__item"><a href="https://www.oracle.com/cloud/" target="blank">Oracle Cloud Infrastructure</a></li>
                <li class="footer-list__item"><a href="https://marketplace.visualstudio.com/items?itemName=oracle-labs-graalvm.graal-cloud-native-pack" target="blank">VS Code Tools</a></li>
              </ul>
            </div>
          </div>
          <div class="col-md-6 col-sm-12 aligning_1024">
            <div class="card--footer card--hovered box">
              <div>
                <div class="rubber-footer footer__oci-section">
                  <p class="title-footer quickstart">Build, test, and deploy applications on Oracle Cloud Infrastructure for free</p>
                  <a href="https://www.oracle.com/cloud/free/" target="_blank"
                    class="btn btn-primary">Try Oracle Cloud Infrastructure Free Tier</a>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="col-12 col-sm-12 col-md-12 col-lg-12">
          <div class="row">
            <div class="col-sm-12">
              <p class="copyright">
                Copyright &copy; 2023-2024, Oracle and/or its affiliates.
                All rights reserved.
                Oracle and Java are registered trademarks of Oracle and/or its affiliates.<br/>
                Micronaut<sup>&reg;</sup> is a registered trademark of Object Computing, Inc. 
                Use is for referential purposes and does not imply any endorsement or affiliation with any third-party product.
                Unauthorized use is strictly prohibited. Other names may be trademarks of their respective owners.
              </p>
              <div id="teconsent"></div>
            </div>
          </div>

        </div>
      </div>

    </div>
  </div>
</footer>

<script>
  function fadeInAndOut(thz) {
    var elmt = thz.nextElementSibling;//Get the element that is below the button that
    //was just clicked
    if (elmt.clientHeight) {
      elmt.style.height = 0;
    } else {
      var wrapper = elmt.querySelector('ul');
      elmt.style.height = wrapper.clientHeight + "px";
    }
    /*
        elmt.classList.toggle("acordianPanelHidden");//Toggle the class which changes
        //attributes which triggers the transition CSS
        */
  }

  // Check TRUSTe Consent for Functional or Implied Approval
  // The if test verifies if the user has given the consent
  if ( (oracle.truste.api.getGdprConsentDecision().consentDecision) &&
      (oracle.truste.api.getGdprConsentDecision().consentDecision.indexOf(0) != -1 ||
        oracle.truste.api.getGdprConsentDecision().consentDecision.indexOf(2) != -1) ) {

      //The following is a sample of a Maxymiser Tag being written to the DOM
      //If the user did not give consent, then the tag is not included and not invoked in the Browser
      document.write('<script type="text/javascript" src="//service.maxymiser.net/cdn/oracle/js/mmcore.js"><\/script>');
  }

  // Check TRUSTe Consent for Advertising or Implied Approval
  // The if test verifies if the user has given the consent
  if ( (oracle.truste.api.getGdprConsentDecision().consentDecision) &&
      (oracle.truste.api.getGdprConsentDecision().consentDecision.indexOf(0) != -1 ||
        oracle.truste.api.getGdprConsentDecision().consentDecision.indexOf(3) != -1) ) {

      //The following is a sample of a BlueKai Core Tag being written to the DOM
      //If the user did not give consent, then the tag is not included and not invoked in the Browser
      document.write('<script type="text/javascript">' +
      'window.bk_async = function() { ' +
      'BKTAG.doTag(62581, 1); }; ' +
      '(function() { ' +
      'var scripts = document.getElementsByTagName(\'script\')[0]; ' +
      'var s = document.createElement(\'script\'); ' +
      's.async = true; ' +
      's.src = "https://tags.bkrtx.com/js/bk-coretag.js"; ' +
      'scripts.parentNode.insertBefore(s, scripts); ' +
      '}()); ' +
      '<\/script>');
  }
</script>

    </div>
    <div class="overlay"></div>

    <!-- Start SiteCatalyst code -->
    <script language="JavaScript" src="https://www.oracle.com/us/assets/metrics/ora_otn.js"></script>
    <!-- End SiteCatalyst code -->

    <script src='/gdk/resources/lib/slick-slider/slick.min.js'></script>
    <script src='/gdk/resources/js/main.js'></script>
    <script src='/gdk/resources/js/ui.js'></script>
    <script src='/gdk/resources/js/filters.js'></script>
    <script src='/gdk/resources/js/sidebar.js'></script>
    <script src='/gdk/resources/js/labs.js'></script>
    <script src='/gdk/resources/lib/highlight/highlight.min.js'></script> 
    <script>hljs.highlightAll();</script>
  </body>
</html>

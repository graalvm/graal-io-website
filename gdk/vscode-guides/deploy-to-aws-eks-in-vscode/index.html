<!DOCTYPE html>
<html lang="en"><head><style type="text/css">.truste_caIcon_display {display: block !important;}</style><style type="text/css">.truste_cursor_pointer {cursor: pointer;}.truste_border_none {border: none;}</style>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:image" content="https://graal-cloud-staging.us.oracle.com/gdk/resources/img/graalvm.png">
    <meta name="twitter:widgets:border-color" content="#55acee">

    <link rel="stylesheet" href="https://graal-cloud-staging.us.oracle.com/gdk/resources/lib/highlight/highlight.min.js">
    <script src="https://graal-cloud-staging.us.oracle.com/gdk/resources/lib/highlight/highlight.min.js"></script>

    <title>Deploying a Java Application to Amazon Elastic Kubernetes Cluster in VS Code</title>
    <meta name="description" content="The Graal Development Kit for Micronaut (GDK) is a build of a curated set of Micronaut framework modules and their required libraries for building portable c...">
    <meta name="last_modified" content="2024-10-10 16:30:05 +0000">
    <meta name="last_built" content="2024-10-29 09:25:27 +0000">
    <link rel="stylesheet" href="https://graal-cloud-staging.us.oracle.com/gdk/assets/main.css" >
    <link rel="apple-touch-icon" sizes="180x180" href="https://graal-cloud-staging.us.oracle.com/gdk/resources/img/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://graal-cloud-staging.us.oracle.com/gdk/resources/img/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://graal-cloud-staging.us.oracle.com/gdk/resources/img/favicon/favicon-16x16.png">
    <link rel="manifest" href="https://graal-cloud-staging.us.oracle.com/gdk/resources/img/favicon/site.webmanifest">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="theme-color" content="#ffffff">
    <meta name="google-site-verification" content="-vRqwa9WYn6AaQGnl88xvrLw6ac4xoKVkZkhanmlRhU">
    <link rel="canonical" href="https://www.graal.cloud/gdk/gdk-modules/database/micronaut-data-jdbc-repository/">

    <!-- TODO: move to stylesheet -->
    <style>
        @media (min-width: 768px) {
            .content {
                padding-top: 60px;
            }
        }

        .colist table {
            border: 0;

            td {
                border: 0;
            }

            tr {
                border: 0;
            }
        }

        .imageblock {
            max-width: 50%;
        }

        main{
            padding-top: 50px !important;
        }

        .content{
            padding-top: 0;
        }

        ul.sectlevel0 > li > a:first-of-type {
            color: #F68831 !important;
            font-weight: 700;
        }

        ul.sectlevel1 > li > a {
            color: #dbe6ff;
            font-weight: 400 !important;
            padding-left: 20px;
            font-size: 14px;
        }

        .conum[data-value]::after {
            content: attr(data-value);
            display: inline-block;
            border: 1px solid;
            -webkit-border-radius: 50%;
            border-radius: 50%;
            text-align: center;
            font-size: .75em;
            width: 1.67em;
            height: 1.67em;
            line-height: 1.67em;
            font-family: "Open Sans", "DejaVu Sans", sans-serif;
            font-style: normal;
            font-weight: bold;
        }
        .conum[data-value]+b {
            display: none;
        }
    </style>

    <!-- jQuery UI Tabs -->
    <link rel="stylesheet" href="//code.jquery.com/ui/1.14.0/themes/base/jquery-ui.css">
    <link rel="stylesheet" href="https://graal-cloud-staging.us.oracle.com/gdk/resources/lib/jquery/jquery-ui.css">
    <script type="text/javascript" id="www-widgetapi-script" src="https://www.youtube.com/s/player/a8476471/www-widgetapi.vflset/www-widgetapi.js" async=""></script><script src="https://www.youtube.com/iframe_api"></script><script async="" src="https://tags.bkrtx.com/js/bk-coretag.js"></script><script src="https://graal-cloud-staging.us.oracle.com/gdk/resources/lib/jquery/jquery-3.7.1.min.js"></script><script src="https://graal-cloud-staging.us.oracle.com/gdk/resources/lib/bootstrap/js/bootstrap.min.js"></script><script src="https://graal-cloud-staging.us.oracle.com/gdk/resources/lib/sticky-sidebar/resizeSensor.js"></script><script src="https://graal-cloud-staging.us.oracle.com/gdk/resources/lib/sticky-sidebar/sticky-sidebar.min.js"></script><script async="" defer="" src="https://buttons.github.io/buttons.js"></script><script async="async" type="text/javascript" src="//consent.trustarc.com/notice?domain=oracle.com&amp;c=teconsent&amp;js=bb&amp;noticeType=bb&amp;text=true&amp;cdn=1&amp;pcookie&amp;gtm=1" crossorigin="" id="truste_0.9548969741402604"></script><script src="https://www.oracle.com/assets/truste-oraclelib.js"></script><script src="https://code.jquery.com/ui/1.14.0/jquery-ui.js"></script></head>

<!-- Add TRUSTe Consent Script and Analytics -->


<!-- jQuery UI Tabs -->

<body class="">
<!-- Start SiteCatalyst code -->
<script language="JavaScript" src="https://www.oracle.com/us/assets/metrics/ora_otn.js"></script><script type="text/javascript" src="https://www.oracleimg.com/us/assets/metrics/ora_code_otn.js"></script><script type="text/javascript" src="https://www.oracleimg.com/us/assets/metrics/ora_code.js"></script>
<!-- End SiteCatalyst code -->

<div class="wrapper wrapper--nofooter">

    <header class="header header--content" role="banner">
        <nav class="menu">
            <div class="menu__row">
                <div>
                    <a href="/gdk/" class="activeMenuItem">
                        <img class="logo-mobile" src="https://graal-cloud-staging.us.oracle.com/gdk/resources/img/gdk-logo-new.svg" alt="Graal Development Kit for Micronaut logo" style="margin-left: 0px;">
                    </a>
                </div>
                <div class="menu__container">
                    <ul class="menu__list">
                        <li class="menu__item">
                            <a href="/gdk/about/" class="menu__link">About</a>
                        </li>
                        <li class="menu__item">
                            <a href="/gdk/get-started/" class="menu__link">Get Started</a>
                        </li>
                        <li class="menu__item">
                            <div class="stack-container">
                                <a href="#" class="menu__link stack__header">Docs</a>
                                <div class="stack-menu-learn">
                                    <div class="stack-row">
                                        <div class="stack-column">
                                            <div class="stack__item">
                                                <img src="https://graal-cloud-staging.us.oracle.com/gdk/resources/img/header-navigation/modules.svg">
                                                <a href="/gdk/modules/" class="item-line">Modules</a>
                                            </div>
                                            <div class="stack__item">
                                                <img src="https://graal-cloud-staging.us.oracle.com/gdk/resources/img/header-navigation/guides.svg">
                                                <a href="/gdk/guides/" class="item-line">Guides</a>
                                            </div>
                                            <div class="stack__item">
                                                <img src="https://graal-cloud-staging.us.oracle.com/gdk/resources/img/header-navigation/labs.svg">
                                                <a href="/gdk/hands-on-labs/" class="item-line">Hands-On Labs</a>
                                            </div>
                                            <div class="stack__item">
                                                <img src="https://graal-cloud-staging.us.oracle.com/gdk/resources/img/header-navigation/tools.svg">
                                                <a href="/gdk/vscode-tools/" class="item-line">Tools</a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li class="menu__item">
                            <div class="stack-container">
                                <a href="#" class="menu__link stack__header">Graal Projects</a>
                                <div class="stack-menu">
                                    <div class="stack-row">
                                        <div class="stack-column">
                                            <div class="stack__item">
                                                <img src="https://graal-cloud-staging.us.oracle.com/gdk/resources/img/header-navigation/graalstack.svg">
                                                <a href="/" class="item-line">Graal</a>
                                            </div>
                                            <div class="stack__item">
                                                <img src="https://graal-cloud-staging.us.oracle.com/gdk/resources/img/header-navigation/graalvm.svg">
                                                <a href="https://graalvm.org/" class="item-line">GraalVM</a>
                                            </div>
                                            <div class="stack__item">
                                                <img src="https://graal-cloud-staging.us.oracle.com/gdk/resources/img/header-navigation/graalos.svg">
                                                <a href="/graalos/" class="item-line">GraalOS</a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li class="menu__launch__mobile">
                            <a href="/gdk/launcher/" class="btn-launch btn btn-primary" target="blank">Create App</a>
                        </li>
                    </ul>
                </div>
                <div class="menu__launch">
                    <a href="/gdk/launcher/" class="btn-launch btn btn-primary" target="blank">Create App</a>
                </div>
            </div>

            <div role="button" class="menu-btn menu-btn--menu js-show-menu" tabindex="-1" title="sweet hamburger">
                <div class="hamburger">
                    <div class="inner"></div>
                </div>
            </div>
            <button aria-label="hamburger mobile menu" class="btn btn-mobile-menu js-show-menu">
                <div class="inner"></div>
            </button>
        </nav>


    </header>


    <main class="content" aria-label="Content">
        <div class="wrapper wrapper-content">
            <article>
                <div class="row d-flex flex-wrap">
                    <div class="col-sm-3 docsimpro col-bg">
                        <div class="sidebar-wrap is-affixed" style="height: 473px; position: relative;"><div class="inner-wrapper-sticky" style="position: fixed; top: 74px; left: 0px; width: 300px;">
                            <div class="sidebar">
                                <div class="menuabout">
                                    <img id="sidebarClose" src="https://graal-cloud-staging.us.oracle.com/gdk/resources/img/arrow_sidebar(close).svg" alt="Expand or collapse sidebar" class="btn-color no-display">
                                    <img id="sidebarOpen" src="https://graal-cloud-staging.us.oracle.com/gdk/resources/img/arrow_sidebar.svg" alt="Expand or collapse sidebar">
                                </div>

                                                                <div class="toc-floating">
                                <div class="toc-bullets">
                                    <li class="toc-bullets-main">
                                        <a href="/gdk/vscode-guides/" class="_icon-book">
                                            VS Code Guides
                                        </a>
                                    </li>
                                    <li class="toc-bullets-sub toc-bullets-highlight">
                                        <a href="/gdk/vscode-guides//deploy-to-aws-eks-in-vscode/" class="activeMenuItem">
                                            Deploying a Java Application to Amazon Elastic Kubernetes Cluster in VS Code
                                        </a>
                                    </li>
                                    <div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#install-extensions">1. Install Extensions</a></li>
<li><a href="#create-a-java-application-using-graal-development-kit-for-micronaut-launcher">2. Create a Java Application Using Graal Development Kit for Micronaut Launcher</a></li>
<li><a href="#create-a-shared-aws-credentials-file-and-connect-to-aws">3. Create a Shared AWS Credentials File and Connect to AWS</a></li>
<li><a href="#create-a-repository-in-amazon-elastic-container-registry-ecr">4. Create a Repository in Amazon Elastic Container Registry (ECR)</a></li>
<li><a href="#containerize-the-application-and-push-a-container-image">5. Containerize the Application and Push a Container Image</a></li>
<li><a href="#create-an-amazon-eks-cluster-and-setup-connection-to-your-cluster">6. Create an Amazon EKS Cluster and Setup Connection to Your Cluster</a></li>
<li><a href="#deploy-a-java-application-to-eks-cluster">7. Deploy a Java Application to EKS Cluster</a></li>
<li><a href="#clean-up-resources">8. Clean Up Resources</a></li>
</ul>
</div>
                                </div>
                            </div>


                            </div>
                            <div class="resize-sensor" style="position: absolute; inset: 0px; overflow: hidden; z-index: -1; visibility: hidden;"><div class="resize-sensor-expand" style="position: absolute; left: 0; top: 0; right: 0; bottom: 0; overflow: hidden; z-index: -1; visibility: hidden;"><div style="position: absolute; left: 0px; top: 0px; transition: all 0s ease 0s; width: 100000px; height: 100000px;"></div></div><div class="resize-sensor-shrink" style="position: absolute; left: 0; top: 0; right: 0; bottom: 0; overflow: hidden; z-index: -1; visibility: hidden;"><div style="position: absolute; left: 0; top: 0; transition: 0s; width: 200%; height: 200%"></div></div></div></div></div>
                        <div class="resize-sensor" style="position: absolute; inset: 0px; overflow: hidden; z-index: -1; visibility: hidden;"><div class="resize-sensor-expand" style="position: absolute; left: 0; top: 0; right: 0; bottom: 0; overflow: hidden; z-index: -1; visibility: hidden;"><div style="position: absolute; left: 0px; top: 0px; transition: all 0s ease 0s; width: 100000px; height: 100000px;"></div></div><div class="resize-sensor-shrink" style="position: absolute; left: 0; top: 0; right: 0; bottom: 0; overflow: hidden; z-index: -1; visibility: hidden;"><div style="position: absolute; left: 0; top: 0; transition: 0s; width: 200%; height: 200%"></div></div></div></div>

                    <div class="col-sm-9 docsmod">
                        <div id="content-wrapper" class="docs-content docs-content--with-sidebar"><h1>Deploying a Java Application to Amazon Elastic Kubernetes Cluster in VS Code</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This guide shows you how to create a Java application, containerize and deploy it to Amazon Elastic Kubernetes Service (EKS) from within VS Code with ease, using the Graal Development Kit for Micronaut Extension Pack. The Micronaut® Kubernetes module provides seamless integration with EKS.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><a href="https://aws.amazon.com/eks/">EKS</a> is a managed Kubernetes service for deploying containerized applications to the cloud.</p>
</div>
</blockquote>
</div>
<h3 id="prerequisites" class="discrete">Prerequisites</h3>
<div class="ulist">
<ul>
<li>
<p>A Java Development Kit (JDK) installation (JDK 17 or later).</p>
</li>
<li>
<p>A Docker-API compatible container runtime such as <a href="https://docs.rancherdesktop.io/getting-started/installation/">Rancher Desktop</a> or <a href="https://www.docker.io/gettingstarted/">Docker</a>.</p>
</li>
<li>
<p>An Amazon Web Services (AWS) account. Create an account at <a href="https://portal.aws.amazon.com/billing/signup">Sign up for AWS</a>.</p>
</li>
<li>
<p>The <a href="https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html">AWS CLI</a>.</p>
</li>
<li>
<p>An AWS user with sufficient permissions to create and manage EKS and <a href="https://aws.amazon.com/ecr/">Amazon Elastic Container Registry (ECR)</a>.</p>
</li>
<li>
<p><a href="https://kubernetes.io/docs/reference/kubectl/"><code>kubectl</code></a> to deploy the application to EKS.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="install-extensions">1. Install Extensions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To get started, install the <em>Graal Development Kit for Micronaut</em> Extension Pack and <em>AWS Toolkit for Visual Studio Code</em>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Follow <a href="/gdk/vscode-tools/graal-development-kit-extension-pack/#installing">Installing the Graal Development Kit for Micronaut Extension Pack</a> to install the extension pack and its dependencies in VS Code.</p>
</li>
<li>
<p>To install the <a href="https://aws.amazon.com/ru/visualstudiocode/">AWS Toolkit for Visual Studio Code</a> plugin, follow these steps:</p>
<div class="ulist">
<ul>
<li>
<p>In the VS Code Activity Bar, click the <strong>Extensions</strong> icon. This opens the Extensions view, which provides you with access to the VS Code Marketplace.</p>
</li>
<li>
<p>In the search box, search for <strong>AWS Toolkit</strong>.</p>
</li>
<li>
<p>Once found, choose it to see its details, then click <strong>Install</strong>.</p>
</li>
<li>
<p>Once installed, if you&#8217;re prompted to restart the editor, click <strong>Reload Required</strong> to finish the installation.After you install the Toolkit for VS Code, notice the AWS icon the VS Code Activity Bar.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="create-a-java-application-using-graal-development-kit-for-micronaut-launcher">2. Create a Java Application Using Graal Development Kit for Micronaut Launcher</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Create a Java application, using the <a href="/gdk/vscode-tools/graal-cloud-native-launcher">Graal Development Kit for Micronaut Launcher</a>, that you will later containerize and deploy to Amazon Elastic Kubernetes Service (EKS).</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Go to <strong>View</strong>, <strong>Command Palette</strong>, search for "Graal Dev Kit", and invoke the <strong>Graal Dev Kit: Create New Project</strong> quick action:</p>
<div class="imageblock">
<div class="content">
<img src="/gdk/images/tools/gdk-vscode-actions.png" alt="Create New Project Action">
</div>
</div>
</li>
<li>
<p>Follow the command prompts to generate a new Maven or Gradle project. For example, to create a simple Java application:</p>
<div class="ulist">
<ul>
<li>
<p>Pick Micronaut version: <em>Default</em></p>
</li>
<li>
<p>Pick application type: <em>Application</em></p>
</li>
<li>
<p>Pick project Java: Select your JDK installation</p>
</li>
<li>
<p>Provide a project name: <em>aws-k8s-demo</em></p>
</li>
<li>
<p>Provide base package: <em>com.example</em></p>
</li>
<li>
<p>Pick project services: <em>none</em>. Click <strong>OK</strong> to confirm</p>
</li>
<li>
<p>Pick project features: none. Click <strong>OK</strong> to confirm</p>
</li>
<li>
<p>Pick build tool: <em>Gradle (Groovy)</em></p>
</li>
<li>
<p>Pick test framework: <em>JUnit</em></p>
</li>
<li>
<p>Pick cloud platform: <em>AWS</em></p>
</li>
<li>
<p>Pick generate sample code: <em>No</em></p>
</li>
</ul>
</div>
</li>
<li>
<p>Finally, select the destination directory on your local disk and whether to open the created project in a new window or add it to the current workspace. The wizard creates a directory named <em>aws-k8s-demo</em> containing an application in a package named <code>com.example</code>.</p>
</li>
<li>
<p>(Required only for macOS AArch64) At the beginning of the configuration file, <em>aws/build.gradle</em>, add the following dependency to use the appropriate version of JNA:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">buildscript {
    dependencies {
        classpath("com.github.docker-java:docker-java-transport-httpclient5:3.2.13") {
            because("macOS AArch64 needs a specific version of JNA")
        }
    }
}</code></pre>
</div>
</div>
</li>
<li>
<p>(Required only for macOS AArch64) At the end of the configuration file, <em>aws/build.gradle</em>, add the following code so that Gradle builds a container image using the <code>openjdk:17-slim</code> base image (it defaults to <code>openjdk:17-alpine</code> which is not multiplatform).</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tasks.withType(com.bmuschko.gradle.docker.tasks.image.Dockerfile) {
    baseImage = 'openjdk:17-slim'
}</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="add-a-controller">2.1. Add a Controller</h3>
<div class="paragraph">
<p>To create a microservice that responds with "Hello World", you need a controller. Create a file named <em>lib/src/main/java/com/example/HelloController.java</em> with the following contents:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package com.example;

import io.micronaut.http.MediaType;
import io.micronaut.http.annotation.Controller;
import io.micronaut.http.annotation.Get;
import io.micronaut.http.annotation.Produces;

@Controller <i class="conum" data-value="1"></i><b>(1)</b>
public class HelloController {
    @Get
    @Produces(MediaType.TEXT_PLAIN) <i class="conum" data-value="2"></i><b>(2)</b>
    public String index() {
        return "Hello World";
    }

    @Get ("/{name}") <i class="conum" data-value="3"></i><b>(3)</b>
    @Produces(MediaType.TEXT_PLAIN)
    public String index(String name) {
        return "Hello " + name;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>1</strong> The class is defined as a controller with the <a href="https://docs.micronaut.io/latest/api/io/micronaut/http/annotation/Controller.html"><code>@Controller</code></a> annotation mapped to the path <code>/</code> (the default mapping for the base URI).</p>
</div>
<div class="paragraph">
<p><strong>2</strong> By default, a Micronaut response uses <code>application/json</code> as <code>Content-Type</code>. To return a String, not a JSON object, set it to <code>text/plain</code>.</p>
</div>
<div class="paragraph">
<p><strong>3</strong> The <a href="https://docs.micronaut.io/latest/api/io/micronaut/http/annotation/Get.html"><code>@Get</code></a> annotation maps the <code>index</code> method to an HTTP GET request on <code>/{name}</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="build-and-run-the-application">2.2. Build and Run the Application</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open a new Terminal window in VS Code (<strong>Terminal</strong> &gt; <strong>New Terminal</strong>). Enter the following command to build the application JAR file and run it:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./gradlew :aws:run</code></pre>
</div>
</div>
<div class="paragraph">
<p>It starts the application on port 8080.</p>
</div>
</li>
<li>
<p>Split the Terminal window (<strong>Terminal</strong> &gt; <strong>Split Terminal</strong>) and send some <code>curl</code> requests to test the application in a split terminal:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl http://localhost:8080/</code></pre>
</div>
</div>
<div class="paragraph">
<p>It should output "Hello World".</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl http://localhost:8080/GDK/</code></pre>
</div>
</div>
<div class="paragraph">
<p>It should output "Hello GDK".
Press <code>CTRL+C</code> to stop the application.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="create-a-shared-aws-credentials-file-and-connect-to-aws">3. Create a Shared AWS Credentials File and Connect to AWS</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Follow the instructions provided in the AWS documentation to <a href="https://docs.aws.amazon.com/toolkit-for-vscode/latest/userguide/setup-credentials.html#setup-credentials-set-access-keys">Add your AWS access keys to your environment</a>.</p>
</div>
<div class="paragraph">
<p>Follow the instructions provided in the AWS documentation to <a href="https://docs.aws.amazon.com/toolkit-for-vscode/latest/userguide/connect.html#connect-to-aws">Connect to AWS through the Toolkit for VS Code</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="create-a-repository-in-amazon-elastic-container-registry-ecr">4. Create a Repository in Amazon Elastic Container Registry (ECR)</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://docs.aws.amazon.com/AmazonECR/latest/userguide/what-is-ecr.html">Amazon Elastic Container Registry (Amazon ECR)</a> is an AWS-managed container image registry service. Amazon ECR supports private repositories with resource-based permissions. Amazon ECR is integrated with Amazon Elastic Container Service (Amazon ECS).</p>
</div>
<div class="paragraph">
<p>The following steps walk you through what is needed to push a container image to a private Amazon ECR repository using the AWS CLI. Before you begin, make sure that you have necessary software listed in the <a href="#prerequisites">Prerequisites</a>. Also, ensure that you have your AWS account id and region identifier (both of these can be obtained from your AWS console).</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Authenticate to Amazon ECR with <code>docker</code> (it requires the AWS CLI installed, see <a href="#prerequisites">Prerequisites</a>). The AWS CLI provides a <code>get-login-password</code> command to simplify the authentication process. The Docker CLI (<code>docker</code>) can push and pull images with Amazon ECR.</p>
<div class="ulist">
<ul>
<li>
<p>Open a Terminal window in VS Code (<strong>Terminal</strong> &gt; <strong>New Terminal</strong>) and enter the following command to authenticate:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">aws ecr get-login-password --region &lt;region&gt; | docker login --username AWS --password-stdin &lt;aws_account_id&gt;.dkr.ecr.&lt;region&gt;.amazonaws.com</code></pre>
</div>
</div>
</li>
<li>
<p>Replace <em>&lt;region&gt;</em> with your AWS region key. <code>AWS</code> is the default username. The password is composed of <em>&lt;aws_account_id&gt;</em>, which is your AWS account ID, and of the <em>&lt;region&gt;</em> key. For example:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">aws ecr get-login-password --region us-east-1 | docker login --username AWS --password-stdin 1234567890.dkr.ecr.us-east-1.amazonaws.com</code></pre>
</div>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Note: If you are a Windows user, the command is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">(Get-ECRLoginCommand).Password | docker login --username AWS --password-stdin aws_account_id.dkr.ecr.region.amazonaws.com</code></pre>
</div>
</div>
<div class="paragraph">
<p>Read more on <a href="https://docs.aws.amazon.com/AmazonECR/latest/userguide/getting-started-cli.html">Using Amazon ECR with the AWS CLI</a>.</p>
</div>
</blockquote>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Create a repository in Amazon ECR that will hold your containerized application (a container image). Under your active AWS connection, focus on ECR and click <strong>Create Repository</strong>:</p>
<div class="imageblock">
<div class="content">
<img src="/gdk/images/tools/aws/ecr-create-repository.png" alt="Amazon ECR: Create Repository">
</div>
</div>
<div class="paragraph">
<p>Enter a repository name, for example, <em>gdk-demo</em>.</p>
</div>
</li>
<li>
<p>Get the repository URI. Open the ECR repositories list, right-click your new repository, and click <strong>Copy Repository URI</strong>:</p>
<div class="imageblock">
<div class="content">
<img src="/gdk/images/tools/aws/ecr-copy-repo-uri.png" alt="Amazon ECR: Copy Repository URI">
</div>
</div>
</li>
<li>
<p>Specify the path to your new repository in the build configuration file, <em>aws/build.gradle</em>, as follows:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">dockerBuild {
    images = ["&lt;aws_account_id&gt;.dkr.ecr.&lt;region&gt;.amazonaws.com/gdk-demo:$project.version"]
}</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>You are all set to build a container image for your application and push it to Amazon ECR.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="containerize-the-application-and-push-a-container-image">5. Containerize the Application and Push a Container Image</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this section, you create a container image of your Micronaut application and then push it to Amazon ECR.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Note: The build and deployment architecture must match. You cannot build a container image on an AArch64 platform and deploy it to an Intel-based platform, such as Amazon Elastic Compute Cloud (Amazon EC2) or Amazon Elastic Kubernetes Service (Amazon EKS).</p>
</div>
</blockquote>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Build the project in your VS Code terminal:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./gradlew clean build</code></pre>
</div>
</div>
</li>
<li>
<p>Build a container image of the application. Note that, because you created the application using Graal Development Kit in VS Code, you do not need to provide a Dockerfile. It is provided by the extension at build time.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./gradlew dockerBuild</code></pre>
</div>
</div>
</li>
<li>
<p>Query <code>docker</code> to list your newly built container image:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">docker images | head -n2</code></pre>
</div>
</div>
</li>
<li>
<p>Push the container image to the container repository:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./gradlew dockerPush</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Now that your container image is stored in Amazon ECR, you can deploy it to an Amazon EKS cluster.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="create-an-amazon-eks-cluster-and-setup-connection-to-your-cluster">6. Create an Amazon EKS Cluster and Setup Connection to Your Cluster</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Follow the AWS documentation to <a href="https://docs.aws.amazon.com/eks/latest/userguide/getting-started-console.html">"Create an Amazon EKS cluster, Configure Your Computer to Communicate with Your Cluster, and Create Nodes"</a>.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Do not follow the <a href="https://docs.aws.amazon.com/eks/latest/userguide/getting-started-console.html#gs-console-clean-up">Step 5: Delete resources</a> chapter at this point.</p>
</div>
</blockquote>
</div>
</div>
</div>
<div class="sect1">
<h2 id="deploy-a-java-application-to-eks-cluster">7. Deploy a Java Application to EKS Cluster</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a Kubernetes deployment manifest file. In the project root, create a file named <em>deployment.yml</em> with the following contents:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yml hljs" data-lang="yml">apiVersion: apps/v1
kind: Deployment
metadata:
  name: "aws-k8s-demo"
spec:
  selector:
    matchLabels:
      app: "aws-k8s-demo"
  template:
    metadata:
      labels:
        app: "aws-k8s-demo"
    spec:
      containers:
      - name: "aws-k8s-demo"
        image: "&lt;aws_account_id&gt;.dkr.ecr.&lt;region&gt;.amazonaws.com/gdk-demo:1.0-SNAPSHOT"</code></pre>
</div>
</div>
<div class="paragraph">
<p>(Copy the repository URI from the build configuration file, <em>aws/build.gradle</em>.)
To learn more, see <a href="https://kubernetes.io/docs/concepts/workloads/controllers/deployment/">Deployments in the Kubernetes documentation</a>.</p>
</div>
</li>
<li>
<p>Create a deployment by applying the manifest:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl apply -f deployment.yml</code></pre>
</div>
</div>
<div class="paragraph">
<p>It should output the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">deployment.apps/aws-k8s-demo created</code></pre>
</div>
</div>
<div class="paragraph">
<p>This deployment pulls your container image from a public repository (Amazon ECR repository) and deploys three replicas (individual pods) of it to your cluster.</p>
</div>
</li>
<li>
<p>Run the next command to check the status of the pods:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl get pods</code></pre>
</div>
</div>
<div class="paragraph">
<p>It should return a similar message:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">NAME READY STATUS RESTARTS AGE
aws-k8s-demo-6fdf89f45-5rpsp 0/1 Pending 0 3m</code></pre>
</div>
</div>
<div class="paragraph">
<p>Wait a couple of seconds for the <code>Pending</code> state to change to <code>Running</code>.
Your application is now deployed to the EKS cluster.</p>
</div>
</li>
<li>
<p>Port-forward the port to access your Kubernetes cluster directly from your local network:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl port-forward &lt;pod-name&gt; 8080:8080</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>kubectl port-forward</code> uses a resource name, such as a pod name, to select a matching pod to port forward.</p>
</div>
</li>
<li>
<p>Send some <code>curl</code> requests to test your application as you did in step <strong>2.2</strong>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl http://localhost:8080/</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl http://localhost:8080/GDK/</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>The difference is that now your application is deployed to an EKS cluster and running on an Amazon EC2 Linux compute host.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="clean-up-resources">8. Clean Up Resources</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To delete all the resources you created in this guide, run this command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl delete namespaces &lt;namespace-name&gt;</code></pre>
</div>
</div>
<h3 id="summary" class="discrete">Summary</h3>
<div class="paragraph">
<p>This guide demonstrated how to deploy a Java microservice application to Amazon Elastic Kubernetes Service (EKS) from within VS Code, using the <em>Graal Development Kit for Micronaut</em> Extension Pack.</p>
</div>
<h3 id="related-documentation" class="discrete">Related Documentation</h3>
<div class="ulist">
<ul>
<li>
<p><a href="/gdk/vscode-tools/graal-development-kit-extension-pack/">Graal Development Kit for Micronaut Extension Pack</a></p>
</li>
<li>
<p><a href="https://micronaut-projects.github.io/micronaut-kubernetes/latest/guide/">Micronaut Kubernetes module</a></p>
</li>
<li>
<p><a href="https://docs.aws.amazon.com/eks/">Amazon Elastic Kubernetes Service (EKS)</a></p>
</li>
</ul>
</div>
</div>
</div></div>
                        <div role="button" class="menu-btn menu-btn--sidebar js-show-sidebar" title="sweet hamburger">
                            <div class="hamburger">
                                <div class="inner"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </article>



        </div>

    </main>


    <footer class="footer footer__mobile">

        <div class="container-fluid container-fluid--custom-sm">
            <div class="row">
                <div class="col-12 col-sm-12 col-md-12 col-lg-12">
                    <div class="row footer-content">
                        <div class="col-md-3 col-sm-4">
                            <h6 class="title-footer" onclick="fadeInAndOut(this)">Learn</h6>
                            <div class="grow">
                                <ul class="footer-list">
                                    <li class="footer-list__item"><a href="/gdk/get-started/">Get Started</a></li>
                                    <li class="footer-list__item"><a href="/gdk/guides/">Guides</a></li>
                                    <li class="footer-list__item"><a href="/gdk/hands-on-labs/">Labs</a></li>
                                    <li class="footer-list__github">
                                        <img class="footer__icon" src="https://graal-cloud-staging.us.oracle.com/gdk/resources/img/footer/logo-github.svg" alt="Github icon">
                                        <a href="https://github.com/oracle/graal-dev-kit" target="blank">Github</a>
                                    </li>
                                    <li class="footer-list__github">
                                        <img class="footer__icon" src="https://graal-cloud-staging.us.oracle.com/gdk/resources/img/footer/slack-icon.svg" alt="Github icon">
                                        <a href="https://bit.ly/odevrel_slack" target="blank">#graal-dev-kit-for-micronaut</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-md-3 col-sm-4">
                            <h6 class="title-footer" onclick="fadeInAndOut(this)">About</h6>
                            <div class="grow">
                                <ul class="footer-list">
                                    <li class="footer-list__item"><a href="/gdk/about/#gdk-support" target="blank">Commercial Support</a></li>
                                    <li class="footer-list__item"><a href="https://www.graalvm.org/" target="blank">GraalVM Native Image</a></li>
                                    <li class="footer-list__item"><a href="https://micronaut.io/" target="_blank">Micronaut<sup>®</sup> Framework</a></li>
                                    <li class="footer-list__item"><a href="https://www.oracle.com/cloud/multicloud/what-is-multicloud/" target="_blank">Multicloud</a></li>
                                    <li class="footer-list__item"><a href="https://www.oracle.com/cloud/" target="blank">Oracle Cloud Infrastructure</a></li>
                                    <li class="footer-list__item"><a href="https://marketplace.visualstudio.com/items?itemName=oracle-labs-graalvm.graal-cloud-native-pack" target="blank">VS Code Tools</a></li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-md-6 col-sm-12 aligning_1024">
                            <div class="card--footer card--hovered box">
                                <div>
                                    <div class="rubber-footer footer__oci-section">
                                        <p class="title-footer quickstart">Build, test, and deploy applications on Oracle Cloud Infrastructure for free</p>
                                        <a href="https://www.oracle.com/cloud/free/" target="_blank" class="btn btn-primary">Try Oracle Cloud Infrastructure Free Tier</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-12 col-sm-12 col-md-12 col-lg-12">
                        <div class="row">
                            <div class="col-sm-12">
                                <p class="copyright">
                                    Copyright © 2023-2024, Oracle and/or its affiliates.
                                    All rights reserved.
                                    Oracle and Java are registered trademarks of Oracle and/or its affiliates.<br>
                                    Micronaut<sup>®</sup> is a registered trademark of Object Computing, Inc.
                                    Use is for referential purposes and does not imply any endorsement or affiliation with any third-party product.
                                    Unauthorized use is strictly prohibited. Other names may be trademarks of their respective owners.
                                </p>
                                <div id="teconsent" consent="0,1,2" aria-label="Open Cookie Preferences Modal" class="truste_caIcon_display" role="complementary"><script async="async" type="text/javascript" crossorigin="" importance="high" src="https://consent.trustarc.com/asset/notice.js/v/v1.7-776"></script><a role="link" id="icon-id0368112092352622" tabindex="0" lang="en" aria-haspopup="dialog" aria-label="Cookie Preferences, opens a dedicated popup modal window" class="truste_cursor_pointer">Cookie Preferences</a></div>
                            </div>
                        </div>

                    </div>
                </div>

            </div>
        </div>
    </footer>

    <script>
        function fadeInAndOut(thz) {
            var elmt = thz.nextElementSibling;//Get the element that is below the button that
            //was just clicked
            if (elmt.clientHeight) {
                elmt.style.height = 0;
            } else {
                var wrapper = elmt.querySelector('ul');
                elmt.style.height = wrapper.clientHeight + "px";
            }
            /*
                elmt.classList.toggle("acordianPanelHidden");//Toggle the class which changes
                //attributes which triggers the transition CSS
                */
        }

        // Check TRUSTe Consent for Functional or Implied Approval
        // The if test verifies if the user has given the consent
        if ( (oracle.truste.api.getGdprConsentDecision().consentDecision) &&
            (oracle.truste.api.getGdprConsentDecision().consentDecision.indexOf(0) != -1 ||
                oracle.truste.api.getGdprConsentDecision().consentDecision.indexOf(2) != -1) ) {

            //The following is a sample of a Maxymiser Tag being written to the DOM
            //If the user did not give consent, then the tag is not included and not invoked in the Browser
            document.write('<script type="text/javascript" src="//service.maxymiser.net/cdn/oracle/js/mmcore.js"><\/script>');
        }

        // Check TRUSTe Consent for Advertising or Implied Approval
        // The if test verifies if the user has given the consent
        if ( (oracle.truste.api.getGdprConsentDecision().consentDecision) &&
            (oracle.truste.api.getGdprConsentDecision().consentDecision.indexOf(0) != -1 ||
                oracle.truste.api.getGdprConsentDecision().consentDecision.indexOf(3) != -1) ) {

            //The following is a sample of a BlueKai Core Tag being written to the DOM
            //If the user did not give consent, then the tag is not included and not invoked in the Browser
            document.write('<script type="text/javascript">' +
                'window.bk_async = function() { ' +
                'BKTAG.doTag(62581, 1); }; ' +
                '(function() { ' +
                'var scripts = document.getElementsByTagName(\'script\')[0]; ' +
                'var s = document.createElement(\'script\'); ' +
                's.async = true; ' +
                's.src = "https://tags.bkrtx.com/js/bk-coretag.js"; ' +
                'scripts.parentNode.insertBefore(s, scripts); ' +
                '}()); ' +
                '<\/script>');
        }
    </script><script type="text/javascript" src="//service.maxymiser.net/cdn/oracle/js/mmcore.js"></script><script type="text/javascript">window.bk_async = function() { BKTAG.doTag(62581, 1); }; (function() { var scripts = document.getElementsByTagName('script')[0]; var s = document.createElement('script'); s.async = true; s.src = "https://tags.bkrtx.com/js/bk-coretag.js"; scripts.parentNode.insertBefore(s, scripts); }()); </script>

</div>
<div class="overlay"></div>

<!-- Start SiteCatalyst code -->
<script language="JavaScript" src="https://www.oracle.com/us/assets/metrics/ora_otn.js"></script><script type="text/javascript" src="https://www.oracleimg.com/us/assets/metrics/ora_code_otn.js"></script><script type="text/javascript" src="https://www.oracleimg.com/us/assets/metrics/ora_code.js"></script>
<!-- End SiteCatalyst code -->

<script src="https://graal-cloud-staging.us.oracle.com/gdk/resources/lib/slick-slider/slick.min.js"></script>
<script src='https://graal-cloud-staging.us.oracle.com/gdk/resources/js/main.js'></script>
<script src="https://graal-cloud-staging.us.oracle.com/gdk/resources/js/ui.js"></script>
<script src="https://graal-cloud-staging.us.oracle.com/gdk/resources/js/filters.js"></script>
<script src="https://graal-cloud-staging.us.oracle.com/gdk/resources/js/sidebar.js"></script>
<script src="https://graal-cloud-staging.us.oracle.com/gdk/resources/js/labs.js"></script>
<!--<script>-->
<!--    hljs.initHighlightingOnLoad();-->
<!--</script>-->


<iframe name="trustarc_notice" id="trustarcNoticeFrame" title="Trustarc Cross-Domain Consent Frame" src="https://consent.trustarc.com/get?name=crossdomain.html&amp;domain=oracle.com" style="display: none;"></iframe></body></html>
<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta property="og:image" content="/gcn/resources/img/graalvm.png" />
  <meta name="twitter:widgets:border-color" content="#55acee">

  <title>
    
      Deploy a Micronaut Microservices Application to Oracle Cloud Infrastructure Container Engine for Kubernetes
    
  </title>
  <meta name="description" content="Graal Cloud Native (GCN) is a build of a curated set of Micronaut framework modules and their required libraries for building portable cloud-native microserv..."/>
  <meta name="last_modified" content="2024-01-31 16:07:30 +0000"/>
  <meta name="last_built" content="2024-02-01 16:32:39 +0000"/>
  <link rel="stylesheet" href="/gcn/assets/main.css">
  <link rel="apple-touch-icon" sizes="180x180" href="/gcn/resources/img/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/gcn/resources/img/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/gcn/resources/img/favicon/favicon-16x16.png">
  <link rel="manifest" href="/resources/img/favicon/site.webmanifest">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
  <meta name="google-site-verification" content="-vRqwa9WYn6AaQGnl88xvrLw6ac4xoKVkZkhanmlRhU" />
  <link rel="canonical" href="https://www.graal.cloud/gcn/gcn-modules/kubernetes/micronaut-k8s-oci/">

  <!-- jQuery UI Tabs -->
  <link rel="stylesheet" href="//code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css">
  <link rel="stylesheet" href="/gcn/resources/lib/jquery/jquery-ui.css">
</head>

      <script src="/gcn/resources/lib/jquery/jquery-3.6.1.min.js"></script>
    <script src="/gcn/resources/lib/bootstrap/js/bootstrap.min.js"></script>
    <script src='/gcn/resources/lib/sticky-sidebar/resizeSensor.js'></script>
    <script src='/gcn/resources/lib/sticky-sidebar/sticky-sidebar.min.js'></script>
    <script src="/gcn/resources/lib/highlight/highlight.min.js"></script>
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <!-- Add TRUSTe Consent Script and Analytics -->
    <script async="async" type="text/javascript" src='//consent.trustarc.com/notice?domain=oracle.com&c=teconsent&js=bb&noticeType=bb&text=true&cdn=1&pcookie&gtm=1' crossorigin></script>
    <script src="https://www.oracle.com/assets/truste-oraclelib.js"></script>
    <!-- jQuery UI Tabs -->
    <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.js"></script>


  <body class="preload">
    <!-- Start SiteCatalyst code -->
    <script language="JavaScript" src="https://www.oracle.com/us/assets/metrics/ora_otn.js"></script>
    <!-- End SiteCatalyst code -->

    <div  class="wrapper wrapper--nofooter" >

      <header  class="header header--content" 
  role="banner">

  

  

    <nav class="menu">
      <div class="menu__row">
        <div>
          <a href="/gcn/">
            <img class="logo-mobile" src="/gcn/resources/img/gcn-logo-01.svg" alt="Graal Cloud Native logo">
          </a>
        </div>
        <div class="menu__container">
          <ul class="menu__list">
            <li class="menu__item">
              <a href="/gcn/about/" class="menu__link">About</a>
            </li>
            <li class="menu__item">
              <a href="/gcn/get-started/" class="menu__link">Get Started</a>
            </li>
            <li class="menu__item">
              <div class="stack-container">
                <a href="#" class="menu__link stack__header">Docs</a>
                <div class="stack-menu-learn">
                  <div class="stack-row">
                    <div class="stack-column">
                      <div class="stack__item">
                        <img src='/gcn/resources/img/header-navigation/modules.svg'>
                        <a href="/gcn/modules/" class="item-line">Modules</a>
                      </div>
                      <div class="stack__item">
                        <img src='/gcn/resources/img/header-navigation/guides.svg'>
                        <a href="/gcn/guides/" class="item-line">Guides</a>
                      </div>
                      <div class="stack__item">
                        <img src='/gcn/resources/img/header-navigation/labs.svg'>
                        <a href="/gcn/hands-on-labs/" class="item-line">Hands-On Labs</a>
                      </div>
                      <div class="stack__item">
                        <img src='/gcn/resources/img/header-navigation/tools.svg'>
                        <a href="/gcn/vscode-tools/" class="item-line">Tools</a>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </li>
            <li class="menu__item">
              <div class="stack-container">
                <a href="#" class="menu__link stack__header">Graal Projects</a>
                <div class="stack-menu">
                  <div class="stack-row">
                    <div class="stack-column">
                      <div class="stack__item">
                        <img src='/gcn/resources/img/header-navigation/graalstack.svg'>
                        <a href="https://graal.cloud/" class="item-line">Graal</a>
                      </div>
                      <div class="stack__item">
                        <img src='/gcn/resources/img/header-navigation/graalvm.svg'>
                        <a href="https://graalvm.org/" class="item-line">GraalVM</a>
                      </div>
                      <div class="stack__item">
                        <img src='/gcn/resources/img/header-navigation/graalos.svg'>
                        <a href="https://graal.cloud/graalos/" class="item-line">GraalOS</a>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </li>
            <li class="menu__launch__mobile">
              <a href="/gcn/launcher/" class="btn-launch btn btn-primary" target="blank">Create App</a>
            </li>
          </ul>
        </div>
        <div class="menu__launch">
          <a href="/gcn/launcher/" class="btn-launch btn btn-primary" target="blank">Create App</a>
        </div>
      </div>

      <div role="button" class="menu-btn menu-btn--menu js-show-menu" tabindex="-1" title="sweet hamburger">
        <div class="hamburger">
          <div class="inner"></div>
        </div>
      </div>
      <button aria-label="hamburger mobile menu" class="btn btn-mobile-menu js-show-menu">
        <div class="inner"></div>
      </button>
    </nav>

  
</header>


      <main  class="content"   aria-label="Content">
        <div class="wrapper wrapper-content">
  <article>
  <div class="row d-flex flex-wrap">
    <div class="col-sm-3 docsimpro col-bg">
      <div class="sidebar-wrap">
        <div class="sidebar">
          <div class="menuabout">
            <img id="sidebarClose" src="/gcn/resources/img/arrow_sidebar(close).svg" alt="Expand or collapse sidebar"
              class="btn-color no-display">
            <img id="sidebarOpen" src="/gcn/resources/img/arrow_sidebar.svg" alt="Expand or collapse sidebar">
          </div>
          
<div class="toc-floating">


<div class="toc-bullets">


  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    

    
      
        
          <li class="toc-bullets-main">
        
          
          <a href="/gcn/docs/gcn-modules/kubernetes/" class="_icon-book">
            Kubernetes
          </a>
        </li>

        
        

        
        
          
          <li class="toc-bullets-sub toc-bullets-highlight">
          
            
            <a href="/gcn/gcn-modules/kubernetes/micronaut-k8s-oci/">
              Deploy a Micronaut Microservices Application to Oracle Cloud Infrastructure Container Engine for Kubernetes
            </a>
          </li>

          
            <div>
  <script>
    var scriptElement = document.currentScript;
    var div = $(scriptElement.parentElement);
    $(window).on("load", function () {
      $("#content-wrapper h2").each(function () {
        var li = $("<li></li>", { class: "toc-bullets-sub toc-bullets-sub-3" });
        var a = $("<a></a>", { href: "#" + $(this).attr("id") });
        a.text($(this).text().replace('#', ''));
        li.append(a);
        li.click(function (e) {
          e.preventDefault();
          var target = $(a.attr('href'));
          var scrollTo = target.offset().top - 80; // 80 - indent
          $('html, body').animate({ scrollTop: scrollTo }, 1000);
        });
        div.append(li);
      });
    });
  </script>
</div>
          
        
      
    
  

  

  

  

<!-- <li class="search additional-search">
  <form class="form-inline sidebar" action="/docs/search" autocomplete="on" method="get">
    <input class="input-search sidebar" type="text" id="search-box" name="query" placeholder="Search">
    <button type="submit sidebar" class="search-button"></button>
  </form>
</li> -->

</div>
  <!-- Search form -->
  <!-- <form class="search-container" action="/docs/search" autocomplete="on" method="get">
   <label for="search-box">Search</label>
    <input type="text" id="search-box" name="query">
    <button type="submit" class="searchbttn"></button>
  </form> -->
</div>

        </div>
      </div>
    </div>

    <div class="col-sm-9 docsmod">
      <div id="content-wrapper" class="docs-content docs-content--with-sidebar">
        <!--
          Include file to warn of Windows/Gradle restriction
        -->
        <h1 id="deploy-a-micronaut-microservices-application-to-oracle-cloud-infrastructure-container-engine-for-kubernetes">
        
        
          Deploy a Micronaut Microservices Application to Oracle Cloud Infrastructure Container Engine for Kubernetes
        
        
      </h1>

<p>This guide shows how to deploy a Micronaut microservices application to the <a href="https://docs.oracle.com/iaas/Content/ContEng/Concepts/contengoverview.htm">Oracle Cloud Infrastructure Container Engine for Kubernetes (OKE)</a> using the <a href="https://micronaut-projects.github.io/micronaut-kubernetes/snapshot/guide/">Micronaut Kubernetes module</a>.</p>

<p><a href="https://www.oracle.com/cloud/cloud-native/container-engine-kubernetes/">OKE</a> is a managed <a href="https://www.oracle.com/cloud/cloud-native/container-engine-kubernetes/what-is-kubernetes/">Kubernetes</a> service for deploying containerized applications to the cloud.</p>

<p>The guide shows how to use Kubernetes Service Discovery and Distributed Configuration to connect several microservices, and discover how Micronaut integration with Kubernetes simplifies deployment to OKE.</p>
    
      <h3 id="prerequisites">
        
        
          Prerequisites <a href="#prerequisites" class="anchor_heading">#</a>
        
        
      </h3>

<ul>
  <li>JDK 17 or higher. See <a href="/gcn/get-started/setting-up-desktop/">Setting up Your Desktop</a>.</li>
  <li>An Oracle Cloud Infrastructure account. See <a href="/gcn/get-started/setting-up-cloud-accounts/">Setting up Your Cloud Accounts</a>.</li>
  <li>The Oracle Cloud Infrastructure <a href="https://docs.cloud.oracle.com/iaas/Content/API/SDKDocs/cliinstall.htm">CLI</a> installed with <a href="https://docs.oracle.com/iaas/Content/API/SDKDocs/cliinstall.htm#configfile">local access configured</a>.</li>
  <li>A Docker-API compatible container runtime such as <a href="https://docs.rancherdesktop.io/getting-started/installation/">Rancher Desktop</a> or <a href="https://www.docker.io/gettingstarted/">Docker</a> installed to run MySQL and to run tests using <a href="https://www.testcontainers.org">Testcontainers</a>.</li>
  <li><a href="https://stedolan.github.io/jq/"><code>jq</code></a>: a lightweight and flexible command-line JSON processor.</li>
  <li><a href="https://kubernetes.io/docs/reference/kubectl/"><code>kubectl</code></a> to deploy the application to OKE.</li>
</ul>
    
      <h4 id="a-note-regarding-your-development-environment">
        
        
          A note regarding your development environment
        
        
      </h4>

<p>Consider using Visual Studio Code that provides native support for developing applications with the <a href="/gcn/vscode-tools/using-gcn-vscode-tools/">Graal Cloud Native Tools extension</a>.</p>

<blockquote>
  <p>Note: If you use IntelliJ IDEA, <a href="/gcn/resources/img/annotationprocessorsintellij.png">enable annotation processing</a>.</p>
</blockquote>

<blockquote>
  <p>Windows platform: The GCN guides are compatible with Gradle only. Maven support is coming soon.</p>
</blockquote>
    
      <h2 id="1-create-or-download-a-microservices-application">
        
        
          1. Create or Download a Microservices Application <a href="#1-create-or-download-a-microservices-application" class="anchor_heading">#</a>
        
        
      </h2>

<p>You can create a microservices application from scratch by following <a href="/gcn/gcn-modules/kubernetes/micronaut-k8s/">this guide</a>, or you can download the completed example in Java:</p>

<div id="tabs-doc1">
    <ul>
        <li class="tabs-gradle"><a name="gradle" href="#gradle">Gradle</a></li>
        <li class="tabs-maven"><a name="maven" href="#maven">Maven</a></li>
    </ul>
    <div id="gradle">
        <p><a href="/gcn/docs/gcn-modules/kubernetes/archives/oci-kubernetes-demo-java-gradle.zip">Gradle Micronaut OKE Example <img class="download-img-guides" src="/gcn/resources/img/gcn_modules/download-archive.png" alt="Download completed example" /></a>
        </p>
    </div>
    <div id="maven">
        <p><a href="/gcn/docs/gcn-modules/kubernetes/archives/oci-kubernetes-demo-java-maven.zip">Maven Micronaut OKE Example <img class="download-img-guides" src="/gcn/resources/img/gcn_modules/download-archive.png" alt="Download completed example" /></a>
        </p>
    </div>
</div>

<p>The application ZIP file will be downloaded in your default downloads directory. Unzip it, open in your code editor, and proceed to the next steps.</p>

<p>The application consists of three microservices:</p>

<ul>
  <li><em>users</em> - contains customer data that can place orders on items, also a new customer can be created. It requires HTTP basic authentication to access it.</li>
  <li><em>orders</em> - contains all orders that customers have created as well as available items that customers can order. This microservice also enables the creation of new orders. It requires HTTP basic authentication to access it.</li>
  <li><em>api</em> - acts as a gateway to the <em>orders</em> and <em>users</em> microservices. It combines results from both microservices and checks data when a customer creates a new order.</li>
</ul>

<blockquote>
  <p>Note: By default, a Micronaut application detects its runtime environment. 
A detected environment (in this case, <strong>k8s</strong>) overrides the default specified environment (in this case, <strong>oraclecloud</strong>). 
This means that you should locate your configuration in the <em>application-k8s.properties</em> and <em>bootstrap-k8s.properties</em> files.
Alternatively, you can specify the <code>oraclecloud</code> environment passing it as a command-line option (<code>-Dmicronaut.environments=oraclecloud</code>) or via an environment variable (<code>MICRONAUT_ENVIRONMENTS=oraclecloud</code>).</p>
</blockquote>
    
      <h2 id="2-create-an-oracle-cloud-infrastructure-kubernetes-cluster">
        
        
          2. Create an Oracle Cloud Infrastructure Kubernetes Cluster <a href="#2-create-an-oracle-cloud-infrastructure-kubernetes-cluster" class="anchor_heading">#</a>
        
        
      </h2>

<p>You will use <strong>Quick Create</strong> cluster option in OKE to create Kubernetes cluster.</p>

<p>Create a Kubernetes cluster with default settings using the <strong>Quick Create</strong> workflow:</p>
<ol>
  <li>Login to the Oracle Cloud console, and browse <a href="https://cloud.oracle.com/containers/clusters/quick">Quick Kubernetes Clusters (OKE)</a>.</li>
  <li>Choose your compartment in the <strong>Compartment</strong> dropdown.</li>
  <li>Under <strong>Containers</strong>, click <strong>Kubernetes Clusters (OKE)</strong>.</li>
  <li>Then click <strong>Create Cluster</strong> and choose the <strong>Quick Create</strong> option.</li>
  <li>Enter the name for your cluster, for example, <em>gcn-k8s</em>. Select <strong>Public Endpoint</strong> for the Kubernetes API endpoint; <strong>Private Workers</strong> for worker nodes; and the shape (choose the default). Then confirm cluster creation by clicking <strong>Next</strong>.</li>
  <li>It may take a few minutes to create all the resources. When they are all complete, click <strong>Close</strong>.</li>
  <li>From the Cluster Details screen click <strong>Copy</strong> to copy the Cluster Id (you will need it later).</li>
</ol>
    
      <h2 id="3-prepare-to-deploy-microservices">
        
        
          3. Prepare to Deploy Microservices <a href="#3-prepare-to-deploy-microservices" class="anchor_heading">#</a>
        
        
      </h2>
    
      <h3 id="31-export-environment-variables">
        
        
          3.1. Export Environment Variables <a href="#31-export-environment-variables" class="anchor_heading">#</a>
        
        
      </h3>

<p>Define some environment variables to make deploying process easier:</p>
<ul>
  <li><code>OCI_USER_ID</code> to store your user OCID, which you can find in your Oracle Cloud Infrastructure configuration file.</li>
  <li><code>OCI_TENANCY_NAMESPACE</code> to store the tenancy namespace (retrieve your tenancy namespace using the Oracle Cloud Infrastructure CLI).</li>
  <li><code>OCIR_USERNAME</code> store your username in the format <code>&lt;tenancy_namespace&gt;/&lt;username&gt;</code>. You can reuse <code>OCI_TENANCY_NAMESPACE</code> and only edit the <code>&lt;username&gt;</code> part.</li>
  <li><code>OCI_REGION</code> to store your cloud region code, for example, “us-phoenix-1”.</li>
  <li><code>OCI_CLUSTER_ID</code> to store the Cluster Id that you copied earlier.</li>
  <li><code>OCI_COMPARTMENT_ID</code> to store your compartment id.</li>
</ul>

<p>For example:</p>

<pre><code class="language-bash">export OCI_USER_ID="ocid1.user.oc1..aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"
export OCI_TENANCY_NAMESPACE=$(oci os ns get | jq .data -r)
export OCIR_USERNAME="$OCI_TENANCY_NAMESPACE/&lt;username&gt;"
export OCI_REGION="&lt;region-key&gt;"
export OCI_CLUSTER_ID="ocid1.cluster.oc1.iad.aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"
export OCI_COMPARTMENT_ID="ocid1.compartment.oc1..aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"
</code></pre>

<details>
    <summary>The <code>export</code> command syntax varies per platform. Expand to learn more.</summary>
    <p>If you use Linux/macOS, the <code>export</code> command is:</p>
        <pre><code class="language-bash">export OCI_USER_ID=&lt;id&gt;</code></pre>
    <p>If you use Windows, change <code>export</code> to <code>set</code> if using the <code>cmd</code> prompt:</p>
    <pre><code class="language-bash">set OCI_USER_ID=&lt;id&gt;</code></pre>
    <p>If you use PowerShell, change <code>export</code> to <code>$</code> and use quotes around the value, for example:</p>
    <pre><code class="language-bash">$OCI_USER_ID="&lt;id&gt;"</code></pre>
    <p>To dereference a value in Linux/macOS or Powershell, use <code>$</code>, for example:
    <code>/some/command -option=$OCI_USER_ID</code></p>
    <p>If you use <code>cmd</code>, use <code>%</code> before and after the name, for example: <code>/some/command -option=%OCI_USER_ID%</code></p>
</details>
    
      <h3 id="32-authenticate-to-oracle-cloud-infrastructure-registry">
        
        
          3.2. Authenticate to Oracle Cloud Infrastructure Registry <a href="#32-authenticate-to-oracle-cloud-infrastructure-registry" class="anchor_heading">#</a>
        
        
      </h3>

<ol>
  <li>
    <p><a href="https://docs.oracle.com/iaas/Content/Registry/Tasks/registrygettingauthtoken.htm">Create an <code>AUTH_TOKEN</code></a> to authenticate to Oracle Cloud Infrastructure Registry (also known as Container Registry). (Oracle Cloud Infrastructure allows you to have only two authentication tokens at the same time. If you already have two, use the existing one or delete the one that you are not using.)</p>
  </li>
  <li>Export the <code>AUTH_TOKEN</code> variable:
    <pre><code class="language-bash"> export AUTH_TOKEN=$(oci iam auth-token create --user-id $OCI_USER_ID --description k8s-gcn | jq -r '.data.token')
</code></pre>
  </li>
  <li>Run the next command to log in to <code>ocir.io</code> (Container Registry):
    <pre><code class="language-bash"> docker login $OCI_REGION.ocir.io -u $OCIR_USERNAME -p $AUTH_TOKEN
</code></pre>
  </li>
</ol>
    
      <h3 id="33-build-a-container-image-of-the-native-users-microservice">
        
        
          3.3. Build a Container Image of the Native <em>Users</em> Microservice <a href="#33-build-a-container-image-of-the-native-users-microservice" class="anchor_heading">#</a>
        
        
      </h3>

<p>To build a container image of the native <em>users</em> microservice named “users”, run the following command from the <em>users/</em> directory:</p>

<div id="tabs-doc11">
    <ul>
        <li class="tabs-gradle"><a href="#gradle">Gradle</a></li>
        <li class="tabs-maven"><a href="#maven">Maven</a></li>
    </ul>
    <div id="gradle">
        <pre><code class="language-bash">./gradlew dockerBuildNative</code></pre>
    </div>
    <div id="maven">
        <pre><code class="language-bash">./mvnw package -Dpackaging=docker-native -Pgraalvm</code></pre>
    </div>
</div>

<blockquote>
  <p>Note: If you encounter problems building a container image, try the following:</p>
  <ul>
    <li>Gradle: from the <em>users/build/docker/native-main/</em> directory, run <code>docker build . -t users-oci -f DockerfileNative</code>.</li>
    <li>Maven: from the <em>users/target/</em> directory, run <code>docker build . -t users-oci -f Dockerfile</code>.</li>
  </ul>
</blockquote>

<blockquote>
  <p>Note: Ensure that you construct container images for the correct CPU architecture. For instance, if you are using AArch64, modify the <code>DOCKER_DEFAULT_PLATFORM</code> environment variable to the value <code>linux/amd64</code>. Alternatively, you have the option to use AArch64 instances within your Kubernetes cluster.</p>
</blockquote>
    
      <h3 id="34-update-the-users-microservice">
        
        
          3.4. Update the <em>Users</em> Microservice <a href="#34-update-the-users-microservice" class="anchor_heading">#</a>
        
        
      </h3>

<p>Edit the file named <em>users/k8s.yml</em> as follows:</p>

<pre><code class="language-yml">apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: gcn-k8s
  name: "users"
spec:
  selector:
    matchLabels:
      app: "users"
  template:
    metadata:
      labels:
        app: "users"
    spec:
      serviceAccountName: gcn-service
      containers:
        - name: "users"
          image: &lt;region-key&gt;.ocir.io/&lt;tenancy-namespace&gt;/gcn-k8s/users-oci:latest # &lt;1&gt;
          imagePullPolicy: Always # &lt;2&gt;
          ports:
            - name: http
              containerPort: 8080
          readinessProbe:
            httpGet:
              path: /health/readiness
              port: 8080
            initialDelaySeconds: 5
            timeoutSeconds: 3
          livenessProbe:
            httpGet:
              path: /health/liveness
              port: 8080
            initialDelaySeconds: 5
            timeoutSeconds: 3
            failureThreshold: 10
      imagePullSecrets:
        - name: ocirsecret # &lt;3&gt;
---
apiVersion: v1
kind: Service
metadata:
  namespace: gcn-k8s
  name: "users"
spec:
  selector:
    app: "users"
  type: NodePort
  ports:
    - protocol: "TCP"
      port: 8080
</code></pre>

<p><strong>1</strong> The container image name that exists in Container Registry. Change the <code>&lt;region-key&gt;</code> to your region and change the <code>&lt;tenancy-name&gt;</code> to your tenancy name.</p>

<p><strong>2</strong> Change <code>imagePullPolicy</code> to <code>Always</code>.</p>

<p><strong>3</strong> A secret needed to pull container images from Container Registry.</p>
    
      <h3 id="35-create-a-container-repository-for-the-users-microservice">
        
        
          3.5. Create a Container Repository for the <em>Users</em> Microservice <a href="#35-create-a-container-repository-for-the-users-microservice" class="anchor_heading">#</a>
        
        
      </h3>

<p>Your next step is to prepare a container repository in <a href="https://docs.oracle.com/iaas/Content/Registry/home.htm">Container Registry</a>.</p>

<ol>
  <li>
    <p>Create a Container Repository in your compartment:</p>

    <pre><code class="language-bash"> export USERS_REPOSITORY=$(oci artifacts container repository create --display-name gcn-k8s/users-oci --compartment-id $OCI_COMPARTMENT_ID | jq .data.id -r)
</code></pre>
  </li>
  <li>
    <p>Tag an existing <em>users</em> microservice container image:</p>

    <pre><code class="language-bash"> docker tag users-oci:latest $OCI_REGION.ocir.io/$OCI_TENANCY_NAMESPACE/gcn-k8s/users-oci:latest
</code></pre>
  </li>
  <li>
    <p>Push the tagged <em>users</em> microservice container image to the remote repository:</p>

    <pre><code class="language-bash"> docker push $OCI_REGION.ocir.io/$OCI_TENANCY_NAMESPACE/gcn-k8s/users-oci:latest
</code></pre>
  </li>
</ol>
    
      <h3 id="36-build-a-container-image-of-the-native-orders-microservice">
        
        
          3.6. Build a Container Image of the Native <em>Orders</em> Microservice <a href="#36-build-a-container-image-of-the-native-orders-microservice" class="anchor_heading">#</a>
        
        
      </h3>

<p>To build a container image of the native <em>orders</em> microservice named “orders”, run the following command from the <em>orders/</em> directory:</p>

<div id="tabs-doc12">
    <ul>
        <li class="tabs-gradle"><a href="#gradle">Gradle</a></li>
        <li class="tabs-maven"><a href="#maven">Maven</a></li>
    </ul>
    <div id="gradle">
        <pre><code class="language-bash">./gradlew dockerBuildNative</code></pre>
    </div>
    <div id="maven">
        <pre><code class="language-bash">./mvnw package -Dpackaging=docker-native -Pgraalvm</code></pre>
    </div>
</div>

<blockquote>
  <p>Note: If you encounter problems building a container image, try the following:</p>
  <ul>
    <li>Gradle: from the <em>orders/build/docker/native-main/</em> directory, run <code>docker build . -t orders-oci -f DockerfileNative</code>.</li>
    <li>Maven: from the <em>orders/target/</em> directory, run <code>docker build . -t orders-oci -f Dockerfile</code>.</li>
  </ul>
</blockquote>

<blockquote>
  <p>Note: Ensure that you construct container images for the correct CPU architecture. For instance, if you are using AArch64, modify the <code>DOCKER_DEFAULT_PLATFORM</code> environment variable to the value <code>linux/amd64</code>. Alternatively, you have the option to use AArch64 instances within your Kubernetes cluster.</p>
</blockquote>
    
      <h3 id="37-update-the-orders-microservice">
        
        
          3.7. Update the <em>Orders</em> Microservice <a href="#37-update-the-orders-microservice" class="anchor_heading">#</a>
        
        
      </h3>

<p>Edit the file named <em>orders/k8s.yml</em> as follows:</p>

<pre><code class="language-yml">apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: gcn-k8s
  name: "orders"
spec:
  selector:
    matchLabels:
      app: "orders"
  template:
    metadata:
      labels:
        app: "orders"
    spec:
      serviceAccountName: gcn-service
      containers:
        - name: "orders"
          image: &lt;region-key&gt;.ocir.io/&lt;tenancy-namespace&gt;/gcn-k8s/orders-oci:latest # &lt;1&gt;
          imagePullPolicy: Always # &lt;2&gt;
          ports:
            - name: http
              containerPort: 8080
          readinessProbe:
            httpGet:
              path: /health/readiness
              port: 8080
            initialDelaySeconds: 5
            timeoutSeconds: 3
          livenessProbe:
            httpGet:
              path: /health/liveness
              port: 8080
            initialDelaySeconds: 5
            timeoutSeconds: 3
            failureThreshold: 10
      imagePullSecrets:
        - name: ocirsecret # &lt;3&gt;
---
apiVersion: v1
kind: Service
metadata:
  namespace: gcn-k8s
  name: "orders"
spec:
  selector:
    app: "orders"
  type: NodePort
  ports:
    - protocol: "TCP"
      port: 8080
</code></pre>

<p><strong>1</strong> The container image name that exists in Container Registry. Change the <code>&lt;region-key&gt;</code> to your region and change the <code>&lt;tenancy-name&gt;</code> to your tenancy name.</p>

<p><strong>2</strong> Change <code>imagePullPolicy</code> to <code>Always</code>.</p>

<p><strong>3</strong> A secret needed to pull container images from Container Registry.</p>
    
      <h3 id="38-create-a-container-repository-for-the-orders-microservice">
        
        
          3.8. Create a Container Repository for the <em>Orders</em> Microservice <a href="#38-create-a-container-repository-for-the-orders-microservice" class="anchor_heading">#</a>
        
        
      </h3>

<ol>
  <li>
    <p>Create a container repository in your compartment.</p>

    <pre><code class="language-bash"> export ORDERS_REPOSITORY=$(oci artifacts container repository create --display-name gcn-k8s/orders-oci --compartment-id $OCI_COMPARTMENT_ID | jq .data.id -r)
</code></pre>
  </li>
  <li>
    <p>Tag an existing <em>orders</em> microservice container image:</p>

    <pre><code class="language-bash"> docker tag orders-oci:latest $OCI_REGION.ocir.io/$OCI_TENANCY_NAMESPACE/gcn-k8s/orders-oci:latest
</code></pre>
  </li>
  <li>
    <p>Push the tagged <em>orders</em> microservice container image to the remote repository:</p>

    <pre><code class="language-bash"> docker push $OCI_REGION.ocir.io/$OCI_TENANCY_NAMESPACE/gcn-k8s/orders-oci:latest
</code></pre>
  </li>
</ol>
    
      <h3 id="39-build-a-container-image-of-the-native-api-gateway-microservice">
        
        
          3.9. Build a Container Image of the Native <em>API</em> (Gateway) Microservice <a href="#39-build-a-container-image-of-the-native-api-gateway-microservice" class="anchor_heading">#</a>
        
        
      </h3>

<p>To build a container image of the native <em>api</em> microservice named “api”, run the following command from the <em>api/</em> directory:</p>

<div id="tabs-doc13">
    <ul>
        <li class="tabs-gradle"><a href="#gradle">Gradle</a></li>
        <li class="tabs-maven"><a href="#maven">Maven</a></li>
    </ul>
    <div id="gradle">
        <pre><code class="language-bash">./gradlew dockerBuildNative</code></pre>
    </div>
    <div id="maven">
        <pre><code class="language-bash">./mvnw package -Dpackaging=docker-native -Pgraalvm</code></pre>
    </div>
</div>

<blockquote>
  <p>Note: If you encounter problems building a container image, try the following:</p>
  <ul>
    <li>Gradle: from the <em>api/build/docker/native-main/</em> directory, run <code>docker build . -t api-oci -f DockerfileNative</code>.</li>
    <li>Maven: from the <em>api/target/</em> directory, run <code>docker build . -t api-oci -f Dockerfile</code>.</li>
  </ul>
</blockquote>

<blockquote>
  <p>Note: Ensure that you construct container images for the correct CPU architecture. For instance, if you are using AArch64, modify the <code>DOCKER_DEFAULT_PLATFORM</code> environment variable to the value <code>linux/amd64</code>. Alternatively, you have the option to use AArch64 instances within your Kubernetes cluster.</p>
</blockquote>
    
      <h3 id="310-update-the-api-microservice">
        
        
          3.10. Update the <em>API</em> Microservice <a href="#310-update-the-api-microservice" class="anchor_heading">#</a>
        
        
      </h3>

<p>Edit the file named <em>api/k8s.yml</em> as follows:</p>

<pre><code class="language-yml">apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: gcn-k8s
  name: "api"
spec:
  selector:
    matchLabels:
      app: "api"
  template:
    metadata:
      labels:
        app: "api"
    spec:
      serviceAccountName: gcn-service
      containers:
        - name: "api"
          image: &lt;region-key&gt;.ocir.io/&lt;tenancy-namespace&gt;/gcn-k8s/api-oci:latest # &lt;1&gt;
          imagePullPolicy: Always # &lt;2&gt;
          ports:
            - name: http
              containerPort: 8080
          readinessProbe:
            httpGet:
              path: /health/readiness
              port: 8080
            initialDelaySeconds: 5
            timeoutSeconds: 3
          livenessProbe:
            httpGet:
              path: /health/liveness
              port: 8080
            initialDelaySeconds: 5
            timeoutSeconds: 3
            failureThreshold: 10
      imagePullSecrets:
        - name: ocirsecret # &lt;3&gt;
---
apiVersion: v1
kind: Service
metadata:
  namespace: gcn-k8s
  name: "api"
  annotations: # &lt;4&gt;
    oci.oraclecloud.com/load-balancer-type: "lb"
    service.beta.kubernetes.io/oci-load-balancer-shape: "flexible"
    service.beta.kubernetes.io/oci-load-balancer-shape-flex-min: "10"
    service.beta.kubernetes.io/oci-load-balancer-shape-flex-max: "10"
spec:
  selector:
    app: "api"
  type: LoadBalancer
  ports:
    - protocol: "TCP"
      port: 8080
</code></pre>

<p><strong>1</strong> The container image name that exists in Container Registry. Change the <code>&lt;region-key&gt;</code> to your region and change the <code>&lt;tenancy-name&gt;</code> to your tenancy name.</p>

<p><strong>2</strong> Change <code>imagePullPolicy</code> to <code>Always</code>.</p>

<p><strong>3</strong> A secret needed to pull container images from Container Registry.</p>

<p><strong>4</strong> Metadata annotations for an <a href="https://docs.oracle.com/iaas/Content/ContEng/Tasks/contengcreatingloadbalancer.htm">Oracle Cloud Infrastructure Load Balancer</a>.</p>
    
      <h3 id="311-create-a-container-repository-for-the-api-microservice">
        
        
          3.11. Create a Container Repository for the <em>API</em> Microservice <a href="#311-create-a-container-repository-for-the-api-microservice" class="anchor_heading">#</a>
        
        
      </h3>

<ol>
  <li>
    <p>Create a container repository in your compartment:</p>

    <pre><code class="language-bash"> export API_REPOSITORY=$(oci artifacts container repository create --display-name gcn-k8s/api-oci --compartment-id $OCI_COMPARTMENT_ID | jq .data.id -r)
</code></pre>
  </li>
  <li>
    <p>Tag an existing <em>api</em> microservice container image:</p>

    <pre><code class="language-bash"> docker tag api-oci:latest $OCI_REGION.ocir.io/$OCI_TENANCY_NAMESPACE/gcn-k8s/api-oci:latest
</code></pre>
  </li>
  <li>
    <p>Push the tagged <em>api</em> microservice container image to the remote repository:</p>

    <pre><code class="language-bash"> docker push $OCI_REGION.ocir.io/$OCI_TENANCY_NAMESPACE/gcn-k8s/api-oci:latest
</code></pre>
  </li>
</ol>
    
      <h2 id="4-deploy-microservices-to-oke">
        
        
          4. Deploy Microservices to OKE <a href="#4-deploy-microservices-to-oke" class="anchor_heading">#</a>
        
        
      </h2>

<ol>
  <li>
    <p>Create a directory for a <code>kubectl</code> configuration:</p>

    <pre><code class="language-bash"> mkdir -p $HOME/.kube
</code></pre>
  </li>
  <li>
    <p>Generate a <code>kubectl</code> configuration for authentication to OKE:</p>

    <pre><code class="language-bash"> oci ce cluster create-kubeconfig --cluster-id $OCI_CLUSTER_ID --file $HOME/.kube/config --region $OCI_REGION --token-version 2.0.0  --kube-endpoint PUBLIC_ENDPOINT
</code></pre>
  </li>
  <li>
    <p>Set <code>KUBECONFIG</code> to the created config file, as shown below. (This variable is consumed by <code>kubectl</code>.)</p>

    <pre><code class="language-bash"> export KUBECONFIG=$HOME/.kube/config
</code></pre>

    <blockquote>
      <p>Note: On Windows, <code>kubectl</code> is typically installed within the Kubernetes extension and is not added to the system path. Windows users should configure a proxy in <em>.kube/config</em> to successfully deploy a project to Oracle Cloud Infrastructure: add a <code>proxy-url</code> property under <code>cluster</code>.</p>
      <pre><code class="language-yml"> clusters:
 - name: "dev"
   cluster:
     proxy-url: http://user:password@proxy:port
     ...
</code></pre>
    </blockquote>
  </li>
  <li>
    <p>Deploy the <em>auth.yml</em> file that you created in the <a href="/gcn/gcn-modules/kubernetes/micronaut-k8s/">Deploy a Micronaut Microservices Application to a Local Kubernetes Cluster</a> guide:</p>

    <pre><code class="language-bash"> kubectl apply -f auth.yml
</code></pre>
  </li>
  <li>
    <p>Create an <code>ocirsecret</code> secret that will be used for authentication to Container Registry. The secret is a object to store user credential data (encrypted data), for example, the database username and password. In this case, OKE uses it to authenticate to Container Registry to be able to pull microservices container images.</p>

    <pre><code class="language-bash"> kubectl create secret docker-registry ocirsecret \
       --docker-server=$OCI_REGION.ocir.io \
       --docker-username=$OCIR_USERNAME \
       --docker-password=$AUTH_TOKEN \
       --namespace=gcn-k8s
</code></pre>
  </li>
  <li>
    <p>Deploy the <em>users</em> microservice:</p>

    <pre><code class="language-bash"> kubectl apply -f users/k8s.yml
</code></pre>
  </li>
  <li>
    <p>Deploy the <em>orders</em> microservice:</p>

    <pre><code class="language-bash"> kubectl apply -f orders/k8s.yml
</code></pre>
  </li>
  <li>
    <p>Run the next command to deploy the <em>api</em> microservice:</p>

    <pre><code class="language-bash"> kubectl apply -f api/k8s.yml
</code></pre>
  </li>
</ol>
    
      <h2 id="5-test-integration-between-the-microservices-deployed-to-oke">
        
        
          5. Test Integration Between the Microservices Deployed to OKE <a href="#5-test-integration-between-the-microservices-deployed-to-oke" class="anchor_heading">#</a>
        
        
      </h2>

<ol>
  <li>Run the following command to check the status of the pods and make sure that all of them have the status “Running”:
    <pre><code class="language-bash"> kubectl get pods -n=gcn-k8s
</code></pre>

    <pre>
 NAME                      READY   STATUS    RESTARTS   AGE
 api-6fb4cd949f-kxxx8      1/1     Running   0          2d1h
 orders-595887ddd6-6lzp4   1/1     Running   0          2d1h
 users-df6f78cd7-lgnzx     1/1     Running   0          2d1h
 </pre>
  </li>
  <li>
    <p>Run this command to check the status of the microservices:</p>

    <pre><code class="language-bash"> kubectl get services -n=gcn-k8s
</code></pre>

    <pre>
 NAME         TYPE           CLUSTER-IP     EXTERNAL-IP      PORT(S)             AGE
 api          LoadBalancer   10.96.70.48    129.159.92.209   8080:31690/TCP      2d1h
 orders       NodePort       10.96.94.130   &lt;none&gt;           8080:31245/TCP      2d1h
 users        NodePort       10.96.34.174   &lt;none&gt;           8080:30790/TCP      2d1h
 </pre>

    <p>If <code>EXTERNAL-IP</code> is in a <code>&lt;pending&gt;</code> state, wait a couple of seconds and then run the command again.</p>
  </li>
  <li>
    <p>Retrieve the URL of the <em>api</em> microservice and set it as the value of the $API_URL environment variable:</p>

    <pre><code class="language-bash"> export API_URL=http://$(kubectl get svc api -n=gcn-k8s -o json | jq -r .status.loadBalancer.ingress[0].ip):8080
</code></pre>
  </li>
  <li>
    <p>Run a <code>curl</code> command to create a new user via the <em>api</em> microservice:</p>

    <pre><code class="language-bash"> curl -X "POST" "$API_URL/api/users" \
      -H 'Content-Type: application/json; charset=utf-8' \
      -d '{ "first_name": "Nemanja", "last_name": "Mikic", "username": "nmikic" }'
</code></pre>

    <p>Your output should look like:</p>

    <pre><code class="language-json"> {
   "id":1,
   "username":"nmikic",
   "first_name":"Nemanja",
   "last_name":"Mikic"
 }
</code></pre>
  </li>
  <li>
    <p>Run a <code>curl</code> command to create a new order via the <em>api</em> microservice:</p>

    <pre><code class="language-bash"> curl -X "POST" "$API_URL/api/orders" \
      -H 'Content-Type: application/json; charset=utf-8' \
      -d '{ "user_id": 1, "item_ids": [1,2] }'
</code></pre>

    <p>Your output should include details of the order, as follows:</p>

    <pre><code class="language-json"> {
   "id": 1,
   "user": {
     "first_name": "Nemanja",
     "last_name": "Mikic",
     "id": 1,
     "username": "nmikic"
   },
   "items": [
     {
       "id": 1,
       "name": "Banana",
       "price": 1.5
     },
     {
       "id": 2,
       "name": "Kiwi",
       "price": 2.5
     }
   ],
   "total": 4.0
 }
</code></pre>
  </li>
  <li>
    <p>Run a <code>curl</code> command to list the orders:</p>

    <pre><code class="language-bash"> curl "$API_URL/api/orders" \
      -H 'Content-Type: application/json; charset=utf-8'
</code></pre>

    <p>You should see output that is similar to the following:</p>

    <pre><code class="language-json"> [
   {
     "id": 1,
     "user": {
       "first_name": "Nemanja",
       "last_name": "Mikic",
       "id": 1,
       "username": "nmikic"
     },
     "items": [
       {
         "id": 1,
         "name": "Banana",
         "price": 1.5
       },
       {
         "id": 2,
         "name": "Kiwi",
         "price": 2.5
       }
     ],
     "total": 4.0
   }
 ]
</code></pre>
  </li>
  <li>
    <p>Try to place an order for a user who does not exist (with <code>id</code> 100). Run a <code>curl</code> command:</p>

    <pre><code class="language-bash"> curl -X "POST" "$API_URL/api/orders" \
      -H 'Content-Type: application/json; charset=utf-8' \
      -d '{ "user_id": 100, "item_ids": [1,2] }'
</code></pre>

    <p>You should see the following error message:</p>

    <pre><code class="language-json"> {
   "message": "Bad Request",
   "_links": {
     "self": [
       {
         "href": "/api/orders",
         "templated": false
       }
     ]
   },
   "_embedded": {
     "errors": [
       {
         "message": "User with id 100 doesn't exist"
       }
     ]
   }
 }
</code></pre>
  </li>
</ol>
    
      <h2 id="6-delete-kubernetes-resources">
        
        
          6. Delete Kubernetes Resources <a href="#6-delete-kubernetes-resources" class="anchor_heading">#</a>
        
        
      </h2>

<p>To delete all Kubernetes resources that were created in this guide, run this command:</p>

<pre><code class="language-bash">kubectl delete namespaces gcn-k8s
</code></pre>

<p>Delete the OKE cluster.</p>

<pre><code class="language-bash">oci ce cluster delete --cluster-id $OCI_CLUSTER_ID --force
</code></pre>

<p>Delete the <code>gcn-k8s/users-oci</code> artifacts container repository:</p>

<pre><code class="language-bash">oci artifacts container repository delete --repository-id $USERS_REPOSITORY --force
</code></pre>

<p>Delete the <code>gcn-k8s/order-oci</code> artifacts container repository:</p>

<pre><code class="language-bash">oci artifacts container repository delete --repository-id $ORDERS_REPOSITORY --force
</code></pre>

<p>Delete the <code>gcn-k8s/api-oci</code> artifacts container repository:</p>

<pre><code class="language-bash">oci artifacts container repository delete --repository-id $API_REPOSITORY --force
</code></pre>
    
      <h3 id="summary">
        
        
          Summary <a href="#summary" class="anchor_heading">#</a>
        
        
      </h3>

<p>This guide demonstrated how to use Kubernetes Service Discovery and Distributed Configuration, provided with the Micronaut Kubernetes integration, to connect three microservices, and to deploy these microservices to a Kubernetes cluster in Oracle Cloud Infrastructure Container Engine for Kubernetes.</p>
    
      <h3 id="related-documentation">
        
        
          Related Documentation <a href="#related-documentation" class="anchor_heading">#</a>
        
        
      </h3>

<ul>
  <li><a href="https://micronaut-projects.github.io/micronaut-kubernetes/snapshot/guide/">Micronaut Kubernetes module</a></li>
  <li><a href="https://docs.oracle.com/iaas/Content/ContEng/Concepts/contengoverview.htm">Oracle Cloud Infrastructure Container Engine for Kubernetes (OKE)</a></li>
</ul>

      </div>

      <div role="button" class="menu-btn menu-btn--sidebar js-show-sidebar" title="sweet hamburger">
        <div class="hamburger">
          <div class="inner"></div>
        </div>
      </div>
    </div>
  </div>
</article>



</div>

      </main>

      
<footer class="footer footer__mobile">

  <div class="container-fluid container-fluid--custom-sm">
    <div class="row">
      <div class="col-12 col-sm-12 col-md-12 col-lg-12">
        <div class="row footer-content">
          <div class="col-md-3 col-sm-4">
            <h6 class="title-footer" onclick="fadeInAndOut(this)">Learn</h6>
            <div class="grow">
              <ul class="footer-list">
                <li class="footer-list__item"><a href="/gcn/get-started/">Get Started</a></li>
                <li class="footer-list__item"><a href="/gcn/guides/">Guides</a></li>
                <li class="footer-list__item"><a href="/gcn/hands-on-labs/">Labs</a></li>
                <li class="footer-list__github">
                  <img class="footer__icon" src="/gcn/resources/img/footer/logo-github.svg" alt="Github icon">
                  <a href="https://github.com/oracle/gcn" target="blank">Github</a>
                </li>
                <li class="footer-list__github">
                  <img class="footer__icon" src="/gcn/resources/img/footer/slack-icon.svg" alt="Github icon">
                  <a href="https://bit.ly/odevrel_slack" target="blank">Join us at: #graal-cloud-native</a>
                </li>
              </ul>
            </div>
          </div>
          <div class="col-md-3 col-sm-4">
            <h6 class="title-footer" onclick="fadeInAndOut(this)">About</h6>
            <div class="grow">
              <ul class="footer-list">
                <li class="footer-list__item"><a href="/gcn/about/#support" target="blank">Commercial Support</a></li>
                <li class="footer-list__item"><a href="https://www.graalvm.org/" target="blank">GraalVM Native Image</a></li>
                <li class="footer-list__item"><a href="https://micronaut.io/" target="_blank">Micronaut</a></li>
                <li class="footer-list__item"><a href="https://www.oracle.com/cloud/multicloud/what-is-multicloud/" target="_blank">Multicloud</a></li>
                <li class="footer-list__item"><a href="https://www.oracle.com/cloud/" target="blank">Oracle Cloud Infrastructure</a></li>
                <li class="footer-list__item"><a href="https://marketplace.visualstudio.com/items?itemName=oracle-labs-graalvm.graal-cloud-native-pack" target="blank">VS Code Tools</a></li>
              </ul>
            </div>
          </div>
          <div class="col-md-6 col-sm-12 aligning_1024">
            <div class="card--footer card--hovered box">
              <div>
                <div class="rubber-footer footer__oci-section">
                  <p class="title-footer quickstart">Build, test, and deploy applications on Oracle Cloud Infrastructure for free</p>
                  <a href="https://www.oracle.com/cloud/free/" target="_blank"
                    class="btn btn-primary">Try Oracle Cloud Infrastructure Free Tier</a>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="col-12 col-sm-12 col-md-12 col-lg-12">
          <div class="row">
            <div class="col-sm-12">
              <p class="copyright">
                Copyright © 2023, Oracle and/or its affiliates. All rights reserved. Oracle and Java are
                registered trademarks. Other names may be trademarks of their respective owners.
              </p>
              <div id="teconsent"></div>
            </div>
          </div>

        </div>
      </div>

    </div>
  </div>
</footer>

<script>
  function fadeInAndOut(thz) {
    var elmt = thz.nextElementSibling;//Get the element that is below the button that
    //was just clicked
    if (elmt.clientHeight) {
      elmt.style.height = 0;
    } else {
      var wrapper = elmt.querySelector('ul');
      elmt.style.height = wrapper.clientHeight + "px";
    }
    /*
        elmt.classList.toggle("acordianPanelHidden");//Toggle the class which changes
        //attributes which triggers the transition CSS
        */
  }

  // Check TRUSTe Consent for Functional or Implied Approval
  // The if test verifies if the user has given the consent
  if ( (oracle.truste.api.getGdprConsentDecision().consentDecision) &&
      (oracle.truste.api.getGdprConsentDecision().consentDecision.indexOf(0) != -1 ||
        oracle.truste.api.getGdprConsentDecision().consentDecision.indexOf(2) != -1) ) {

      //The following is a sample of a Maxymiser Tag being written to the DOM
      //If the user did not give consent, then the tag is not included and not invoked in the Browser
      document.write('<script type="text/javascript" src="//service.maxymiser.net/cdn/oracle/js/mmcore.js"><\/script>');
  }

  // Check TRUSTe Consent for Advertising or Implied Approval
  // The if test verifies if the user has given the consent
  if ( (oracle.truste.api.getGdprConsentDecision().consentDecision) &&
      (oracle.truste.api.getGdprConsentDecision().consentDecision.indexOf(0) != -1 ||
        oracle.truste.api.getGdprConsentDecision().consentDecision.indexOf(3) != -1) ) {

      //The following is a sample of a BlueKai Core Tag being written to the DOM
      //If the user did not give consent, then the tag is not included and not invoked in the Browser
      document.write('<script type="text/javascript">' +
      'window.bk_async = function() { ' +
      'BKTAG.doTag(62581, 1); }; ' +
      '(function() { ' +
      'var scripts = document.getElementsByTagName(\'script\')[0]; ' +
      'var s = document.createElement(\'script\'); ' +
      's.async = true; ' +
      's.src = "https://tags.bkrtx.com/js/bk-coretag.js"; ' +
      'scripts.parentNode.insertBefore(s, scripts); ' +
      '}()); ' +
      '<\/script>');
  }
</script>

    </div>
    <div class="overlay"></div>

    <!-- Start SiteCatalyst code -->
    <script language="JavaScript" src="https://www.oracle.com/us/assets/metrics/ora_otn.js"></script>
    <!-- End SiteCatalyst code -->

    <script src='/gcn/resources/lib/slick-slider/slick.min.js'></script>
    <script src='/gcn/resources/js/main.js'></script>
    <script src='/gcn/resources/js/ui.js'></script>
    <script src='/gcn/resources/js/filters.js'></script>
    <script src='/gcn/resources/js/sidebar.js'></script>
    <script src='/gcn/resources/lib/highlight/highlight.min.js'></script> 
    <script>hljs.highlightAll();</script>
  </body>
</html>

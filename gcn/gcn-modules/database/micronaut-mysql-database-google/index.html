<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta property="og:image" content="/gcn/resources/img/graalvm.png" />
  <meta name="twitter:widgets:border-color" content="#55acee">

  <title>
    
      Create and Connect a Micronaut Application to a Google MySQL Database
    
  </title>
  <meta name="description" content="Graal Cloud Native (GCN) is a build of a curated set of Micronaut framework modules and their required libraries for building portable cloud-native microserv..."/>
  <meta name="last_modified" content="2024-01-31 16:07:30 +0000"/>
  <meta name="last_built" content="2024-03-15 16:45:18 +0000"/>
  <link rel="stylesheet" href="/gcn/assets/main.css">
  <link rel="apple-touch-icon" sizes="180x180" href="/gcn/resources/img/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/gcn/resources/img/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/gcn/resources/img/favicon/favicon-16x16.png">
  <link rel="manifest" href="/resources/img/favicon/site.webmanifest">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
  <meta name="google-site-verification" content="-vRqwa9WYn6AaQGnl88xvrLw6ac4xoKVkZkhanmlRhU" />
  <link rel="canonical" href="https://www.graal.cloud/gcn/gcn-modules/database/micronaut-mysql-database-google/">

  <!-- jQuery UI Tabs -->
  <link rel="stylesheet" href="//code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css">
  <link rel="stylesheet" href="/gcn/resources/lib/jquery/jquery-ui.css">
</head>

      <script src="/gcn/resources/lib/jquery/jquery-3.6.1.min.js"></script>
    <script src="/gcn/resources/lib/bootstrap/js/bootstrap.min.js"></script>
    <script src='/gcn/resources/lib/sticky-sidebar/resizeSensor.js'></script>
    <script src='/gcn/resources/lib/sticky-sidebar/sticky-sidebar.min.js'></script>
    <script src="/gcn/resources/lib/highlight/highlight.min.js"></script>
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <!-- Add TRUSTe Consent Script and Analytics -->
    <script async="async" type="text/javascript" src='//consent.trustarc.com/notice?domain=oracle.com&c=teconsent&js=bb&noticeType=bb&text=true&cdn=1&pcookie&gtm=1' crossorigin></script>
    <script src="https://www.oracle.com/assets/truste-oraclelib.js"></script>
    <!-- jQuery UI Tabs -->
    <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.js"></script>


  <body class="preload">
    <!-- Start SiteCatalyst code -->
    <script language="JavaScript" src="https://www.oracle.com/us/assets/metrics/ora_otn.js"></script>
    <!-- End SiteCatalyst code -->

    <div  class="wrapper wrapper--nofooter" >

      <header  class="header header--content" 
  role="banner">

  

  

    <nav class="menu">
      <div class="menu__row">
        <div>
          <a href="/gcn/">
            <img class="logo-mobile" src="/gcn/resources/img/gcn-logo-01.svg" alt="Graal Cloud Native logo">
          </a>
        </div>
        <div class="menu__container">
          <ul class="menu__list">
            <li class="menu__item">
              <a href="/gcn/about/" class="menu__link">About</a>
            </li>
            <li class="menu__item">
              <a href="/gcn/get-started/" class="menu__link">Get Started</a>
            </li>
            <li class="menu__item">
              <div class="stack-container">
                <a href="#" class="menu__link stack__header">Docs</a>
                <div class="stack-menu-learn">
                  <div class="stack-row">
                    <div class="stack-column">
                      <div class="stack__item">
                        <img src='/gcn/resources/img/header-navigation/modules.svg'>
                        <a href="/gcn/modules/" class="item-line">Modules</a>
                      </div>
                      <div class="stack__item">
                        <img src='/gcn/resources/img/header-navigation/guides.svg'>
                        <a href="/gcn/guides/" class="item-line">Guides</a>
                      </div>
                      <div class="stack__item">
                        <img src='/gcn/resources/img/header-navigation/labs.svg'>
                        <a href="/gcn/hands-on-labs/" class="item-line">Hands-On Labs</a>
                      </div>
                      <div class="stack__item">
                        <img src='/gcn/resources/img/header-navigation/tools.svg'>
                        <a href="/gcn/vscode-tools/" class="item-line">Tools</a>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </li>
            <li class="menu__item">
              <div class="stack-container">
                <a href="#" class="menu__link stack__header">Graal Projects</a>
                <div class="stack-menu">
                  <div class="stack-row">
                    <div class="stack-column">
                      <div class="stack__item">
                        <img src='/gcn/resources/img/header-navigation/graalstack.svg'>
                        <a href="https://graal.cloud/" class="item-line">Graal</a>
                      </div>
                      <div class="stack__item">
                        <img src='/gcn/resources/img/header-navigation/graalvm.svg'>
                        <a href="https://graalvm.org/" class="item-line">GraalVM</a>
                      </div>
                      <div class="stack__item">
                        <img src='/gcn/resources/img/header-navigation/graalos.svg'>
                        <a href="https://graal.cloud/graalos/" class="item-line">GraalOS</a>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </li>
            <li class="menu__launch__mobile">
              <a href="/gcn/launcher/" class="btn-launch btn btn-primary" target="blank">Create App</a>
            </li>
          </ul>
        </div>
        <div class="menu__launch">
          <a href="/gcn/launcher/" class="btn-launch btn btn-primary" target="blank">Create App</a>
        </div>
      </div>

      <div role="button" class="menu-btn menu-btn--menu js-show-menu" tabindex="-1" title="sweet hamburger">
        <div class="hamburger">
          <div class="inner"></div>
        </div>
      </div>
      <button aria-label="hamburger mobile menu" class="btn btn-mobile-menu js-show-menu">
        <div class="inner"></div>
      </button>
    </nav>

  
</header>


      <main  class="content"   aria-label="Content">
        <div class="wrapper wrapper-content">
  <article>
  <div class="row d-flex flex-wrap">
    <div class="col-sm-3 docsimpro col-bg">
      <div class="sidebar-wrap">
        <div class="sidebar">
          <div class="menuabout">
            <img id="sidebarClose" src="/gcn/resources/img/arrow_sidebar(close).svg" alt="Expand or collapse sidebar"
              class="btn-color no-display">
            <img id="sidebarOpen" src="/gcn/resources/img/arrow_sidebar.svg" alt="Expand or collapse sidebar">
          </div>
          
<div class="toc-floating">


<div class="toc-bullets">


  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    

    
      
        
          <li class="toc-bullets-main">
        
          
          <a href="/gcn/docs/gcn-modules/database/" class="_icon-book">
            Database
          </a>
        </li>

        
        

        
        
          
          <li class="toc-bullets-sub toc-bullets-highlight">
          
            
            <a href="/gcn/gcn-modules/database/micronaut-mysql-database-google/">
              Create and Connect a Micronaut Application to a Google MySQL Database
            </a>
          </li>

          
            <div>
  <script>
    var scriptElement = document.currentScript;
    var div = $(scriptElement.parentElement);
    $(window).on("load", function () {
      $("#content-wrapper h2").each(function () {
        var li = $("<li></li>", { class: "toc-bullets-sub toc-bullets-sub-3" });
        var a = $("<a></a>", { href: "#" + $(this).attr("id") });
        a.text($(this).text().replace('#', ''));
        li.append(a);
        li.click(function (e) {
          e.preventDefault();
          var target = $(a.attr('href'));
          var scrollTo = target.offset().top - 80; // 80 - indent
          $('html, body').animate({ scrollTop: scrollTo }, 1000);
        });
        div.append(li);
      });
    });
  </script>
</div>
          
        
      
    
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

<!-- <li class="search additional-search">
  <form class="form-inline sidebar" action="/docs/search" autocomplete="on" method="get">
    <input class="input-search sidebar" type="text" id="search-box" name="query" placeholder="Search">
    <button type="submit sidebar" class="search-button"></button>
  </form>
</li> -->

</div>
  <!-- Search form -->
  <!-- <form class="search-container" action="/docs/search" autocomplete="on" method="get">
   <label for="search-box">Search</label>
    <input type="text" id="search-box" name="query">
    <button type="submit" class="searchbttn"></button>
  </form> -->
</div>

        </div>
      </div>
    </div>

    <div class="col-sm-9 docsmod">
      <div id="content-wrapper" class="docs-content docs-content--with-sidebar">
        <!--
          Include file to warn of Windows/Gradle restriction
        -->
        <h1 id="create-and-connect-a-micronaut-application-to-a-google-mysql-database">
        
        
          Create and Connect a Micronaut Application to a Google MySQL Database
        
        
      </h1>

<p>This guide describes how to create a Micronaut database application. The application presents REST endpoints and stores data in a Google Cloud Platform (GCP) MySQL database using Micronaut Data.</p>

<p><a href="https://cloud.google.com/sql/mysql">GCP Cloud SQL for MySQL</a> is a service for MySQL database to set up, manage, and administer MySQL deployments in the cloud. GCP Cloud SQL supports MySQL Community Edition versions 5.6, 5.7, and 8.0.</p>

<p><a href="https://micronaut-projects.github.io/micronaut-data/latest/guide/">Micronaut Data</a> is a database access toolkit that uses ahead-of-time (AoT) compilation to pre-compute queries for repository interfaces that are then executed by a thin, lightweight runtime layer. Micronaut Data supports the following backends: JPA (Hibernate) and Hibernate Reactive; SQL (JDBC, R2DBC), and MongoDB.</p>
    
      <h3 id="prerequisites">
        
        
          Prerequisites <a href="#prerequisites" class="anchor_heading">#</a>
        
        
      </h3>

<ul>
  <li>JDK 17 or higher. See <a href="/gcn/get-started/setting-up-desktop/">Setting up Your Desktop</a>.</li>
  <li>A Google Cloud Platform (GCP) account. See <a href="/gcn/get-started/setting-up-cloud-accounts/">Setting up your Cloud Accounts</a>.</li>
  <li>The Google Cloud CLI. (The CLI is part of the Google Cloud SDK; for more information, see <a href="https://cloud.google.com/sdk">Cloud SDK</a>.)</li>
  <li>The GCN CLI. See <a href="/gcn/get-started/setting-up-desktop/">Setting up Your Desktop</a>. (Optional.)</li>
</ul>

<blockquote>
  <p>Note: This guide uses paid services; you may need to enable Billing in Google Cloud to complete some steps in this guide.</p>
</blockquote>

<p>Follow the steps below to create the application from scratch. However, you can also download the completed example in Java:</p>

<div id="tabs-doc1">
    <ul>
        <li class="tabs-gradle"><a name="gradle" href="#gradle">Gradle</a></li>
        <li class="tabs-maven"><a name="maven" href="#maven">Maven</a></li>
    </ul>
    <div id="gradle">
        <p><a href="/gcn/docs/gcn-modules/database/archives/gcp-db-demo-java-gradle.zip">Gradle GCP Database Example <img class="download-img-guides" src="/gcn/resources/img/gcn_modules/download-archive.png" alt="Download completed example" />
        </a>
        </p>
    </div>
    <div id="maven">
        <p><a href="/gcn/docs/gcn-modules/database/archives/gcp-db-demo-java-maven.zip">Maven GCP Database Example <img class="download-img-guides" src="/gcn/resources/img/gcn_modules/download-archive.png" alt="Download completed example" /></a>
        </p>
    </div>
</div>
    
      <h4 id="a-note-regarding-your-development-environment">
        
        
          A note regarding your development environment
        
        
      </h4>

<p>Consider using Visual Studio Code that provides native support for developing applications with the <a href="/gcn/vscode-tools/using-gcn-vscode-tools/">Graal Cloud Native Tools extension</a>.</p>

<blockquote>
  <p>Note: If you use IntelliJ IDEA, <a href="/gcn/resources/img/annotationprocessorsintellij.png">enable annotation processing</a>.</p>
</blockquote>

<blockquote>
  <p>Windows platform: The GCN guides are compatible with Gradle only. Maven support is coming soon.</p>
</blockquote>
    
      <h2 id="1-create-the-application">
        
        
          1. Create the Application <a href="#1-create-the-application" class="anchor_heading">#</a>
        
        
      </h2>

<p>Create an application using the GCN Launcher.</p>

<ol>
  <li>
    <p>Open the <a href="/gcn/launcher/?advanced=true">GCN Launcher in advanced mode</a>.</p>
  </li>
  <li>Create a new project using the following selections.
    <ul>
      <li><strong>Project Type</strong>: <em>Application</em> (default)</li>
      <li><strong>Project name</strong>: <em>gcp-db-demo</em></li>
      <li><strong>Base Package</strong>: <em>com.example</em> (Default)</li>
      <li><strong>Clouds</strong>: <em>GCP</em></li>
      <li><strong>Language</strong>: <em>Java</em> (default)</li>
      <li><strong>Build Tool</strong>: <em>Gradle (Groovy)</em> or <em>Maven</em></li>
      <li><strong>Test Framework</strong>: <em>JUnit</em> (default)</li>
      <li><strong>Java Version</strong>: <em>17</em> (default)</li>
      <li><strong>Micronaut Version</strong>: (default)</li>
      <li><strong>Features</strong>: <em>GraalVM Native Image</em> (Default)</li>
      <li><strong>Sample Code</strong>: <em>Yes</em> (Default)</li>
    </ul>
  </li>
  <li>
    <p>Switch to the <strong>Cloud Services</strong> tab and make sure the <strong>Database</strong> service is selected. Uncheck the other services. The Database GCN service bundles all necessary features for a Micronaut database application: <strong>Micronaut Data JDBC</strong>, <strong>Hikari JDBC Connection Pool</strong>, <strong>Flyway Database Migration</strong>, the <strong>MySQL</strong> driver, etc.</p>
  </li>
  <li>
    <p>Switch to <strong>Selected</strong> tab to verify the selection. You should see <strong>Database</strong> and the <strong>GraalVM Native Image</strong> packaging feature (selected by default) selected.</p>
  </li>
  <li>Click <strong>Generate Project</strong>, then click <strong>Download Zip</strong>. GCN Launcher creates a Java project with the default package <code>com.example</code> in a directory named <em>gcp-db-demo</em>. The application ZIP file will be downloaded in your default downloads directory. Unzip it, open in your code editor, and proceed to the next steps.</li>
</ol>

<p>Alternatively, use the <a href="/gcn/get-started/using-gcn-cli/">GCN CLI</a> as follows:</p>

<div id="tabs-doc2">
  <ul>
    <li class="tabs-gradle"><a href="#gradle">Gradle</a></li>
    <li class="tabs-maven"><a href="#maven">Maven</a></li>
  </ul>
  <div id="gradle">
    <pre><code class="language-bash">gcn create-app com.example.gcp-db-demo \
    --clouds=gcp \
    --services=database \
    --features=graalvm \
    --build=gradle \
    --lang=java</code></pre>
  </div>
  <div id="maven">
    <pre><code class="language-bash">gcn create-app com.example.gcp-db-demo \
    --clouds=gcp \
    --services=database \
    --features=graalvm \
    --build=maven \
    --lang=java</code></pre>
  </div>
</div>

<p>Open the <em>micronaut-cli.yml</em> file, you can see what features are packaged with the application:</p>
<pre><code class="language-yml">features: [annotation-api, app-name, data, data-jdbc, flyway, gcn-bom, gcn-gcp-cloud-app, gcn-gcp-database, gcn-license, graalvm, gradle, http-client, jackson-databind, java, java-application, jdbc-hikari, junit, logback, micronaut-build, mysql, netty-server, readme, shade, test-resources, yaml]
</code></pre>

<p>The GCN Launcher creates a multi-module project with two subprojects: <strong>gcp</strong> for GCP, and <strong>lib</strong> for common code and configuration shared across cloud platforms.
You develop the application logic in the <strong>lib</strong> subproject, and keep the GCP-specific configurations in the <strong>gcp</strong> subproject.
If you enable sample code generation, the GCN Launcher creates the main controller, repository interface, entity, service classes, and tests for you.
Consider checking <a href="/gcn/gcn-modules/database/micronaut-data-jdbc-repository/">this guide</a> where each sample class is closely examined.</p>
    
      <h3 id="11-configure-datasources">
        
        
          1.1. Configure Datasources <a href="#11-configure-datasources" class="anchor_heading">#</a>
        
        
      </h3>

<p>The datasources are defined in the <em>gcp/src/main/resources/application-gcp.properties</em> file.
The GCN Launcher also included and enabled <a href="http://www.flywaydb.org">Flyway</a> to perform migrations on the default datasources. It uses the <a href="https://micronaut-projects.github.io/micronaut-flyway/latest/guide/">Micronaut integration with Flyway</a> that automates schema changes, significantly simplifies schema management tasks, such as migrating, rolling back, and reproducing in multiple environments:</p>

<pre><code>flyway.datasources.default.enabled=true
</code></pre>

<blockquote>
  <p>Note: Flyway migrations are not compatible with the default automatic schema generation. So, in the <em>gcp/src/main/resources/application-gcp.properties</em> file, either delete the <code>datasources.default.schema-generate=CREATE_DROP</code> line or change that line to <code>datasources.default.schema-generate=NONE</code> to ensure that only Flyway manages your schema.</p>
</blockquote>

<p>Flyway migration is automatically triggered before your application starts. Flyway reads migration file(s) in the <em>lib/src/main/resources/db/migration/</em> directory. The migration file with the database schema, <em>lib/src/main/resources/db/migration/V1__schema.sql</em>, was also created for you by the GCN Launcher.</p>

<pre><code class="language-sql">DROP TABLE IF EXISTS genre;

CREATE TABLE genre (
     id   BIGINT NOT NULL AUTO_INCREMENT UNIQUE PRIMARY KEY,
    name  VARCHAR(255) NOT NULL UNIQUE
);
</code></pre>

<p>During application startup, Flyway runs the commands in the SQL file and creates the schema needed for the application.</p>
    
      <h2 id="2-create-a-google-cloud-platform-project">
        
        
          2. Create a Google Cloud Platform Project <a href="#2-create-a-google-cloud-platform-project" class="anchor_heading">#</a>
        
        
      </h2>

<p>Create a new Google Cloud Platform project and name it “gcn-guides”.</p>

<p><img src="/gcn/docs/gcn-modules/database/database-images/gcp-project.png" alt="Google Cloud Platform Project" /></p>
    
      <h3 id="21-install-the-cloud-sdk">
        
        
          2.1. Install the Cloud SDK <a href="#21-install-the-cloud-sdk" class="anchor_heading">#</a>
        
        
      </h3>

<p>The Cloud SDK includes the <code>gcloud</code> command-line tool.</p>

<ol>
  <li>Initialize the Cloud SDK:
    <pre><code class="language-bash"> gcloud init
</code></pre>
  </li>
  <li>Log in to the Google Cloud Platform:
    <pre><code class="language-bash"> gcloud auth login
</code></pre>
  </li>
  <li>Select your project:
    <pre><code class="language-bash"> gcloud config set project gcn-guides
</code></pre>
  </li>
</ol>

<p>You can get the IDs of your projects by running the command <code>gcloud projects list</code>.</p>
    
      <h2 id="3-create-a-mysql-database-instance-in-google-cloud">
        
        
          3. Create a MySQL Database Instance in Google Cloud <a href="#3-create-a-mysql-database-instance-in-google-cloud" class="anchor_heading">#</a>
        
        
      </h2>

<p>You will create a MySQL database instance with the GCP CLI.
See the <a href="https://cloud.google.com/sdk/gcloud/reference/sql">MySQL CLI command reference</a> for more information.</p>

<p>Run this command to create a MySQL instance:</p>

<pre><code class="language-bash">gcloud sql instances create gcn-guides-mysql \
    --database-version=MYSQL_8_0 \
    --tier=db-f1-micro \
    --region=us-east1 \
    --root-password=&lt;YOUR_ROOT_PASSWORD&gt; \
    --authorized-networks=&lt;LOCAL_IP_ADDRESS&gt;
</code></pre>
<ul>
  <li>
    <p><code>gcn-guides-mysql</code> Change if you wish to use a different instance name.</p>
  </li>
  <li>
    <p><code>--database-version</code> Specify MySQL v8.0. (See <a href="https://cloud.google.com/sql/docs/mysql/admin-api/rest/v1beta4/SqlDatabaseVersion">SQL DB Versions</a> for other options.)</p>
  </li>
  <li>
    <p><code>--tier</code> Change to match your needs. (Instead of using tiers, you can specify the CPU and memory, with the <code>--cpu</code> and <code>--memory</code> options.)</p>
  </li>
  <li>
    <p><code>--region</code> Defaults to <code>us-central1</code> if omitted.</p>
  </li>
  <li>
    <p><code>--root-password</code> Defaults to <code>password123</code> if omitted.</p>
  </li>
  <li>
    <p><code>--authorized-networks</code> A single IP or a range of IP Addresses in the CIDR notation.</p>
  </li>
  <li>
    <p><code>LOCAL_IP_ADDRESS</code> This is the local IP address where the application is running. You can find out the value your local machine by visiting <a href="http://whatismyip.akamai.com/">http://whatismyip.akamai.com/</a>.</p>
  </li>
</ul>

<p>You might be prompted to enable the Google SQL Admin API:</p>
<pre><code>API [sqladmin.googleapis.com] not enabled on project [&lt;project-id&gt;].

Would you like to enable and retry (this will take a few minutes)? (y/N)?
</code></pre>

<p>You will see the following output:</p>
<pre><code>NAME                    DATABASE_VERSION  LOCATION    TIER         PRIMARY_ADDRESS  PRIVATE_ADDRESS  STATUS
gcn-guides-mysql  MYSQL_8_0         us-east1-c  db-f1-micro  34.xxx.xxx.65    -                RUNNABLE
</code></pre>

<p>Make note of the <code>"Primary Address"</code>; you will need this later.</p>

<p>If you need to change the <code>authorized-networks</code>, run the following command:</p>
<pre><code class="language-bash">gcloud sql instances patch gcn-guides-mysql \
    --authorized-networks=&lt;DIFFERENT_IP&gt;
</code></pre>
    
      <h3 id="31-create-a-database-user">
        
        
          3.1. Create a Database User <a href="#31-create-a-database-user" class="anchor_heading">#</a>
        
        
      </h3>

<p>Instead of using the <em>root</em> DB User account, create one for the application to use, as follows:</p>

<pre><code class="language-bash">gcloud sql users create &lt;USER_NAME&gt; \
    --instance=gcn-guides-mysql \
    --password=&lt;USER_PASSWORD&gt;
</code></pre>
    
      <h3 id="32-create-the-database">
        
        
          3.2. Create the Database <a href="#32-create-the-database" class="anchor_heading">#</a>
        
        
      </h3>

<p>Now that you have your MySQL instance running, create a database as follows:</p>

<pre><code class="language-bash">gcloud sql databases create demo \
    --instance=gcn-guides-mysql
</code></pre>
    
      <h2 id="4-run-the-application">
        
        
          4. Run the Application <a href="#4-run-the-application" class="anchor_heading">#</a>
        
        
      </h2>

<ol>
  <li>
    <p>Return to your local IDE where you have opened the Micronaut database application.
With almost everything in place, you can start the application and try it out.</p>
  </li>
  <li>Define the database driver URL, username, and password to configure the application <strong>datasources</strong>. It should look like this:
    <pre><code> datasources.default.driver-class-name=com.mysql.cj.jdbc.Driver
 datasources.default.db-type=mysql
 datasources.default.schema-generate=CREATE_DROP
 datasources.default.dialect=MYSQL
 datasources.default.url=jdbc:mysql://&lt;MySQL IP address&gt;:3306/demo
 datasources.default.username=guide_user
 datasources.default.password=&lt;user password&gt;
</code></pre>

    <p>Where <code>&lt;MySQL_IP_Address&gt;</code> is the <strong>public IP address</strong> of your MySQL database instance.</p>

    <p>Alternatively, you can export those via environment variables. From the terminal connected to the virtual machine, run:</p>
    <pre><code class="language-shell"> export DATASOURCES_DEFAULT_URL=jdbc:mysql://&lt;MySQL IP address&gt;:3306/demo
 export DATASOURCES_DEFAULT_USERNAME=guide_user
 export DATASOURCES_DEFAULT_PASSWORD=&lt;user password&gt;
</code></pre>

    <blockquote>
      <p>Note: If you use Windows Command Prompt, replace <code>export</code> with <code>set</code>, for example, <code>set DATASOURCES_DEFAULT_USERNAME=guide_user</code>. If you use Windows PowerShell, replace <code>export</code> with <code>$</code> and surround the value with double quote marks, for example, <code>$DATASOURCES_DEFAULT_USERNAME="guide_user"</code>.</p>
    </blockquote>
  </li>
  <li>
    <p>Build and test the application running:</p>

    <div id="tabs-doc2">
 <ul>
     <li class="tabs-gradle"><a href="#gradle">Gradle</a></li>
     <li class="tabs-maven"><a href="#maven">Maven</a></li>
 </ul>
 <div id="gradle">
     <pre><code class="language-bash">./gradlew :gcp:run</code></pre>
 </div>
 <div id="maven">
     <pre><code class="language-bash">./mvnw install -pl lib -am &amp;&amp; ./mvnw mn:run -pl gcp</code></pre>
 </div>
 </div>

    <p>It builds the project and starts the application on port 8080.</p>
  </li>
  <li>Run this command with the public IP address of your VM to create a new <code>Genre</code>:
    <pre><code class="language-bash"> curl -X "POST" "http://&lt;public IP address&gt;:8080/genres" \
      -H 'Content-Type: application/json; charset=utf-8' \
      -d $'{ "name": "music" }'
</code></pre>
  </li>
  <li>Run this command to list the genres:
    <pre><code class="language-bash"> curl &lt;public IP address&gt;:8080/genres/list
</code></pre>
  </li>
</ol>

<p>This server application presents REST endpoints and stores data in the Google MySQL database using Micronaut Data JDBC.</p>

<p>Next, you can package this application as a native executable and deploy from the virtual machine, connected to the MySQL database. Deploying as a native executable does not require a Java VM to run, so you can transfer it to a remote machine and run easily.</p>
    
      <h2 id="5-generate-a-native-executable-using-graalvm">
        
        
          5. Generate a Native Executable Using GraalVM <a href="#5-generate-a-native-executable-using-graalvm" class="anchor_heading">#</a>
        
        
      </h2>

<p>GCN supports compiling Java applications ahead-of-time into native executables using <a href="https://www.graalvm.org/">GraalVM Native Image</a> and <a href="https://graalvm.github.io/native-build-tools/latest/index.html">Native Build Tools</a>. Packaged as a native executable, it significantly reduces the application startup time and memory footprint.</p>

<blockquote>
  <p><strong>Prerequisites</strong>: GraalVM Native Image is required to build native executables. <a href="https://github.com/graalvm/get.graalvm.org/">Install GraalVM JDK with Native Image</a> if you have not done that yet.</p>
</blockquote>

<ol>
  <li>
    <p>To generate a native executable, use the following command:</p>

    <div id="tabs-doc4">
 <ul>
     <li class="tabs-gradle"><a href="#gradle">Gradle</a></li>
     <li class="tabs-maven"><a href="#maven">Maven</a></li>
 </ul>
 <div id="gradle">
     <pre><code class="language-bash">./gradlew :gcp:nativeCompile</code></pre>
     <p>The native executable will be created in the <code>gcp/build/native/nativeCompile/</code> directory.</p>
 </div>
 <div id="maven">
     <pre><code class="language-bash">./mvnw install -pl lib -am &amp;&amp; ./mvnw package -pl gcp -Dpackaging=native-image</code></pre>
     <p>The native executable will be created in the <code>gcp/target/</code> directory.</p>
 </div>
 </div>

    <p>You can customize the name of the resulting binary by <a href="https://graalvm.github.io/native-build-tools/latest/index.html">updating the Maven/Gradle plugin for GraalVM Native Image configuration</a>.</p>
  </li>
  <li>
    <p>Run the native executable:</p>

    <div id="tabs-doc5">
 <ul>
     <li class="tabs-gradle"><a href="#gradle">Gradle</a></li>
     <li class="tabs-maven"><a href="#maven">Maven</a></li>
 </ul>
 <div id="gradle">
     <pre><code class="language-bash">gcp/build/native/nativeCompile/gcp</code></pre>
 </div>
 <div id="maven">
     <pre><code class="language-bash">gcp/target/gcp</code></pre>
 </div>
 </div>
  </li>
  <li>
    <p>Run this command to create a new <code>Genre</code> entry in the database table:</p>
    <pre><code class="language-bash"> curl -X "POST" "http://localhost:8080/genres" \
       -H 'Content-Type: application/json; charset=utf-8' \
       -d $'{ "name": "music" }'
</code></pre>

    <p>Then list all genres:</p>
    <pre><code class="language-bash"> curl localhost:8080/genres/list
</code></pre>
  </li>
</ol>

<p>As a reminder, you do not need to install a Java VM on the virtual machine to run the application. The native executable is a self-contained binary. Deploying from a native executable significantly reduces application startup time and memory footprint.</p>
    
      <h2 id="6-stop-the-instance">
        
        
          6. Stop the Instance <a href="#6-stop-the-instance" class="anchor_heading">#</a>
        
        
      </h2>

<p>Use the following command to stop the instance:</p>
<pre><code class="language-bash">gcloud sql instances patch gcn-guides-mysql \
    --activation-policy=NEVER
</code></pre>
    
      <h2 id="7-clean-up">
        
        
          7. Clean up <a href="#7-clean-up" class="anchor_heading">#</a>
        
        
      </h2>

<p>When you have completed the guide, you can clean up the resources you created on Google Cloud Platform so you will not be billed for them in the future.</p>
    
      <h3 id="71-delete-the-project">
        
        
          7.1. Delete the Project <a href="#71-delete-the-project" class="anchor_heading">#</a>
        
        
      </h3>

<p>The easiest way to eliminate billing is to delete the project you created.</p>

<p>Deleting a project has the following consequences:</p>

<ul>
  <li>
    <p>If you used an existing project, you will also delete any other work you have done in the project.</p>
  </li>
  <li>
    <p>You cannot reuse the project ID of a deleted project. If you created a custom project ID that you plan to use in the future, you should delete the resources inside the project instead. This ensures that URLs that use the project ID, such as an <em>appspot.com</em> URL, remain available.</p>
  </li>
  <li>
    <p>If you are exploring multiple guides, reusing projects instead of deleting them prevents you from exceeding project quota limits.</p>
  </li>
</ul>
    
      <h4 id="711-via-the-cli">
        
        
          7.1.1. Via the CLI
        
        
      </h4>
<p>To delete the project using the Google Cloud CLI, run the following command:</p>

<pre><code class="language-bash">gcloud projects delete gcn-guides
</code></pre>
    
      <h4 id="712-via-the-cloud-platform-console">
        
        
          7.1.2. Via the Cloud Platform Console
        
        
      </h4>

<ol>
  <li>
    <p>In the Cloud Platform Console, go to the <a href="https://console.cloud.google.com/iam-admin/projects">Projects page</a>.</p>
  </li>
  <li>
    <p>In the project list, select the project you want to delete and click <strong>Delete project</strong>. Select the check box next to the project name and click <strong>Delete project</strong>.</p>
  </li>
  <li>
    <p>In the dialog box, enter the project ID, and then click <strong>Shut down</strong> to delete the project.</p>
  </li>
</ol>
    
      <h3 id="summary">
        
        
          Summary <a href="#summary" class="anchor_heading">#</a>
        
        
      </h3>

<p>This guide demonstrated how to create and access a database application that stores data in a Google MySQL database using Micronaut Data JDBC. 
You also learned how to package this application into a native executable.</p>
    
      <h3 id="related-documentation">
        
        
          Related Documentation <a href="#related-documentation" class="anchor_heading">#</a>
        
        
      </h3>

<ul>
  <li><a href="/gcn/gcn-modules/database/micronaut-data-jdbc-repository/">Create and Connect an Application to MySQL Database</a></li>
  <li><a href="https://micronaut-projects.github.io/micronaut-data/latest/guide/">Micronaut Data</a></li>
  <li><a href="https://micronaut-projects.github.io/micronaut-gcp/latest/guide/index.html">Micronaut Google Cloud Platform Support</a></li>
  <li><a href="https://cloud.google.com/sql/docs/mysql">Google Cloud SQL</a></li>
  <li><a href="https://graalvm.github.io/native-build-tools/latest/index.html">Native Build Tools</a></li>
  <li><a href="https://www.graalvm.org/">GraalVM Native Image</a></li>
</ul>

      </div>

      <div role="button" class="menu-btn menu-btn--sidebar js-show-sidebar" title="sweet hamburger">
        <div class="hamburger">
          <div class="inner"></div>
        </div>
      </div>
    </div>
  </div>
</article>



</div>

      </main>

      
<footer class="footer footer__mobile">

  <div class="container-fluid container-fluid--custom-sm">
    <div class="row">
      <div class="col-12 col-sm-12 col-md-12 col-lg-12">
        <div class="row footer-content">
          <div class="col-md-3 col-sm-4">
            <h6 class="title-footer" onclick="fadeInAndOut(this)">Learn</h6>
            <div class="grow">
              <ul class="footer-list">
                <li class="footer-list__item"><a href="/gcn/get-started/">Get Started</a></li>
                <li class="footer-list__item"><a href="/gcn/guides/">Guides</a></li>
                <li class="footer-list__item"><a href="/gcn/hands-on-labs/">Labs</a></li>
                <li class="footer-list__github">
                  <img class="footer__icon" src="/gcn/resources/img/footer/logo-github.svg" alt="Github icon">
                  <a href="https://github.com/oracle/gcn" target="blank">Github</a>
                </li>
                <li class="footer-list__github">
                  <img class="footer__icon" src="/gcn/resources/img/footer/slack-icon.svg" alt="Github icon">
                  <a href="https://bit.ly/odevrel_slack" target="blank">Join us at: #graal-cloud-native</a>
                </li>
              </ul>
            </div>
          </div>
          <div class="col-md-3 col-sm-4">
            <h6 class="title-footer" onclick="fadeInAndOut(this)">About</h6>
            <div class="grow">
              <ul class="footer-list">
                <li class="footer-list__item"><a href="/gcn/about/#support" target="blank">Commercial Support</a></li>
                <li class="footer-list__item"><a href="https://www.graalvm.org/" target="blank">GraalVM Native Image</a></li>
                <li class="footer-list__item"><a href="https://micronaut.io/" target="_blank">Micronaut</a></li>
                <li class="footer-list__item"><a href="https://www.oracle.com/cloud/multicloud/what-is-multicloud/" target="_blank">Multicloud</a></li>
                <li class="footer-list__item"><a href="https://www.oracle.com/cloud/" target="blank">Oracle Cloud Infrastructure</a></li>
                <li class="footer-list__item"><a href="https://marketplace.visualstudio.com/items?itemName=oracle-labs-graalvm.graal-cloud-native-pack" target="blank">VS Code Tools</a></li>
              </ul>
            </div>
          </div>
          <div class="col-md-6 col-sm-12 aligning_1024">
            <div class="card--footer card--hovered box">
              <div>
                <div class="rubber-footer footer__oci-section">
                  <p class="title-footer quickstart">Build, test, and deploy applications on Oracle Cloud Infrastructure for free</p>
                  <a href="https://www.oracle.com/cloud/free/" target="_blank"
                    class="btn btn-primary">Try Oracle Cloud Infrastructure Free Tier</a>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="col-12 col-sm-12 col-md-12 col-lg-12">
          <div class="row">
            <div class="col-sm-12">
              <p class="copyright">
                Copyright © 2023-2024, Oracle and/or its affiliates. All rights reserved.
                Oracle and Java are registered trademarks of Oracle and/or its affiliates.
                Other names may be trademarks of their respective owners. 
              </p>
              <div id="teconsent"></div>
            </div>
          </div>

        </div>
      </div>

    </div>
  </div>
</footer>

<script>
  function fadeInAndOut(thz) {
    var elmt = thz.nextElementSibling;//Get the element that is below the button that
    //was just clicked
    if (elmt.clientHeight) {
      elmt.style.height = 0;
    } else {
      var wrapper = elmt.querySelector('ul');
      elmt.style.height = wrapper.clientHeight + "px";
    }
    /*
        elmt.classList.toggle("acordianPanelHidden");//Toggle the class which changes
        //attributes which triggers the transition CSS
        */
  }

  // Check TRUSTe Consent for Functional or Implied Approval
  // The if test verifies if the user has given the consent
  if ( (oracle.truste.api.getGdprConsentDecision().consentDecision) &&
      (oracle.truste.api.getGdprConsentDecision().consentDecision.indexOf(0) != -1 ||
        oracle.truste.api.getGdprConsentDecision().consentDecision.indexOf(2) != -1) ) {

      //The following is a sample of a Maxymiser Tag being written to the DOM
      //If the user did not give consent, then the tag is not included and not invoked in the Browser
      document.write('<script type="text/javascript" src="//service.maxymiser.net/cdn/oracle/js/mmcore.js"><\/script>');
  }

  // Check TRUSTe Consent for Advertising or Implied Approval
  // The if test verifies if the user has given the consent
  if ( (oracle.truste.api.getGdprConsentDecision().consentDecision) &&
      (oracle.truste.api.getGdprConsentDecision().consentDecision.indexOf(0) != -1 ||
        oracle.truste.api.getGdprConsentDecision().consentDecision.indexOf(3) != -1) ) {

      //The following is a sample of a BlueKai Core Tag being written to the DOM
      //If the user did not give consent, then the tag is not included and not invoked in the Browser
      document.write('<script type="text/javascript">' +
      'window.bk_async = function() { ' +
      'BKTAG.doTag(62581, 1); }; ' +
      '(function() { ' +
      'var scripts = document.getElementsByTagName(\'script\')[0]; ' +
      'var s = document.createElement(\'script\'); ' +
      's.async = true; ' +
      's.src = "https://tags.bkrtx.com/js/bk-coretag.js"; ' +
      'scripts.parentNode.insertBefore(s, scripts); ' +
      '}()); ' +
      '<\/script>');
  }
</script>

    </div>
    <div class="overlay"></div>

    <!-- Start SiteCatalyst code -->
    <script language="JavaScript" src="https://www.oracle.com/us/assets/metrics/ora_otn.js"></script>
    <!-- End SiteCatalyst code -->

    <script src='/gcn/resources/lib/slick-slider/slick.min.js'></script>
    <script src='/gcn/resources/js/main.js'></script>
    <script src='/gcn/resources/js/ui.js'></script>
    <script src='/gcn/resources/js/filters.js'></script>
    <script src='/gcn/resources/js/sidebar.js'></script>
    <script src='/gcn/resources/js/labs.js'></script>
    <script src='/gcn/resources/lib/highlight/highlight.min.js'></script> 
    <script>hljs.highlightAll();</script>
  </body>
</html>

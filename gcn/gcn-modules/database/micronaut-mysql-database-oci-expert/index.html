<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta property="og:image" content="/gcn/resources/img/graalvm.png" />
  <meta name="twitter:widgets:border-color" content="#55acee">

  <title>
    
      Expert&#39;s Guide to Create and Connect a Micronaut Application to the Oracle Cloud Infrastructure MySQL HeatWave Service
    
  </title>
  <meta name="description" content="Graal Cloud Native (GCN) is a build of a curated set of Micronaut framework modules and their required libraries for building portable cloud-native microserv..."/>
  <meta name="last_modified" content="2023-12-18 17:09:42 +0000"/>
  <link rel="stylesheet" href="/gcn/assets/main.css">
  <link rel="apple-touch-icon" sizes="180x180" href="/gcn/resources/img/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/gcn/resources/img/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/gcn/resources/img/favicon/favicon-16x16.png">
  <link rel="manifest" href="/resources/img/favicon/site.webmanifest">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
  <meta name="google-site-verification" content="-vRqwa9WYn6AaQGnl88xvrLw6ac4xoKVkZkhanmlRhU" />
  <link rel="canonical" href="https://www.graal.cloud/gcn/gcn-modules/database/micronaut-mysql-database-oci-expert/">

  <!-- jQuery UI Tabs -->
  <link rel="stylesheet" href="//code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css">
  <link rel="stylesheet" href="/gcn/resources/lib/jquery/jquery-ui.css">
</head>

      <script src="/gcn/resources/lib/jquery/jquery-3.6.1.min.js"></script>
    <script src="/gcn/resources/lib/bootstrap/js/bootstrap.min.js"></script>
    <script src='/gcn/resources/lib/sticky-sidebar/resizeSensor.js'></script>
    <script src='/gcn/resources/lib/sticky-sidebar/sticky-sidebar.min.js'></script>
    <script src="/gcn/resources/lib/highlight/highlight.min.js"></script>
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <!-- Add TRUSTe Consent Script and Analytics -->
    <script async="async" type="text/javascript" src='//consent.trustarc.com/notice?domain=oracle.com&c=teconsent&js=bb&noticeType=bb&text=true&cdn=1&pcookie&gtm=1' crossorigin></script>
    <script src="https://www.oracle.com/assets/truste-oraclelib.js"></script>
    <!-- jQuery UI Tabs -->
    <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.js"></script>


  <body class="preload">

    <div  class="wrapper wrapper--nofooter" >

      <header  class="header header--content" 
  role="banner">

  

  

    <nav class="menu">
      <div class="menu__row">
        <div>
          <a href="/gcn/">
            <img class="logo-mobile" src="/gcn/resources/img/gcn-logo-01.svg" alt="Graal Cloud Native logo">
          </a>
        </div>
        <div class="menu__container">
          <ul class="menu__list">
            <li class="menu__item">
              <a href="/gcn/about/" class="menu__link">About</a>
            </li>
            <li class="menu__item">
              <a href="/gcn/get-started/" class="menu__link">Get Started</a>
            </li>
            <!-- <li class="menu__item">
              <a href="/gcn/modules/" class="menu__link">Modules</a>
            </li>
            <li class="menu__item">
              <a href="/gcn/guides/" class="menu__link">Guides</a>
            </li>
            <li class="menu__item">
              <a href="/gcn/hands-on-labs/" class="menu__link">Hands-On Labs</a>
            </li>
            <li class="menu__item">
              <a href="/gcn/vscode-tools/" class="menu__link">Tools</a>
            </li> -->
            <!-- <li class="menu__launch__mobile">
              <a href="/gcn/launcher/" class="btn-launch btn btn-primary" target="blank">Create App</a>
            </li> -->
            <li class="menu__item">
              <div class="stack-container">
                <a href="#" class="menu__link stack__header">Docs</a>
                <div class="stack-menu-learn">
                  <div class="stack-row">
                    <div class="stack-column">
                      <div class="stack__item">
                        <img src='/gcn/resources/img/header-navigation/modules.svg'>
                        <a href="/gcn/modules/" class="item-line">Modules</a>
                      </div>
                      <div class="stack__item">
                        <img src='/gcn/resources/img/header-navigation/guides.svg'>
                        <a href="/gcn/guides/" class="item-line">Guides</a>
                      </div>
                      <div class="stack__item">
                        <img src='/gcn/resources/img/header-navigation/labs.svg'>
                        <a href="/gcn/hands-on-labs/" class="item-line">Hands-On Labs</a>
                      </div>
                      <div class="stack__item">
                        <img src='/gcn/resources/img/header-navigation/tools.svg'>
                        <a href="/gcn/vscode-tools/" class="item-line">Tools</a>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </li>
            <li class="menu__item">
              <div class="stack-container">
                <a href="#" class="menu__link stack__header">Graal Projects</a>
                <div class="stack-menu">
                  <div class="stack-row">
                    <div class="stack-column">
                      <div class="stack__item">
                        <img src='/gcn/resources/img/header-navigation/graalstack.svg'>
                        <a href="https://graal.cloud/" class="item-line">Graal</a>
                      </div>
                      <div class="stack__item">
                        <img src='/gcn/resources/img/header-navigation/graalvm.svg'>
                        <a href="https://graalvm.org/" class="item-line">GraalVM</a>
                      </div>
                      <div class="stack__item">
                        <img src='/gcn/resources/img/header-navigation/graalos.svg'>
                        <a href="https://graal.cloud/graalos/" class="item-line">GraalOS</a>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </li>
            <li class="menu__launch__mobile">
              <a href="/gcn/launcher/" class="btn-launch btn btn-primary" target="blank">Create App</a>
            </li>
          </ul>
        </div>
        <div class="menu__launch">
          <a href="/gcn/launcher/" class="btn-launch btn btn-primary" target="blank">Create App</a>
        </div>
      </div>

      <div role="button" class="menu-btn menu-btn--menu js-show-menu" tabindex="-1" title="sweet hamburger">
        <div class="hamburger">
          <div class="inner"></div>
        </div>
      </div>
      <button aria-label="hamburger mobile menu" class="btn btn-mobile-menu js-show-menu">
        <div class="inner"></div>
      </button>
    </nav>

  
</header>

<!-- <header  class="header header--content" >

  

  

    <nav class="menu">
      <div class="menu__row">
        <div>
          <a href="/gcn/graal">
            <img class="logo-mobile" src="/gcn/resources/img/gcn-logo-01.svg" alt="Graal Cloud Native logo">
          </a>
        </div>
        <div class="menu__container">
          <ul class="menu__list">
            <li class="menu__item">
              <a href="/gcn/graal/#whatisgraal" class="menu__link">About</a>
            </li>
            <li class="menu__item">
              <a href="https://graalvm.org" class="menu__link">GraalVM</a>
            </li>
            <li class="menu__item">
              <a href="https://graalvm.org" class="menu__link">GraalVM</a>
            </li>
            <li class="menu__item">
              <a href="https://graalvm.org" class="menu__link">GraalVM</a>
            </li>
          </ul>
        </div>
      </div>

      <div role="button" class="menu-btn menu-btn--menu js-show-menu" tabindex="-1" title="sweet hamburger">
        <div class="hamburger">
          <div class="inner"></div>
        </div>
      </div>
      <button aria-label="hamburger mobile menu" class="btn btn-mobile-menu js-show-menu">
        <div class="inner"></div>
      </button>
    </nav>

  
</header> -->

      <main  class="content"   aria-label="Content">
        <div class="wrapper wrapper-content">
  <article>
  <div class="row d-flex flex-wrap">
    <div class="col-sm-3 docsimpro col-bg">
      <div class="sidebar-wrap">
        <div class="sidebar">
          <div class="menuabout">
            <img id="sidebarClose" src="/gcn/resources/img/arrow_sidebar(close).svg" alt="Expand or collapse sidebar"
              class="btn-color no-display">
            <img id="sidebarOpen" src="/gcn/resources/img/arrow_sidebar.svg" alt="Expand or collapse sidebar">
          </div>
          
<div class="toc-floating">


<div class="toc-bullets">


  

  

  

  

  

  

  

  

  

  

  

  

  

  
    

    
      
        
          <li class="toc-bullets-main">
        
          
          <a href="/gcn/docs/gcn-modules/database/" class="_icon-book">
            Database
          </a>
        </li>

        
        

        
        
          
          <li class="toc-bullets-sub toc-bullets-highlight">
          
            
            <a href="/gcn/gcn-modules/database/micronaut-mysql-database-oci-expert/">
              Expert&#39;s Guide to Create and Connect a Micronaut Application to the Oracle Cloud Infrastructure MySQL HeatWave Service
            </a>
          </li>

          
            <div>
  <script>
    var scriptElement = document.currentScript;
    var div = $(scriptElement.parentElement);
    $(window).on("load", function () {
      $("#content-wrapper h2").each(function () {
        var li = $("<li></li>", { class: "toc-bullets-sub toc-bullets-sub-3" });
        var a = $("<a></a>", { href: "#" + $(this).attr("id") });
        a.text($(this).text().replace('#', ''));
        li.append(a);
        li.click(function (e) {
          e.preventDefault();
          var target = $(a.attr('href'));
          var scrollTo = target.offset().top - 80; // 80 - indent
          $('html, body').animate({ scrollTop: scrollTo }, 1000);
        });
        div.append(li);
      });
    });
  </script>
</div>
          
        
      
    
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

<!-- <li class="search additional-search">
  <form class="form-inline sidebar" action="/docs/search" autocomplete="on" method="get">
    <input class="input-search sidebar" type="text" id="search-box" name="query" placeholder="Search">
    <button type="submit sidebar" class="search-button"></button>
  </form>
</li> -->

</div>
  <!-- Search form -->
  <!-- <form class="search-container" action="/docs/search" autocomplete="on" method="get">
   <label for="search-box">Search</label>
    <input type="text" id="search-box" name="query">
    <button type="submit" class="searchbttn"></button>
  </form> -->
</div>

        </div>
      </div>
    </div>

    <div class="col-sm-9 docsmod">
      <div id="content-wrapper" class="docs-content docs-content--with-sidebar">
        <h1 id="experts-guide-to-create-and-connect-a-micronaut-application-to-the-oracle-cloud-infrastructure-mysql-heatwave-service">
        
        
          Expert’s Guide to Create and Connect a Micronaut Application to the Oracle Cloud Infrastructure MySQL HeatWave Service
        
        
      </h1>

<p>This guide describes how to use GCN to create a Micronaut database application. The application presents REST endpoints and stores data in an Oracle Cloud Infrastructure MySQL database using Micronaut Data.</p>

<blockquote>
  <p>Note: The guide assumes that the reader is familiar with using the Oracle Cloud Infrastructure Command Line Interface (CLI).</p>
</blockquote>

<p><a href="https://docs.oracle.com/iaas/mysql-database/index.html" target="_blank">MySQL HeatWave</a> is a fully-managed Oracle Cloud Infrastructure database service developed and supported by the MySQL team in Oracle.</p>

<p><a href="https://micronaut-projects.github.io/micronaut-data/latest/guide/" target="_blank">Micronaut Data</a> is a database access toolkit that uses ahead-of-time compilation to pre-compute queries for repository interfaces that are then executed by a thin, lightweight runtime layer. Micronaut Data supports the following backends: JPA (Hibernate) and Hibernate Reactive; SQL (JDBC, R2DBC); and MongoDB.</p>
    
      <h3 id="prerequisites">
        
        
          Prerequisites <a href="#prerequisites" class="anchor_heading">#</a>
        
        
      </h3>

<ul>
  <li>JDK 17 or higher. See <a href="/gcn/get-started/setting-up-desktop/">Setting up Your Desktop</a>.</li>
  <li>An Oracle Cloud Infrastructure account. See <a href="/gcn/get-started/setting-up-cloud-accounts/">Setting up Your Cloud Accounts</a>.</li>
  <li>The Oracle Cloud Infrastructure <a href="https://docs.cloud.oracle.com/iaas/Content/API/SDKDocs/cliinstall.htm">CLI</a> installed with <a href="https://docs.oracle.com/iaas/Content/API/SDKDocs/cliinstall.htm#configfile">local access configured</a>.</li>
  <li>An Oracle Cloud Infrastructure <a href="https://docs.oracle.com/iaas/Content/GSG/Tasks/choosingcompartments.htm">compartment</a>. Ensure appropriate permission is granted to your user account to manage Oracle MySQL HeatWave, Compute instances, and Virtual Cloud Networks in the compartment.</li>
  <li>A Virtual Cloud Network (VCN) in Oracle Cloud Infrastructure with a single regional public subnet, for use by Compute and MySQL HeatWave.</li>
  <li>A Docker-API compatible container runtime such as <a href="https://docs.rancherdesktop.io/getting-started/installation/">Rancher Desktop</a> or <a href="https://www.docker.io/gettingstarted/">Docker</a> to build a GraalVM Native Executable.</li>
  <li>The GCN CLI. See <a href="/gcn/get-started/setting-up-desktop/">Setting up Your Desktop</a>. (Optional.)</li>
</ul>

<p>Follow the steps below to create the application from scratch. However, you can also download the completed example:</p>

<div id="tabs-doc1">
    <ul>
        <li class="tabs-gradle"><a name="gradle" href="#gradle">Gradle</a></li>
        <li class="tabs-maven"><a name="maven" href="#maven">Maven</a></li>
    </ul>
    <div id="gradle">
        <p><a href="/gcn/docs/gcn-modules/database/archives/oci-db-demo-java-gradle.zip">Gradle Oracle Cloud Infrastructure MySQL Database Example <img class="download-img-guides" src="/gcn/resources/img/gcn_modules/download-archive.png" alt="Download completed example" /></a>
        </p>
    </div>
    <div id="maven">
        <p><a href="/gcn/docs/gcn-modules/database/archives/oci-db-demo-java-maven.zip">Maven Oracle Cloud Infrastructure MySQL Database Example <img class="download-img-guides" src="/gcn/resources/img/gcn_modules/download-archive.png" alt="Download completed example" /></a>
        </p>
    </div>
</div>
    
      <h4 id="a-note-regarding-your-development-environment">
        
        
          A note regarding your development environment
        
        
      </h4>

<p>Consider using Visual Studio Code that provides native support for developing applications with the <a href="/gcn/vscode-tools/using-gcn-vscode-tools/">Graal Cloud Native Tools extension</a>.</p>

<blockquote>
  <p>Note: If you use IntelliJ IDEA, <a href="/gcn/resources/img/annotationprocessorsintellij.png">enable annotation processing</a>.</p>
</blockquote>
    
      <h2 id="1-create-the-application">
        
        
          1. Create the Application <a href="#1-create-the-application" class="anchor_heading">#</a>
        
        
      </h2>

<p>Create an application using the GCN Launcher.</p>

<ol>
  <li>
    <p>Open the <a href="/gcn/launcher/?advanced=true">GCN Launcher in advanced mode</a>.</p>
  </li>
  <li>Create a new project using the following selections.
    <ul>
      <li><strong>Project Type</strong>: <em>Application</em> (Default)</li>
      <li><strong>Project name</strong>: <em>oci-db-demo</em></li>
      <li><strong>Base Package</strong>: <em>com.example</em> (Default)</li>
      <li><strong>Clouds</strong>: <em>OCI</em></li>
      <li><strong>Language</strong>: <em>Java</em> (Default)</li>
      <li><strong>Build Tool</strong>: <em>Gradle (Groovy)</em> or <em>Maven</em></li>
      <li><strong>Test Framework</strong>: <em>JUnit</em> (Default)</li>
      <li><strong>Java Version</strong>: <em>17</em> (Default)</li>
      <li><strong>Micronaut Version</strong>: (Default)</li>
      <li><strong>Features</strong>: <em>GraalVM Native Image</em> and <em>MySQL</em></li>
      <li><strong>Sample Code</strong>: <em>Yes</em> (Default)</li>
    </ul>
  </li>
  <li>
    <p>Switch to the <strong>Cloud Services</strong> tab and make sure the <strong>Database</strong> service is selected. Uncheck the other services. The Database GCN service bundles all necessary features for a Micronaut database application: <strong>Oracle Database Server</strong>, <strong>Micronaut Data JDBC</strong>, <strong>Hikari JDBC Connection Pool</strong>, <strong>Flyway Database Migration</strong>, etc.</p>
  </li>
  <li>
    <p>Switch to <strong>Selected</strong> tab to verify the selection. You should see <strong>Database</strong> and the <strong>GraalVM Native Image</strong> packaging feature (selected by default) selected.</p>
  </li>
  <li>Click <strong>Generate Project</strong>. GCN Launcher creates a Java project with the default package <code>com.example</code> in a directory named <em>oci-db-demo</em>. The application ZIP file will be downloaded in your default downloads directory. Unzip it, open in your code editor, and proceed to the next steps.</li>
</ol>

<p>Alternatively, use the <a href="/gcn/get-started/using-gcn-cli/">GCN CLI</a> as follows:</p>

<div id="tabs-doc2">
  <ul>
    <li class="tabs-gradle"><a href="#gradle">Gradle</a></li>
    <li class="tabs-maven"><a href="#maven">Maven</a></li>
  </ul>
  <div id="gradle">
    <pre><code class="language-bash">gcn create-app com.example.oci-db-demo \
    --clouds=oci \
    --services=database \
    --features=graalvm,mysql \
    --build=gradle \
    --lang=java</code></pre>
  </div>
  <div id="maven">
    <pre><code class="language-bash">gcn create-app com.example.oci-db-demo \
    --clouds=oci \
    --services=database \
    --features=graalvm,mysql \
    --build=maven \
    --lang=java</code></pre>
  </div>
</div>

<p>Open the <em>micronaut-cli.yml</em> file, you can see what features are packaged with the application:</p>

<pre><code class="language-yml">features: [app-name, data, data-jdbc, flyway, gcn-bom, gcn-license, gcn-oci-cloud-app, gcn-oci-database, graalvm, http-client-test, java, java-application, jdbc-hikari, junit, logback, maven, maven-enforcer-plugin, micronaut-aot, mysql, netty-server, properties, readme, serialization-jackson, shade, test-resources, validation]
</code></pre>

<p>The GCN Launcher creates a multi-module project with two subprojects: <strong>oci</strong> for Oracle Cloud Infrastructure, and <strong>lib</strong> for common code and configuration shared across cloud platforms.
You develop the application logic in the <strong>lib</strong> subproject, and keep the Oracle Cloud Infrastructure-specific configurations in the <strong>oci</strong> subproject.
If you enable sample code generation, the GCN Launcher creates the main controller, repository interface, entity, service classes, and tests for you.
Consider checking <a href="/gcn/gcn-modules/database/micronaut-data-jdbc-repository/">this guide</a> where each sample class is closely examined.</p>
    
      <h3 id="11-configure-datasources">
        
        
          1.1. Configure Datasources <a href="#11-configure-datasources" class="anchor_heading">#</a>
        
        
      </h3>

<p>The GCN launcher defined default datasources in the <em>oci/src/main/resources/application-oraclecloud.properties</em> file.
The GCN launcher also included and enabled <a href="http://www.flywaydb.org" target="_blank">Flyway</a> to perform migrations on the default datasources.
It uses the <a href="https://micronaut-projects.github.io/micronaut-flyway/latest/guide/" target="_blank">Micronaut integration with Flyway</a> to automate schema changes and significantly simplify schema management tasks, such as migrating, rolling back, and reproducing in multiple environments:</p>
<pre><code>flyway.datasources.default.enabled=true
</code></pre>

<blockquote>
  <p>Note: Flyway migrations are not compatible with the default automatic schema generation. So, in the <em>oci/src/main/resources/application-oraclecloud.properties</em> file, either delete the <code>datasources.default.schema-generate=CREATE_DROP</code> line or change that line to <code>datasources.default.schema-generate=NONE</code> to ensure that only Flyway manages your schema:</p>
</blockquote>

<p>Flyway migration is automatically triggered before your application starts. Flyway reads migration file(s) in the <em>lib/src/main/resources/db/migration/</em> directory. The migration file with the database schema, <em>lib/src/main/resources/db/migration/V1__schema.sql</em>, was also created for you by the GCN Launcher.</p>

<pre><code class="language-sql">DROP TABLE IF EXISTS genre;

CREATE TABLE genre (
   id    BIGINT NOT NULL AUTO_INCREMENT PRIMARY KEY,
   name  VARCHAR(255) NOT NULL UNIQUE
);
</code></pre>

<p>During application startup, Flyway runs the commands in the SQL file and creates the schema needed for the application.</p>
    
      <h2 id="2-create-an-oracle-mysql-db-system">
        
        
          2. Create an Oracle MySQL DB System <a href="#2-create-an-oracle-mysql-db-system" class="anchor_heading">#</a>
        
        
      </h2>

<p>You will create your Oracle <a href="https://docs.oracle.com/iaas/mysql-database/doc/db-system.html" target="_blank">MySQL DB System</a> using the Oracle Cloud Infrastructure CLI. See the <a href="https://docs.oracle.com/iaas/tools/oci-cli/latest/oci_cli_docs/cmdref/mysql.html" target="_blank">MySQL Database Service CLI reference</a> for more information.</p>

<p>According to the documentation, the <a href="https://docs.oracle.com/iaas/tools/oci-cli/latest/oci_cli_docs/cmdref/mysql/db-system/create.html" target="_blank"><code>create</code></a> command requires three parameters: compartment OCID, shape name, and subnet OCID. However, to reduce the number of commands, three more parameters are needed: the DB system configuration OCID, the availability domain, the database initial size, admin username, and password.</p>
    
      <h3 id="21-compartment-ocid">
        
        
          2.1. Compartment OCID <a href="#21-compartment-ocid" class="anchor_heading">#</a>
        
        
      </h3>

<p>Find the <a href="https://docs.oracle.com/iaas/tools/oci-cli/latest/oci_cli_docs/cmdref/iam/compartment/list.html" target="_blank">OCID of the compartment</a> where you will deploy the MySQL DB System. It is expected that you have already created a compartment in Oracle Cloud Infrastructure (see the <a href="#prerequisites">Prerequisites</a>).</p>

<p>Run the following command to list all the compartments in the root:</p>
<pre><code class="language-bash">oci iam compartment list
</code></pre>

<p>Find the required compartment by its name or description in the JSON output. It should look like this:</p>
<pre><code class="language-json">{
  "compartment-id": "ocid1.tenancy.oc1..aaaaaaaaud4g4e5ovjaw...",
  "defined-tags": {},
  "description": "Your Compartment Name",
  "freeform-tags": {},
  "id": "ocid1.compartment.oc1..aaaaaaaarkh3s2wcxbbm...",
  "inactive-status": null,
  "is-accessible": null,
  "lifecycle-state": "ACTIVE",
  "name": "compartment-name",
  "time-created": "2021-05-02T23:54:28.392000+00:00"
}
</code></pre>

<p>The OCID is the value of the <code>id</code> property; the <code>compartment-id</code> property is the parent compartment.</p>

<details>
<summary>For convenience, save the compartment OCID as an environment variable. Expand to see more.</summary>
<p>For Linux or Mac, run the following command:</p>
<pre><code class="lang-bash">export C=ocid1.compartment.oc1.aaaaaaaarkh3s2wcxbbm...
</code></pre>
<p>For Windows, if using <code>cmd</code>, run:</p>
<pre><code class="lang-shell">set C=ocid1.compartment.oc1.aaaaaaaarkh3s2wcxbbm...
</code></pre>
<p>For Windows, if using PowerShell run:</p>
<pre><code class="lang-shell">$C = "ocid1.compartment.oc1.aaaaaaaarkh3s2wcxbbm..."
</code></pre>
</details>

<p>In the examples below we use the Linux/macOS syntax for environment variables (for example, <code>-c $C</code>). If you use Windows <code>cmd</code>, change those to <code>-c %C%</code> (but no change needed if using PowerShell).</p>
    
      <h3 id="22-database-shape-name">
        
        
          2.2. Database Shape Name <a href="#22-database-shape-name" class="anchor_heading">#</a>
        
        
      </h3>

<p>Find the <a href="https://docs.oracle.com/iaas/tools/oci-cli/latest/oci_cli_docs/cmdref/mysql/shape/list.html" target="_blank">shape name</a> for the MySQL DB System. Run this command to list the available shapes in your compartment:</p>
<pre><code class="language-bash">oci mysql shape list -c $C
</code></pre>

<p>Use the smallest size and shape (8 GB, 1 CPU):</p>

<pre><code class="language-json">{
  "cpu-core-count": 1,
  "is-supported-for": [
    "DBSYSTEM"
  ],
  "memory-size-in-gbs": 8,
  "name": "MySQL.VM.Standard.E3.1.8GB"
}
</code></pre>
    
      <h3 id="23-database-system-configuration-ocid">
        
        
          2.3. Database System Configuration OCID <a href="#23-database-system-configuration-ocid" class="anchor_heading">#</a>
        
        
      </h3>

<p>Find the <a href="https://docs.oracle.com/iaas/tools/oci-cli/latest/oci_cli_docs/cmdref/mysql/configuration/list.html" target="_blank">OCID of the configuration</a> for the MySQL DB System. Run this command to list the available configurations in your compartment:</p>
<pre><code class="language-bash">oci mysql configuration list -c $C
</code></pre>

<p>Use the <code>id</code> of the smallest configuration:</p>
<pre><code class="language-json">{
  "compartment-id": null,
  "defined-tags": null,
  "description": "Default Standalone configuration for the MySQL.VM.Standard.E3.1.8GB MySQL Shape",
  "display-name": "MySQL.VM.Standard.E3.1.8GB.Standalone",
  "freeform-tags": null,
  "id": "ocid1.mysqlconfiguration.oc1..aaaaaaaalwzc2a22xqm5...",
  "lifecycle-state": "ACTIVE",
  "shape-name": "MySQL.VM.Standard.E3.1.8GB",
  "time-created": "2018-09-21T10:00:00+00:00",
  "time-updated": null,
  "type": "DEFAULT"
}
</code></pre>
    
      <h3 id="24-subnet-ocid">
        
        
          2.4. Subnet OCID <a href="#24-subnet-ocid" class="anchor_heading">#</a>
        
        
      </h3>

<p>To find the subnet OCID, first find the <a href="https://docs.oracle.com/iaas/tools/oci-cli/latest/oci_cli_docs/cmdref/network/vcn/list.html" target="_blank">OCID of the VCN</a>. It is expected that you have already created a Virtual Cloud Network (VCN) in Oracle Cloud Infrastructure with a single regional <strong>public</strong> subnet (see the <a href="#prerequisites">Prerequisites</a>).</p>

<p>Run this command to list the available VCNs in your compartment:</p>
<pre><code class="language-bash">oci network vcn list -c $C
</code></pre>

<p>Use the <code>id</code> of the required VCN:</p>
<pre><code class="language-json">{
  "cidr-block": "10.0.0.0/16",
  "cidr-blocks": [
    "10.0.0.0/16"
  ],
  "compartment-id": "ocid1.compartment.oc1.aaaaaaaarkh3s2wcxbbm...",
  "default-dhcp-options-id": "ocid1.dhcpoptions.oc1.iad.aaaaaaaahosh4fpep4jz...",
  "default-route-table-id": "ocid1.routetable.oc1.iad.aaaaaaaaet7wmwm27vzc...",
  "default-security-list-id": "ocid1.securitylist.oc1.iad.aaaaaaaadlkscc7uktdd...",
  "defined-tags": {},
  "display-name": "vcn-20210504-1214",
  "dns-label": "vcn05041217",
  "freeform-tags": {},
  "id": "ocid1.vcn.oc1.iad.amaaaaaabnqp5kqam6cm...",
  "ipv6-cidr-blocks": null,
  "lifecycle-state": "AVAILABLE",
  "time-created": "2021-05-04T16:17:08.461000+00:00",
  "vcn-domain-name": "vcn05041217.oraclevcn.com"
}
</code></pre>

<p>Then use the VCN OCID to find the <a href="https://docs.oracle.com/iaas/tools/oci-cli/latest/oci_cli_docs/cmdref/network/subnet/list.html" target="_blank">OCID of the subnet</a>. Run this command to list the subnets in your VCN:</p>

<pre><code class="language-bash">oci network subnet list -c $C \
    --vcn-id ocid1.vcn.oc1.iad.amaaaaaabnqp5kqam6cm...
</code></pre>

<p>Use the <code>id</code> of the required subnet:</p>
<pre><code class="language-json">{
  ...
  "cidr-block": "10.0.0.0/24",
  "compartment-id": "ocid1.compartment.oc1..aaaaaaaarkh3s2wcxbbm...",
  "display-name": "subnet-20210504-1214",
  "id": "ocid1.subnet.oc1.iad.aaaaaaaaxgumfzpn6sul...",
  "time-created": "2021-05-04T16:17:10.593000+00:00",
  "vcn-id": "ocid1.vcn.oc1.iad.amaaaaaabnqp5kqam6cm...",
  ...
  "security-list-ids": [
    "ocid1.securitylist.oc1.iad.aaaaaaaadlkscc7uktdd..."
  ],
  ...
}
</code></pre>
<p>Save the OCID of the subnet in the response—you will need it in a later step.</p>
    
      <h3 id="25-availability-domain">
        
        
          2.5. Availability Domain <a href="#25-availability-domain" class="anchor_heading">#</a>
        
        
      </h3>

<p>Find the <a href="https://docs.oracle.com/iaas/tools/oci-cli/latest/oci_cli_docs/cmdref/iam/availability-domain/list.html" target="_blank">availability domain</a> where the MySQL DB System will be created. Run this command to list the availability domains in your compartment:</p>
<pre><code class="language-bash">oci iam availability-domain list -c $C
</code></pre>

<p>Use the <code>name</code> of the availability domain you want:</p>
<pre><code class="language-json">{
  "compartment-id": "ocid1.compartment.oc1..aaaaaaaarkh3s2wcxbbm...",
  "id": "ocid1.availabilitydomain.oc1..aaaaaaaauvt2n7pijol7...",
  "name": "nFuS:US-ASHBURN-AD-1"
}
</code></pre>
    
      <h3 id="26-create-a-mysql-db-system">
        
        
          2.6. Create a MySQL DB System <a href="#26-create-a-mysql-db-system" class="anchor_heading">#</a>
        
        
      </h3>

<p>The last required parameters are the admin username and password.</p>

<blockquote>
  <p>Note: The username must be 1-32 characters, and it must not contain <code>'</code>, <code>`</code>, <code>"</code>, or any of the following reserved names: <code>ocirpl</code>, <code>ociadmin</code>, <code>administrator</code>, <code>mysql.sys</code>, <code>mysql.session</code>, or <code>mysql.infoschema</code>. The password must be 8-32 characters and contain at least one uppercase, one lowercase, one numeric, and one special character.</p>
</blockquote>

<p>Additionally, specify the display name (because the generated name will be something like <code>mysqldbsystem20220203163902</code>). Choose a name such as “GCN_Guide_MySQL”.
Also specify the initial database size; it must be at least 50 GB.</p>

<p>Run the <code>create</code> command with your OCIDs and other parameters substituted:</p>

<pre><code class="language-bash">oci mysql db-system create -c $C \
    --shape-name MySQL.VM.Standard.E3.1.8GB \
    --configuration-id ocid1.mysqlconfiguration.oc1..aaaaaaaalwzc2a22xqm5... \
    --subnet-id ocid1.subnet.oc1.iad.aaaaaaaaxgumfzpn6sul... \
    --admin-username &lt;your username&gt; \
    --admin-password &lt;your password&gt; \
    --availability-domain nFuS:US-ASHBURN-AD-1 \
    --data-storage-size-in-gbs 50 \
    --display-name GCN_Guide_MySQL
</code></pre>

<p>The response should look like this:</p>
<pre><code class="language-json">{
  "data": {
    "analytics-cluster": null,
    "availability-domain": "nFuS:US-ASHBURN-AD-1",
    "backup-policy": {
      "defined-tags": null,
      "freeform-tags": null,
      "is-enabled": true,
      "retention-in-days": 7,
      "window-start-time": "07:11"
    },
    "channels": [],
    "compartment-id": "ocid1.compartment.oc1..aaaaaaaarkh3s2wcxbbm...",
    "configuration-id": "ocid1.mysqlconfiguration.oc1..aaaaaaaalwzc2a22xqm5...",
    "current-placement": {
      "availability-domain": null,
      "fault-domain": null
    },
    "data-storage-size-in-gbs": 50,
    "defined-tags": {},
    "description": null,
    "display-name": "GCN_Guide_MySQL",
    "endpoints": [],
    "fault-domain": null,
    "freeform-tags": {},
    "heat-wave-cluster": null,
    "hostname-label": null,
    "id": "ocid1.mysqldbsystem.oc1.iad.aaaaaaaa2pq3a37hftut...",
    "ip-address": null,
    "is-analytics-cluster-attached": false,
    "is-heat-wave-cluster-attached": false,
    "is-highly-available": false,
    "lifecycle-details": null,
    "lifecycle-state": "CREATING",
    "maintenance": {
      "window-start-time": "WEDNESDAY 07:09"
    },
    "mysql-version": null,
    "port": null,
    "port-x": null,
    "shape-name": "MySQL.VM.Standard.E3.1.8GB",
    "source": null,
    "subnet-id": "ocid1.subnet.oc1.iad.aaaaaaaaxgumfzpn6sul...",
    "time-created": "2022-02-03T16:39:02.762000+00:00",
    "time-updated": "2022-02-03T16:39:02.762000+00:00"
  },
  "etag": "0dea57803672c12742f7710f342bf...",
  "opc-work-request-id": "ocid1.mysqlworkrequest.oc1.iad.eb66e373-7274-40a..."
}
</code></pre>

<p>Note that the value for <code>lifecycle-state</code> is <code>CREATING</code>, so not all information is available at this stage (for example, IP address).
Save the database OCID from the <code>id</code> property in the response.</p>
    
      <h3 id="27-retrieve-information-describing-the-mysql-db-system">
        
        
          2.7. Retrieve Information Describing the MySQL DB System <a href="#27-retrieve-information-describing-the-mysql-db-system" class="anchor_heading">#</a>
        
        
      </h3>

<p>Wait for the MySQL DB System to be provisioned, then run the <a href="https://docs.oracle.com/iaas/tools/oci-cli/latest/oci_cli_docs/cmdref/mysql/db-system/get.html" target="_blank">get</a> command with the OCID  of the MySQL DB System as the argument to the <code>--db-system-id</code> option:</p>

<pre><code class="language-bash">oci mysql db-system get \
    --db-system-id ocid1.mysqldbsystem.oc1.iad.aaaaaaaa2pq3a37hftut...
</code></pre>

<p>When the <code>lifecycle-state</code> is <code>ACTIVE</code>, make note of <code>ip-address</code> and <code>port</code> (the latter should default to 3306):</p>

<pre><code class="language-json">"ip-address": "10.0.0.6",
"lifecycle-state": "ACTIVE",
"port": 3306,
"port-x": 33060
</code></pre>
    
      <h3 id="28-create-an-ingress-rule">
        
        
          2.8. Create an Ingress Rule <a href="#28-create-an-ingress-rule" class="anchor_heading">#</a>
        
        
      </h3>

<p>To allow your application to connect to the MySQL DB System, <a href="https://docs.oracle.com/iaas/tools/oci-cli/latest/oci_cli_docs/cmdref/network/security-list/update.html" target="_blank">create an ingress rule</a> for port 3306 in the subnet.</p>

<p>Use the OCID of the security list you will update (that you saved earlier when finding the subnet OCID) to retrieve the current state:</p>

<pre><code class="language-bash">oci network security-list get --security-list-id ocid1.securitylist.oc1.iad.aaaaaaaadlkscc7uktdd...
</code></pre>

<p>The output should look like this:</p>
<pre><code class="language-json">...
"id": "ocid1.securitylist.oc1.iad.aaaaaaaadlkscc7uktdd...",
"ingress-security-rules": [
  {
    "description": null,
    "icmp-options": null,
    "is-stateless": false,
    "protocol": "6",
    "source": "0.0.0.0/0",
    "source-type": "CIDR_BLOCK",
    "tcp-options": {
      "destination-port-range": {
        "max": 22,
        "min": 22
      },
      "source-port-range": null
    },
    "udp-options": null
  },
  ...
],
"lifecycle-state": "AVAILABLE",
...
</code></pre>

<p>The <code>update</code> command replaces the existing rules with the those specified in the command, so the command must include the existing rules and a new one for port 3306.</p>

<p>Use a text editor to save the JSON list value of <code>ingress-security-rules</code> to a file, for example <em>ingress.json</em>.
Add a new object to the JSON list for the ingress rule on port 3306:</p>

<pre><code class="language-json">{
  "description": "MySQL",
  "isStateless": false,
  "protocol": "6",
  "source": "10.0.0.0/16",
  "sourceType": "CIDR_BLOCK",
  "tcpOptions": {
    "destination-port-range": {
      "max": 3306,
      "min": 3306
    }
  }
}
</code></pre>

<p>The final contents of <em>ingress.json</em> should look like this (it will have different rules, but will likely include one for SSH on port 22 and ICMP):</p>

<pre><code class="language-json">[
  {
    "description": null,
    "icmp-options": null,
    "is-stateless": false,
    "protocol": "6",
    "source": "0.0.0.0/0",
    "source-type": "CIDR_BLOCK",
    "tcp-options": {
      "destination-port-range": {
        "max": 22,
        "min": 22
      },
      "source-port-range": null
    },
    "udp-options": null
  },
  {
    "description": null,
    "icmp-options": {
      "code": 4,
      "type": 3
    },
    "is-stateless": false,
    "protocol": "1",
    "source": "0.0.0.0/0",
    "source-type": "CIDR_BLOCK",
    "tcp-options": null,
    "udp-options": null
  },

  ...

  {
    "description": "MySQL",
    "isStateless": false,
    "protocol": "6",
    "source": "10.0.0.0/16",
    "sourceType": "CIDR_BLOCK",
    "tcpOptions": {
      "destination-port-range": {
        "max": 3306,
        "min": 3306
      }
    }
  }
]
</code></pre>

<p>Run this command to add a new ingress rule:</p>

<pre><code class="language-bash">oci network security-list update \
    --security-list-id ocid1.securitylist.oc1.iad.aaaaaaaadlkscc7uktdd... \
    --ingress-security-rules file://ingress.json
</code></pre>
    
      <h2 id="3-create-a-compute-instance">
        
        
          3. Create a Compute Instance <a href="#3-create-a-compute-instance" class="anchor_heading">#</a>
        
        
      </h2>

<p>There is no direct way to externally <a href="https://docs.oracle.com/iaas/mysql-database/doc/connecting-db-system.html" target="_blank">connect to a MySQL database</a>, so you need to create a Compute instance in Oracle Cloud Infrastructure to host your application.
Later, you will install a MySQL client on that Compute instance and connect your application to the MySQL DB System.</p>

<p>The Compute service comes as part of <strong>Always Free Eligible</strong> Oracle Cloud Infrastructure services (you do not need a paid account).</p>

<ol>
  <li>
    <p>In the Oracle Cloud console, open the navigation menu. Go to <strong>Compute</strong>, then <strong>Instances</strong>.</p>
  </li>
  <li>
    <p>Click <strong>Create instance</strong>. You are prompted to enter information to describe a new Compute instance. Enter the following information:</p>

    <p>a. <strong>Name</strong>: Enter “gcn-demo”.</p>

    <p>b. <strong>Create in compartment</strong>: Select the compartment from the compartment drop-down list, or use the default.</p>

    <p>c. <strong>Placement</strong>: Use the default.</p>

    <p>d. <strong>Image and shape</strong>: Use the default.</p>

    <p>e. <strong>Networking</strong>: Make sure to use the same subnet as the one where you created the MySQL database, otherwise the application will not be able to access the database. Your MySQL database private IP is used to connect the MySQL client.</p>

    <p>f. <strong>Add SSH keys</strong>: Select “Generate a key pair for me”, then click <strong>Save private key</strong> to save the private key locally in a file named <em>ssh-key-(date).key</em>.</p>

    <p>g. <strong>Boot Volume</strong>: Use the default.</p>
  </li>
  <li>Click <strong>Create</strong>.</li>
  <li>When the instance is active, take note of the <strong>Public IP address</strong> and <strong>Private IP address</strong> displayed in the <strong>Instance information</strong> tab (click <strong>Copy</strong>).</li>
  <li>Click <strong>Subnet</strong>, under “Primary VNIC” in the <strong>Instance Information</strong> tab.</li>
  <li>Click <strong>Default Security List ..</strong>, under <strong>Security Lists</strong>.</li>
  <li>
    <p>Click <strong>Add Ingress Rules</strong>, under <strong>Ingress Rules</strong>. Enter the following information:</p>

    <p>a. <strong>Source CIDR</strong>: Enter “0.0.0.0/0”</p>

    <p>b. <strong>Destination Port Range</strong>: Enter “8080”</p>

    <p>c. <strong>Description</strong>: Enter “micronaut”</p>
  </li>
  <li>
    <p>Click <strong>Add Ingress Rules</strong>.</p>
  </li>
  <li>Connect to your newly created Compute instance, using the instance’s <strong>Public IP address</strong>:
    <pre><code class="language-bash"> ssh -i /path/to/ssh-key-(date).key opc@&lt;COMPUTE_INSTANCE_PUBLIC_IP&gt;
</code></pre>
    <p>For more information, see <a href="https://docs.oracle.com/iaas/Content/GSG/Tasks/testingconnection.htm#connecting" target="_blank">Connecting to Your Linux Instance Using SSH</a>.</p>
  </li>
  <li>
    <p>Once connected, install Oracle GraalVM for JDK 17 (it will be required at a later step).</p>

    <p>On Oracle Linux 8 and 9, run these commands one by one:</p>
    <pre><code class="language-bash">sudo dnf update -y oraclelinux-release-el8
sudo dnf config-manager --set-enabled ol8_codeready_builder
sudo dnf install graalvm-17-native-image
</code></pre>
    <p>Confirm that the installed package size is correct by entering “yes” at the prompt.</p>

    <p>On Oracle Linux 7.9, run:</p>
    <pre><code class="language-bash">sudo yum -y install oracle-softwarecollection-release-el7
sudo yum install devtoolset-10
echo 'source scl_source enable devtoolset-10' &gt;&gt; ~/.bashrc
sudo yum install graalvm-17-native-image
</code></pre>
  </li>
  <li>Open up the firewall to port 8080:
    <pre><code class="language-bash">   sudo firewall-cmd --permanent --zone=public --add-port=8080/tcp
   sudo firewall-cmd --reload
</code></pre>
  </li>
</ol>

<p>Now you have a ready-to-go Compute instance with the Java runtime. For more information, see the <a href="https://docs.oracle.com/en/graalvm/jdk/17/docs/getting-started/oci/compute-instance/#oracle-graalvm-on-oci-compute-instances-with-oracle-linux" target="_blank">Oracle GraalVM on OCI Compute Instances with Oracle Linux</a> guide.</p>
    
      <h2 id="4-configure-a-mysql-database">
        
        
          4. Configure a MySQL Database <a href="#4-configure-a-mysql-database" class="anchor_heading">#</a>
        
        
      </h2>

<p>Now connect your application to the MySQL DB System.
Flyway will create the database tables the first time the application starts, but you must create the database and a database user first.</p>
    
      <h3 id="41-mysql-client">
        
        
          4.1. MySQL Client <a href="#41-mysql-client" class="anchor_heading">#</a>
        
        
      </h3>

<ol>
  <li>Install the MySQL client. From the terminal connected to your Compute instance, run:
    <pre><code class="language-bash"> sudo yum install mysql
</code></pre>
  </li>
  <li>Connect to the MySQL client with admin username and password you chose earlier, and your MySQL DB System private IP address:
    <pre><code class="language-bash"> mysql --host &lt;MySQL_PRIVATE_IP&gt; -u &lt;admin_username&gt; -p
</code></pre>
    <p>Where <code>&lt;MySQL_PRIVATE_IP&gt;</code> is the <strong>private IP address</strong> of your Oracle Cloud Infrastructure MySQL DB System.</p>
  </li>
</ol>

<p>Once connected, you are taken to the MySQL database command prompt.</p>
    
      <h3 id="42-create-a-database-and-user">
        
        
          4.2. Create a Database and User <a href="#42-create-a-database-and-user" class="anchor_heading">#</a>
        
        
      </h3>

<ol>
  <li>From the MySQL database command prompt, create the database (use any valid database name, for example, <code>gcnDB</code>):
    <pre><code class="language-sql"> CREATE DATABASE gcnDB;
</code></pre>
  </li>
  <li>Create a database user (use any valid MySQL username, for example, <code>guide_user</code>, and a valid password):
    <pre><code class="language-sql"> CREATE USER 'guide_user'@'&lt;COMPUTE_INSTANCE_PRIVATE_IP&gt;' IDENTIFIED BY '&lt;user password&gt;';
</code></pre>
    <p>Where <code>&lt;COMPUTE_INSTANCE_PRIVATE_IP&gt;</code> is the <strong>private IP address</strong> of your Compute instance as noted earlier.</p>
  </li>
  <li>Grant access to the database for the new user:
    <pre><code class="language-sql"> GRANT ALL ON gcnDB.* TO 'guide_user'@'&lt;COMPUTE_INSTANCE_PRIVATE_IP&gt;';
</code></pre>
  </li>
  <li>Exit the MySQL command prompt by entering “exit”.</li>
</ol>
    
      <h2 id="5-run-the-application">
        
        
          5. Run the Application <a href="#5-run-the-application" class="anchor_heading">#</a>
        
        
      </h2>

<p>With almost everything in place, you can compile and <strong>run the application from a JAR file</strong>.</p>

<ol>
  <li>
    <p>Create an executable JAR file that includes all dependencies:</p>

    <div id="tabs-doc3">
   <ul>
       <li class="tabs-gradle"><a href="#gradle">Gradle</a></li>
       <li class="tabs-maven"><a href="#maven">Maven</a></li>
   </ul>
   <div id="gradle">
       <pre><code class="language-bash">./gradlew :oci:shadowJar</code></pre>
   </div>
   <div id="maven">
       <pre><code class="language-bash">./mvnw install -pl lib -am
./mvnw package -pl oci -DskipTests</code></pre>
   </div>
 </div>
  </li>
  <li>
    <p>From a local terminal, copy the JAR file from your computer to the Compute instance using <code>scp</code>:</p>

    <div id="tabs-doc4">
   <ul>
       <li class="tabs-gradle"><a href="#gradle">Gradle</a></li>
       <li class="tabs-maven"><a href="#maven">Maven</a></li>
   </ul>
   <div id="gradle">
       <pre><code class="language-bash">scp -i /path/to/ssh-key-*.key path/to/oci-db-demo/oci/build/libs/oci-1.0-SNAPSHOT-all.jar opc@COMPUTE_INSTANCE_PUBLIC_IP:~/application.jar</code></pre>
   </div>
   <div id="maven">
       <pre><code class="language-bash">scp -i /path/to/ssh-key-*.key path/to/oci-db-demo/oci/target/oci-1.0-SNAPSHOT.jar opc@COMPUTE_INSTANCE_PUBLIC_IP:~/application.jar</code></pre>
   </div>
 </div>
  </li>
  <li>Once copied, connect to the Compute instance (if it has disconnected by now):
    <pre><code class="language-bash"> ssh -i /path/to/ssh-key-*.key opc@COMPUTE_INSTANCE_PUBLIC_IP
</code></pre>
  </li>
  <li>
    <p>Set values for the missing <code>datasources.default.url</code>, <code>datasources.default.username</code>, and <code>datasources.default.password</code> properties by exporting them as environment variables as follows:</p>

    <pre><code class="language-bash"> export DATASOURCES_DEFAULT_URL=jdbc:mysql://&lt;MYSQL_DB_SYSTEM_PRIVATE_IP&gt;:3306/&lt;db_name&gt; # 1
 export DATASOURCES_DEFAULT_USERNAME=&lt;username&gt; # 2
 export DATASOURCES_DEFAULT_PASSWORD=&lt;password&gt; # 3
</code></pre>
    <p><strong>1</strong> Set the value of the <code>datasources.default.url</code> property as the private IP address of MySQL DB System (<code>ip-address</code> from section <strong>2.7</strong>) combined with the name of the database, for example, <code>gcnDB</code>.</p>

    <p><strong>2</strong> Set the value of the <code>datasources.default.username</code> property as the username of the user you created, for example, <code>guide_user</code>.</p>

    <p><strong>3</strong> Set the value of the <code>datasources.default.password</code> property as the password of the user you created.</p>
  </li>
  <li>Start the application:
    <pre><code class="language-bash"> java -jar application.jar
</code></pre>
  </li>
  <li>From a local terminal, run this command to test creating and storing a new <code>Genre</code> in the database:
    <pre><code class="language-bash"> curl -X "POST" "http://[COMPUTE_INSTANCE_PUBLIC_IP]:8080/genres" \
      -H 'Content-Type: application/json; charset=utf-8' \
      -d $'{ "name": "music" }'
</code></pre>
    <p>Then list the genres:</p>
    <pre><code class="language-bash"> curl [COMPUTE_INSTANCE_PUBLIC_IP]:8080/genres/list
</code></pre>
  </li>
</ol>

<p>This server application presents REST endpoints and stores data in the Oracle MySQL database.
Next, you can package this application as a native executable. Deploying as a native executable does not require a JDK to run, so you can copy it to another Linux host and run easily.</p>
    
      <h2 id="6-package-with-graalvm-native-image">
        
        
          6. Package with GraalVM Native Image <a href="#6-package-with-graalvm-native-image" class="anchor_heading">#</a>
        
        
      </h2>

<p>GCN supports compiling Java applications ahead-of-time into native executables using <a href="https://www.graalvm.org/native-image/" target="_blank">GraalVM Native Image</a> and <a href="https://graalvm.github.io/native-build-tools/latest/index.html" target="_blank">Native Build Tools</a>. Packaged as a native executable, it significantly reduces the application startup time and memory footprint.</p>

<blockquote>
  <p><strong>Prerequisites</strong>: GraalVM Native Image is required to build native executables. <a href="https://www.graalvm.org/downloads/" target="_blank">Install GraalVM JDK with Native Image</a> if you have not done that yet.</p>
</blockquote>

<p>If you build a native executable locally, it will only run on your OS, but isn’t suitable for deployment to a Compute instance. To create deployable native executables, we’ll use a different packaging command that builds the executable inside a container, which we’ll extract from the container to deploy to the cloud.</p>

<ol>
  <li>
    <p>From a local terminal, generate a native executable by running the following command:</p>

    <div id="tabs-doc5">
   <ul>
     <li class="tabs-gradle"><a href="#gradle">Gradle</a></li>
     <li class="tabs-maven"><a href="#maven">Maven</a></li>
   </ul>
   <div id="gradle">
     <pre><code class="language-bash">./gradlew :oci:dockerBuildNative</code></pre>
   </div>
   <div id="maven">
     <pre><code class="language-bash">./mvnw install -pl lib -am
./mvnw package -pl oci -Dpackaging=docker-native</code></pre>
   </div>
 </div>

    <p>You can customize the name of the resulting binary by <a href="https://graalvm.github.io/native-build-tools/latest/" target="_blank">updating the Maven/Gradle plugin for GraalVM Native Image configuration</a>.</p>
  </li>
  <li>
    <p>Find the container image ID that you’ll use to extract the native executable from the container image you built by running:</p>

    <pre><code class="language-bash"> docker image ls
</code></pre>

    <p>The container images are listed chronologically with the most recent at the top, so your output will look like this:</p>

    <pre><code class="language-bash"> REPOSITORY   TAG      IMAGE ID       CREATED          SIZE
 oci          latest   41c8a902b2e7   32 seconds ago   100MB
</code></pre>
  </li>
  <li>
    <p>Extract the native executable by running these commands, replacing <code>&lt;image_id&gt;</code> with the container image ID, for example, <code>41c8a902b2e7</code>:</p>

    <pre><code class="language-bash"> docker create --name container_temp &lt;image_id&gt;
 docker cp container_temp:/app/application .
 docker rm container_temp
</code></pre>
  </li>
</ol>
    
      <h2 id="7-deploy-from-a-native-executable">
        
        
          7. Deploy from a Native Executable <a href="#7-deploy-from-a-native-executable" class="anchor_heading">#</a>
        
        
      </h2>

<ol>
  <li>
    <p>From a local terminal, copy the native executable from your computer to the Compute instance using <code>scp</code>:</p>

    <pre><code class="language-bash"> scp -i /path/to/ssh-key-*.key application opc@COMPUTE_INSTANCE_PUBLIC_IP:~/
</code></pre>
  </li>
  <li>Once copied, connect to the Compute instance (if it has disconnected by now):
    <pre><code class="language-bash"> ssh -i /path/to/ssh-key-*.key opc@COMPUTE_INSTANCE_PUBLIC_IP
</code></pre>
  </li>
  <li>
    <p>Stop the application running from the JAR file if it’s still running.</p>
  </li>
  <li>Run the application from the native executable:
    <pre><code class="language-bash"> ./application
</code></pre>
  </li>
  <li>From a local terminal, run this command to test creating and storing a new <code>Genre</code> in the database:
    <pre><code class="language-bash"> curl -X "POST" "http://[COMPUTE_INSTANCE_PUBLIC_IP]:8080/genres" \
      -H 'Content-Type: application/json; charset=utf-8' \
      -d $'{ "name": "music" }'
</code></pre>
    <p>Then list all genres:</p>
    <pre><code class="language-bash"> curl [COMPUTE_INSTANCE_PUBLIC_IP]:8080/genres/list
</code></pre>
    <p>As a reminder, you do not need to install a Java VM to run the application from a native executable. The native executable is a self-contained binary. Deploying from a native executable significantly reduces application startup time and memory footprint.</p>
  </li>
</ol>
    
      <h2 id="8-clean-up-cloud-resources">
        
        
          8. Clean up Cloud Resources <a href="#8-clean-up-cloud-resources" class="anchor_heading">#</a>
        
        
      </h2>

<p>When you finish using the MySQL DB System, you can <a href="https://docs.oracle.com/iaas/tools/oci-cli/latest/oci_cli_docs/cmdref/mysql/db-system/delete.html" target="_blank">delete it using the CLI</a>. Run the following command:</p>

<pre><code class="language-bash">oci mysql db-system delete \
    --db-system-id ocid1.mysqldbsystem.oc1.iad.aaaaaaaa2pq3a37hftut...
</code></pre>

<p>The output should look like this:</p>
<pre><code class="language-json">{
"opc-work-request-id": "ocid1.mysqlworkrequest.oc1.iad.e68d5dc7-92be-45..."
}
</code></pre>
    
      <h3 id="summary">
        
        
          Summary <a href="#summary" class="anchor_heading">#</a>
        
        
      </h3>

<p>This guide demonstrated how to use GCN to create and connect a database application that stores data in an Oracle Cloud Infrastructure MySQL database using Micronaut Data. You also learned how to package this application into a native executable and deploy it from a virtual machine.</p>
    
      <h3 id="related-documentation">
        
        
          Related Documentation <a href="#related-documentation" class="anchor_heading">#</a>
        
        
      </h3>

<ul>
  <li><a href="https://micronaut-projects.github.io/micronaut-data/latest/guide/" target="_blank">Micronaut Data</a></li>
  <li><a href="https://docs.oracle.com/iaas/mysql-database/index.html" target="_blank">Oracle Cloud Infrastructure MySQL Database</a></li>
  <li><a href="https://graalvm.github.io/native-build-tools/latest/index.html" target="_blank">Native Build Tools</a></li>
  <li><a href="https://www.graalvm.org/native-image/" target="_blank">GraalVM Native Image</a></li>
</ul>

      </div>

      <div role="button" class="menu-btn menu-btn--sidebar js-show-sidebar" title="sweet hamburger">
        <div class="hamburger">
          <div class="inner"></div>
        </div>
      </div>
    </div>
  </div>
</article>



</div>

      </main>

      
<footer class="footer footer__mobile">

  <div class="container-fluid container-fluid--custom-sm">
    <div class="row">
      <div class="col-12 col-sm-12 col-md-12 col-lg-12">
        <div class="row footer-content">
          <div class="col-md-3 col-sm-4">
            <h6 class="title-footer" onclick="fadeInAndOut(this)">Learn</h6>
            <div class="grow">
              <ul class="footer-list">
                <li class="footer-list__item"><a href="/gcn/get-started/">Get Started</a></li>
                <li class="footer-list__item"><a href="/gcn/guides/">Guides</a></li>
                <li class="footer-list__item"><a href="/gcn/hands-on-labs/">Labs</a></li>
                <li class="footer-list__github">
                  <img class="footer__icon" src="/gcn/resources/img/footer/logo-github.svg" alt="Github icon">
                  <a href="https://github.com/oracle/gcn">Github</a>
                </li>
              </ul>
            </div>
          </div>
          <div class="col-md-3 col-sm-4">
            <h6 class="title-footer" onclick="fadeInAndOut(this)">About</h6>
            <div class="grow">
              <ul class="footer-list">
                <li class="footer-list__item"><a href="/gcn/about/#gcn-support" target="blank">Commercial Support</a></li>
                <li class="footer-list__item"><a href="https://www.graalvm.org/" target="blank">GraalVM Native Image</a></li>
                <li class="footer-list__item"><a href="https://micronaut.io/" target="_blank">Micronaut</a></li>
                <li class="footer-list__item"><a href="https://www.oracle.com/cloud/multicloud/what-is-multicloud/" target="_blank">Multicloud</a></li>
                <li class="footer-list__item"><a href="https://www.oracle.com/cloud/" target="blank">Oracle Cloud Infrastructure</a></li>
                <li class="footer-list__item"><a href="https://marketplace.visualstudio.com/items?itemName=oracle-labs-graalvm.graal-cloud-native-pack" target="blank">VS Code Tools</a></li>
              </ul>
            </div>
          </div>
          <div class="col-md-6 col-sm-12 aligning_1024">
            <div class="card--footer card--hovered box">
              <div>
                <div class="rubber-footer footer__oci-section">
                  <p class="title-footer quickstart">Build, test, and deploy applications on Oracle Cloud Infrastructure for free</p>
                  <a href="https://www.oracle.com/cloud/free/" target="_blank"
                    class="btn btn-primary">Try Oracle Cloud Infrastructure Free Tier</a>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="col-12 col-sm-12 col-md-12 col-lg-12">
          <div class="row">
            <div class="col-sm-12">
              <p class="copyright">
                Copyright © 2023, Oracle and/or its affiliates. All rights reserved. Oracle and Java are
                registered trademarks. Other names may be trademarks of their respective owners.
              </p>
              <div id="teconsent"></div>
            </div>
          </div>

        </div>
      </div>

    </div>
  </div>
</footer>

<script>
  function fadeInAndOut(thz) {
    var elmt = thz.nextElementSibling;//Get the element that is below the button that
    //was just clicked
    if (elmt.clientHeight) {
      elmt.style.height = 0;
    } else {
      var wrapper = elmt.querySelector('ul');
      elmt.style.height = wrapper.clientHeight + "px";
    }
    /*
        elmt.classList.toggle("acordianPanelHidden");//Toggle the class which changes
        //attributes which triggers the transition CSS
        */
  }

  // Check TRUSTe Consent for Functional or Implied Approval
  // The if test verifies if the user has given the consent
  if ( (oracle.truste.api.getGdprConsentDecision().consentDecision) &&
      (oracle.truste.api.getGdprConsentDecision().consentDecision.indexOf(0) != -1 ||
        oracle.truste.api.getGdprConsentDecision().consentDecision.indexOf(2) != -1) ) {

      //The following is a sample of a Maxymiser Tag being written to the DOM
      //If the user did not give consent, then the tag is not included and not invoked in the Browser
      document.write('<script type="text/javascript" src="//service.maxymiser.net/cdn/oracle/js/mmcore.js"><\/script>');
  }

  // Check TRUSTe Consent for Advertising or Implied Approval
  // The if test verifies if the user has given the consent
  if ( (oracle.truste.api.getGdprConsentDecision().consentDecision) &&
      (oracle.truste.api.getGdprConsentDecision().consentDecision.indexOf(0) != -1 ||
        oracle.truste.api.getGdprConsentDecision().consentDecision.indexOf(3) != -1) ) {

      //The following is a sample of a BlueKai Core Tag being written to the DOM
      //If the user did not give consent, then the tag is not included and not invoked in the Browser
      document.write('<script type="text/javascript">' +
      'window.bk_async = function() { ' +
      'BKTAG.doTag(62581, 1); }; ' +
      '(function() { ' +
      'var scripts = document.getElementsByTagName(\'script\')[0]; ' +
      'var s = document.createElement(\'script\'); ' +
      's.async = true; ' +
      's.src = "https://tags.bkrtx.com/js/bk-coretag.js"; ' +
      'scripts.parentNode.insertBefore(s, scripts); ' +
      '}()); ' +
      '<\/script>');
  }
</script>

    </div>
    <div class="overlay"></div>

    <!-- Start SiteCatalyst code -->
    <script language="JavaScript" src="https://www.oracle.com/us/assets/metrics/ora_otn.js"></script>
    <!-- End SiteCatalyst code -->

    <script src='/gcn/resources/lib/slick-slider/slick.min.js'></script>
    <script src='/gcn/resources/js/main.js'></script>
    <script src='/gcn/resources/js/ui.js'></script>
    <script src='/gcn/resources/js/filters.js'></script>
    <script src='/gcn/resources/js/sidebar.js'></script>
  </body>
</html>

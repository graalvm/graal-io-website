<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta property="og:image" content="/gcn/resources/img/graalvm.png" />
  <meta name="twitter:widgets:border-color" content="#55acee">

  <title>
    
      Securely Store Application Secrets in AWS Secrets Manager
    
  </title>
  <meta name="description" content="Graal Cloud Native (GCN) is a build of a curated set of Micronaut framework modules and their required libraries for building portable cloud-native microserv..."/>
  <meta name="last_modified" content="2023-11-23 12:00:51 +0000"/>
  <link rel="stylesheet" href="/gcn/assets/main.css">
  <link rel="apple-touch-icon" sizes="180x180" href="/gcn/resources/img/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/gcn/resources/img/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/gcn/resources/img/favicon/favicon-16x16.png">
  <link rel="manifest" href="/resources/img/favicon/site.webmanifest">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
  <meta name="google-site-verification" content="-vRqwa9WYn6AaQGnl88xvrLw6ac4xoKVkZkhanmlRhU" />
  <link rel="canonical" href="https://www.graal.cloud/gcn/gcn-modules/secret-management/micronaut-aws-secretsmanager/">

  <!-- jQuery UI Tabs -->
  <link rel="stylesheet" href="//code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css">
  <link rel="stylesheet" href="/gcn/resources/lib/jquery/jquery-ui.css">
</head>

      <script src="/gcn/resources/lib/jquery/jquery-3.6.1.min.js"></script>
    <script src="/gcn/resources/lib/bootstrap/js/bootstrap.min.js"></script>
    <script src='/gcn/resources/lib/sticky-sidebar/resizeSensor.js'></script>
    <script src='/gcn/resources/lib/sticky-sidebar/sticky-sidebar.min.js'></script>
    <script src="/gcn/resources/lib/highlight/highlight.min.js"></script>
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <!-- Add TRUSTe Consent Script and Analytics -->
    <script async="async" type="text/javascript" src='//consent.trustarc.com/notice?domain=oracle.com&c=teconsent&js=bb&noticeType=bb&text=true&cdn=1&pcookie&gtm=1' crossorigin></script>
    <script src="https://www.oracle.com/assets/truste-oraclelib.js"></script>
    <!-- jQuery UI Tabs -->
    <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.js"></script>


  <body class="preload">

    <div  class="wrapper wrapper--nofooter" >

      <header  class="header header--content" 
  role="banner">

  

  

    <nav class="menu">
      <div class="menu__row">
        <div>
          <a href="/gcn/">
            <img class="logo-mobile" src="/gcn/resources/img/gcn-logo-01.svg" alt="Graal Cloud Native logo">
          </a>
        </div>
        <div class="menu__container">
          <ul class="menu__list">
            <li class="menu__item">
              <a href="/gcn/about/" class="menu__link">About</a>
            </li>
            <li class="menu__item">
              <a href="/gcn/get-started/" class="menu__link">Get Started</a>
            </li>
            <!-- <li class="menu__item">
              <a href="/gcn/modules/" class="menu__link">Modules</a>
            </li>
            <li class="menu__item">
              <a href="/gcn/guides/" class="menu__link">Guides</a>
            </li>
            <li class="menu__item">
              <a href="/gcn/hands-on-labs/" class="menu__link">Hands-On Labs</a>
            </li>
            <li class="menu__item">
              <a href="/gcn/vscode-tools/" class="menu__link">Tools</a>
            </li> -->
            <!-- <li class="menu__launch__mobile">
              <a href="/gcn/launcher/" class="btn-launch btn btn-primary" target="blank">Create App</a>
            </li> -->
            <li class="menu__item">
              <div class="stack-container">
                <a href="#" class="menu__link stack__header">Docs</a>
                <div class="stack-menu-learn">
                  <div class="stack-row">
                    <div class="stack-column">
                      <div class="stack__item">
                        <img src='/gcn/resources/img/header-navigation/modules.svg'>
                        <a href="/gcn/modules/" class="item-line">Modules</a>
                      </div>
                      <div class="stack__item">
                        <img src='/gcn/resources/img/header-navigation/guides.svg'>
                        <a href="/gcn/guides/" class="item-line">Guides</a>
                      </div>
                      <div class="stack__item">
                        <img src='/gcn/resources/img/header-navigation/labs.svg'>
                        <a href="/gcn/hands-on-labs/" class="item-line">Hands-On Labs</a>
                      </div>
                      <div class="stack__item">
                        <img src='/gcn/resources/img/header-navigation/tools.svg'>
                        <a href="/gcn/vscode-tools/" class="item-line">Tools</a>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </li>
            <li class="menu__item">
              <div class="stack-container">
                <a href="#" class="menu__link stack__header">Graal Projects</a>
                <div class="stack-menu">
                  <div class="stack-row">
                    <div class="stack-column">
                      <div class="stack__item">
                        <img src='/gcn/resources/img/header-navigation/graalstack.svg'>
                        <a href="https://graal.cloud/" class="item-line">Graal</a>
                      </div>
                      <div class="stack__item">
                        <img src='/gcn/resources/img/header-navigation/graalvm.svg'>
                        <a href="https://graalvm.org/" class="item-line">GraalVM</a>
                      </div>
                      <div class="stack__item">
                        <img src='/gcn/resources/img/header-navigation/graalos.svg'>
                        <a href="https://graal.cloud/graalos/" class="item-line">GraalOS</a>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </li>
            <li class="menu__launch__mobile">
              <a href="/gcn/launcher/" class="btn-launch btn btn-primary" target="blank">Create App</a>
            </li>
          </ul>
        </div>
        <div class="menu__launch">
          <a href="/gcn/launcher/" class="btn-launch btn btn-primary" target="blank">Create App</a>
        </div>
      </div>

      <div role="button" class="menu-btn menu-btn--menu js-show-menu" tabindex="-1" title="sweet hamburger">
        <div class="hamburger">
          <div class="inner"></div>
        </div>
      </div>
      <button aria-label="hamburger mobile menu" class="btn btn-mobile-menu js-show-menu">
        <div class="inner"></div>
      </button>
    </nav>

  
</header>

<!-- <header  class="header header--content" >

  

  

    <nav class="menu">
      <div class="menu__row">
        <div>
          <a href="/gcn/graal">
            <img class="logo-mobile" src="/gcn/resources/img/gcn-logo-01.svg" alt="Graal Cloud Native logo">
          </a>
        </div>
        <div class="menu__container">
          <ul class="menu__list">
            <li class="menu__item">
              <a href="/gcn/graal/#whatisgraal" class="menu__link">About</a>
            </li>
            <li class="menu__item">
              <a href="https://graalvm.org" class="menu__link">GraalVM</a>
            </li>
            <li class="menu__item">
              <a href="https://graalvm.org" class="menu__link">GraalVM</a>
            </li>
            <li class="menu__item">
              <a href="https://graalvm.org" class="menu__link">GraalVM</a>
            </li>
          </ul>
        </div>
      </div>

      <div role="button" class="menu-btn menu-btn--menu js-show-menu" tabindex="-1" title="sweet hamburger">
        <div class="hamburger">
          <div class="inner"></div>
        </div>
      </div>
      <button aria-label="hamburger mobile menu" class="btn btn-mobile-menu js-show-menu">
        <div class="inner"></div>
      </button>
    </nav>

  
</header> -->

      <main  class="content"   aria-label="Content">
        <div class="wrapper wrapper-content">
  <article>
  <div class="row d-flex flex-wrap">
    <div class="col-sm-3 docsimpro col-bg">
      <div class="sidebar-wrap">
        <div class="sidebar">
          <div class="menuabout">
            <img id="sidebarClose" src="/gcn/resources/img/arrow_sidebar(close).svg" alt="Expand or collapse sidebar"
              class="btn-color no-display">
            <img id="sidebarOpen" src="/gcn/resources/img/arrow_sidebar.svg" alt="Expand or collapse sidebar">
          </div>
          
<div class="toc-floating">


<div class="toc-bullets">


  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    

    
      
        
          <li class="toc-bullets-main">
        
          
          <a href="/gcn/docs/gcn-modules/secret-management/" class="_icon-book">
            Secret Management
          </a>
        </li>

        
        

        
        
          
          <li class="toc-bullets-sub toc-bullets-highlight">
          
            
            <a href="/gcn/gcn-modules/secret-management/micronaut-aws-secretsmanager/">
              Securely Store Application Secrets in AWS Secrets Manager
            </a>
          </li>

          
            <div>
  <script>
    var scriptElement = document.currentScript;
    var div = $(scriptElement.parentElement);
    $(window).on("load", function () {
      $("#content-wrapper h2").each(function () {
        var li = $("<li></li>", { class: "toc-bullets-sub toc-bullets-sub-3" });
        var a = $("<a></a>", { href: "#" + $(this).attr("id") });
        a.text($(this).text().replace('#', ''));
        li.append(a);
        li.click(function (e) {
          e.preventDefault();
          var target = $(a.attr('href'));
          var scrollTo = target.offset().top - 80; // 80 - indent
          $('html, body').animate({ scrollTop: scrollTo }, 1000);
        });
        div.append(li);
      });
    });
  </script>
</div>
          
        
      
    
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

<!-- <li class="search additional-search">
  <form class="form-inline sidebar" action="/docs/search" autocomplete="on" method="get">
    <input class="input-search sidebar" type="text" id="search-box" name="query" placeholder="Search">
    <button type="submit sidebar" class="search-button"></button>
  </form>
</li> -->

</div>
  <!-- Search form -->
  <!-- <form class="search-container" action="/docs/search" autocomplete="on" method="get">
   <label for="search-box">Search</label>
    <input type="text" id="search-box" name="query">
    <button type="submit" class="searchbttn"></button>
  </form> -->
</div>

        </div>
      </div>
    </div>

    <div class="col-sm-9 docsmod">
      <div id="content-wrapper" class="docs-content docs-content--with-sidebar">
        <h1 id="securely-store-application-secrets-in-aws-secrets-manager">
        
        
          Securely Store Application Secrets in AWS Secrets Manager
        
        
      </h1>

<p>This guide describes how to create a Java application that accesses secrets in Amazon Web Services (AWS) Secrets Manager.</p>

<p>Instead of storing a database URL, username, and password in plain text or environment variables, a secret manager provides a convenient way to store API keys, passwords, certificates, and other sensitive data while improving security.</p>
    
      <h3 id="prerequisites">
        
        
          Prerequisites <a href="#prerequisites" class="anchor_heading">#</a>
        
        
      </h3>

<ul>
  <li>JDK 17 or higher. See <a href="/gcn/get-started/setting-up-desktop/">Setting up Your Desktop</a>.</li>
  <li>An Amazon Web Services (AWS) account. See <a href="/gcn/get-started/setting-up-cloud-accounts/">Setting up Your Cloud Accounts</a>.</li>
  <li>The GCN CLI. See <a href="/gcn/get-started/setting-up-desktop/">Setting up Your Desktop</a>. (Optional.)</li>
</ul>

<p>Follow the steps below to create the application from scratch. However, you can also download the completed example in Java.</p>

<div id="tabs-doc1">
    <ul>
        <li class="tabs-gradle"><a name="gradle" href="#gradle">Gradle</a></li>
        <li class="tabs-maven"><a name="maven" href="#maven">Maven</a></li>
    </ul>
    <div id="gradle">
        <p><a href="/gcn/docs/gcn-modules/secret-management/archives/aws-secrets-demo-java-gradle.zip">Gradle AWS Secrets Manager Example <img class="download-img-guides" src="/gcn/resources/img/gcn_modules/download-archive.png" alt="Download completed example" />
        </a>
        </p>
    </div>
    <div id="maven">
        <p><a href="/gcn/docs/gcn-modules/secret-management/archives/aws-secrets-demo-java-maven.zip">Maven AWS Secrets Manager Example <img class="download-img-guides" src="/gcn/resources/img/gcn_modules/download-archive.png" alt="Download completed example" /></a>
        </p>
    </div>
</div>
    
      <h4 id="a-note-regarding-your-development-environment">
        
        
          A note regarding your development environment
        
        
      </h4>

<p>Consider using Visual Studio Code that provides native support for developing applications with the <a href="/gcn/vscode-tools/using-gcn-vscode-tools/">Graal Cloud Native Tools extension</a>.</p>

<blockquote>
  <p>Note: If you use IntelliJ IDEA, <a href="/gcn/resources/img/annotationprocessorsintellij.png">enable annotation processing</a>.</p>
</blockquote>
    
      <h2 id="1-create-the-application">
        
        
          1. Create the Application <a href="#1-create-the-application" class="anchor_heading">#</a>
        
        
      </h2>

<p>Create an application using the GCN Launcher.</p>

<ol>
  <li>
    <p>Open the <a href="/gcn/launcher/?advanced=true">GCN Launcher in advanced mode</a>.</p>
  </li>
  <li>Create a new project using the following selections.
    <ul>
      <li><strong>Project Type</strong>: <em>Application</em> (Default)</li>
      <li><strong>Project Name</strong>: <em>aws-secrets-demo</em></li>
      <li><strong>Base Package</strong>: <em>com.example</em> (Default)</li>
      <li><strong>Clouds</strong>: <em>AWS</em></li>
      <li><strong>Language</strong>: <em>Java</em> (Default)</li>
      <li><strong>Build Tool</strong>: <em>Gradle (Groovy)</em> or <em>Maven</em></li>
      <li><strong>Test Framework</strong>: <em>JUnit</em> (Default)</li>
      <li><strong>Java Version</strong>: <em>17</em> (Default)</li>
      <li><strong>Micronaut Version</strong>: (Default)</li>
      <li><strong>Cloud Services</strong>: <em>Secret Management</em></li>
      <li><strong>Features</strong>: <em>GraalVM Native Image</em> (Default)</li>
      <li><strong>Sample Code</strong>: <em>Yes</em> (Default)</li>
    </ul>
  </li>
  <li>Click <strong>Generate Project</strong>. The GCN Launcher creates an application with the default package <code>com.example</code> in a directory named <em>aws-secrets-demo</em>. The application ZIP file will be downloaded in your default downloads directory. Unzip it, open in your code editor, and proceed to the next steps.</li>
</ol>

<p>Alternatively, use the GCN CLI as follows:</p>

<div id="tabs-doc2">
    <ul>
        <li class="tabs-gradle"><a name="gradle" href="#gradle">Gradle</a></li>
        <li class="tabs-maven"><a name="maven" href="#maven">Maven</a></li>
    </ul>
    <div id="gradle">
        <pre><code class="language-bash">gcn create-app com.example.aws-secrets-demo \
    --clouds=aws \
    --services=secretmanagement \
    --features=graalvm \
    --build=gradle \
    --lang=java</code></pre>
    </div>
    <div id="maven">
        <pre><code class="language-bash">gcn create-app com.example.aws-secrets-demo \
    --clouds=aws \
    --services=secretmanagement \
    --features=graalvm \
    --build=maven \
    --lang=java</code></pre>
    </div>
</div>

<p>For more information, see <a href="/gcn/get-started/using-gcn-cli/">Using the GCN CLI</a>.</p>

<p>GCN adds the OAuth and AWS Secrets Manager dependencies to your build file, as follows</p>

<div id="tabs-doc3">
  <ul>
    <li class="tabs-gradle"><a href="#gradle">Gradle</a></li>
    <li class="tabs-maven"><a href="#maven">Maven</a></li>
  </ul>
  <div id="gradle">
    <p><em>aws/build.gradle</em></p>
    <pre><code class="language-java">implementation("io.micronaut.security:micronaut-security-oauth2")
implementation("io.micronaut.aws:micronaut-aws-secretsmanager")
implementation("io.micronaut.aws:micronaut-aws-sdk-v2")</code></pre>
  </div>
  <div id="maven">
    <p><em>aws/pom.xml</em></p>
    <pre><code class="language-xml">&lt;dependency&gt;
    &lt;groupId&gt;io.micronaut.security&lt;/groupId&gt;
    &lt;artifactId&gt;micronaut-security-oauth2&lt;/artifactId&gt;
    &lt;scope&gt;compile&lt;/scope&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;io.micronaut.aws&lt;/groupId&gt;
    &lt;artifactId&gt;micronaut-aws-secretsmanager&lt;/artifactId&gt;
    &lt;scope&gt;compile&lt;/scope&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;io.micronaut.aws&lt;/groupId&gt;
    &lt;artifactId&gt;micronaut-aws-sdk-v2&lt;/artifactId&gt;
    &lt;version&gt;3.5.1&lt;/version&gt;
    &lt;scope&gt;compile&lt;/scope&gt;
&lt;/dependency&gt;</code></pre>
  </div>
</div>
    
      <h3 id="11-configure-the-application">
        
        
          1.1. Configure the Application <a href="#11-configure-the-application" class="anchor_heading">#</a>
        
        
      </h3>

<p>To enable distributed configuration, GCN has created a configuration file named <em>aws/src/main/resources/bootstrap-ec2.properties</em>. Edit its contents so that it matches the following:</p>

<pre><code>aws.client.system-manager.parameterstore.enabled=true
aws.secretsmanager.secrets[0].prefix=micronaut.security.oauth2.clients.demo-oauth
# &lt;3&gt;
aws.secretsmanager.secrets[0].secret-name=demo-oauth
# &lt;1&gt;
micronaut.application.name=aws
# &lt;2&gt;
micronaut.config-client.enabled=true
</code></pre>
<ol>
  <li>Set the name of the application to <code>gcn-secrets-demo</code>. This name will be used for retrieving secrets.</li>
  <li>Reading and resolving configuration from distributed sources is enabled.</li>
  <li>Define a secret named <code>demo-oauth</code> and specify its prefix. Micronaut will look for a secret with this name in AWS Secrets Manager and load it to the configuration with the prefix.
    <blockquote>
      <p>Note: Read the <a href="https://micronaut-projects.github.io/micronaut-aws/latest/guide/#distributedconfigurationsecretsmanager">Micronaut AWS Secrets Manager integration documentation</a> to find out more about configuring secrets.</p>
    </blockquote>
  </li>
</ol>

<p>When the secret is loaded, the application will create an OAuth Client Configuration named <code>demo-oauth</code> as described in the <a href="https://micronaut-projects.github.io/micronaut-security/latest/guide/#oauth">Micronaut OAuth2 Security documentation</a>. The secret should therefore include a supported OAuth2 credentials configuration. In this example we will create a secret that will include two fields: <code>client-secret</code> and <code>client-id</code>.</p>

<p>To use <code>client-secret</code> and <code>client-id</code> in your application, edit <em>aws/src/main/resources/application-ec2.properties</em> to match the following:</p>

<pre><code>micronaut.security.authentication=cookie
micronaut.security.oauth2.clients.demo-oauth.client-id=${OAUTH_CLIENT_ID\:XXX}
micronaut.security.oauth2.clients.demo-oauth.client-secret=${OAUTH_CLIENT_SECRET\:YYY}
</code></pre>
    
      <h3 id="12-controller">
        
        
          1.2. Controller <a href="#12-controller" class="anchor_heading">#</a>
        
        
      </h3>

<p>The GCN Launcher created an example controller class (named <code>ClientIdController</code>) that exposes the values read from AWS Secrets Manager. The contents of <em>aws/src/main/java/com/example/ClientIdController.java</em> are as follows:</p>

<pre><code class="language-java">package com.example;

import io.micronaut.http.annotation.Controller;
import io.micronaut.http.annotation.Get;
import io.micronaut.security.annotation.Secured;
import io.micronaut.security.oauth2.configuration.OauthClientConfiguration;
import jakarta.inject.Named;

import static io.micronaut.http.MediaType.TEXT_PLAIN;
import static io.micronaut.security.rules.SecurityRule.IS_ANONYMOUS;

@Controller
class ClientIdController {

    private final OauthClientConfiguration oauthClientConfiguration;

    ClientIdController(@Named("demo-oauth") OauthClientConfiguration oauthClientConfiguration) { // &lt;1&gt;
        this.oauthClientConfiguration = oauthClientConfiguration;
    }

    @Secured(IS_ANONYMOUS)
    @Get(uri = "/oauth-client-id", produces = TEXT_PLAIN) // &lt;2&gt;
    public String index() {
        return oauthClientConfiguration.getClientId();
    }
}
</code></pre>
<ol>
  <li>Constructor injection is used to inject a Micronaut OAuth2 client configuration named <code>demo-oauth</code>. It will be configured by setting the <code>micronaut.security.oauth2.clients.demo-oauth</code> property values loaded from AWS Secrets Manager.</li>
  <li>A method to respond to the <code>GET</code> request to the <code>/oauth-client-id</code> route. The response will contain the client id from the OAuth2 configuration. You will use it to test that the configuration is read correctly from a secret.</li>
</ol>

<blockquote>
  <p>Note: The authentication client configuration will automatically be used if a Micronaut client is defined, but this guide only focuses on reading the secret and not using it to authenticate to an external server.</p>
</blockquote>
    
      <h3 id="12-logs">
        
        
          1.2. Logs <a href="#12-logs" class="anchor_heading">#</a>
        
        
      </h3>

<p>To produce a more verbose output when the application starts up, edit the file named <em>aws/src/main/resources/logback.xml</em>. Insert the following <code>&lt;logger&gt;</code> element in the <code>&lt;configuration&gt;</code> element.</p>

<pre><code class="language-xml">&lt;logger name="io.micronaut.aws.distributedconfiguration" level="TRACE"/&gt;
</code></pre>
    
      <h2 id="2-create-the-secret">
        
        
          2. Create the Secret <a href="#2-create-the-secret" class="anchor_heading">#</a>
        
        
      </h2>

<p>Create a secret to be used for OAuth2 in the AWS Secret Manager. The secret includes two fields: <code>client-id</code> and <code>client-secret</code>, which correspond to fields of a Micronaut OAuth2 client configuration. Then use the secret in the application and retrieve it with the controller created in the previous section.</p>
    
      <h3 id="21-create-a-secret-in-the-aws-secret-manager">
        
        
          2.1. Create a Secret in the AWS Secret Manager <a href="#21-create-a-secret-in-the-aws-secret-manager" class="anchor_heading">#</a>
        
        
      </h3>

<ol>
  <li>Sign in to the AWS console. In the header, click <strong>Services</strong>, then in the <strong>Security, Identity &amp; Compliance</strong> section click <strong>Secrets Manager</strong> to open it.</li>
  <li>In the AWS Secrets Manager, click <strong>Store a new secret</strong>. The secret-creation wizard with will open with four steps.</li>
  <li>In the <strong>Secret type</strong> section choose <code>Other type of secret</code>.</li>
  <li>In the <strong>Key/value pairs</strong> section choose <code>Plain text</code> and enter the following secrets (or enter the secrets manually as key-values):
    <pre><code class="language-json">{
    "client-id": "xXx",
    "client-secret": "zZz"
}
</code></pre>
  </li>
  <li>Click <strong>Next</strong> at the bottom of the page to go to the next step.</li>
  <li>Enter <code>/config/gcn-secrets-demo/demo-oauth</code> as the secret name. Skip all the other settings. Click <strong>Next</strong>.
    <blockquote>
      <p>Note: The secret name should be of the <code>/config/[APPLICATION-NAME][-APPLICATION-ENV]/[SECRET-NAME]</code> format where application environment is optional. The name must begin with a slash.</p>
    </blockquote>
  </li>
  <li>Skip the optional <strong>Configure Rotation</strong> step by clicking <strong>Next</strong> again.</li>
  <li>Review the details and click <strong>Store</strong>. You should now see your secret in the secrets list.</li>
</ol>
    
      <h3 id="22-authenticate-to-aws">
        
        
          2.2. Authenticate to AWS <a href="#22-authenticate-to-aws" class="anchor_heading">#</a>
        
        
      </h3>

<p>To test using the secret from AWS Secrets Manager on your local machine, you may use an AWS Access key configured in the AWS CLI. If you do not have the AWS CLI, follow the <a href="https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html">AWS documentation</a> to install or update the latest version of the AWS CLI.</p>

<p>If you do not have an access key, complete the steps in the <a href="https://docs.aws.amazon.com/general/latest/gr/aws-sec-cred-types.html#access-keys-and-secret-access-keys">Programmatic Access section of the AWS Secure Credential Types guide</a> to create a long-term access key for your account. Run <code>aws configure</code> and provide <strong>access key ID</strong> and <strong>secret access key</strong> to authenticate as your user.</p>

<blockquote>
  <p>Note: The AWS SDK will attempt to find the credentials automatically. <a href="https://micronaut-projects.github.io/micronaut-aws/snapshot/guide/index.html#awsCredentials">Micronaut AWS Documentation</a> describes how to supply specific credentials to use instead.</p>
</blockquote>
    
      <h2 id="3-run-the-application">
        
        
          3. Run the Application <a href="#3-run-the-application" class="anchor_heading">#</a>
        
        
      </h2>

<p>To run the application, use the following command, which starts the application on port 8080.</p>

<div id="tabs-doc4">
    <ul>
        <li class="tabs-gradle"><a name="gradle" href="#gradle">Gradle</a></li>
        <li class="tabs-maven"><a name="maven" href="#maven">Maven</a></li>
    </ul>
    <div id="gradle">
        <pre><code class="language-bash">./gradlew :aws:run</code></pre>
    </div>
    <div id="maven">
        <pre><code class="language-bash">./mvnw install -pl lib -am
./mvnw mn:run -pl aws</code></pre>
    </div>
</div>

<p>You should see traces such as:</p>

<pre><code>12:03:48.435 [main] INFO  i.m.context.env.DefaultEnvironment - Established active environments: [ec2]
12:03:48.442 [main] INFO  i.m.context.env.DefaultEnvironment - Established active environments: [ec2]
12:03:48.581 [main] INFO  i.m.context.DefaultBeanContext - Reading bootstrap environment configuration
12:03:50.441 [main] TRACE i.m.a.d.AwsDistributedConfigurationClient - application name: gcn-secrets-demo
12:03:51.673 [main] TRACE i.m.a.d.AwsDistributedConfigurationClient - evaluating 2 keys
12:03:51.673 [main] TRACE i.m.a.d.AwsDistributedConfigurationClient - adding property micronaut.security.oauth2.clients.demo-oauth.client-id from prefix /config/gcn-secrets-demo/
12:03:51.673 [main] TRACE i.m.a.d.AwsDistributedConfigurationClient - adding property micronaut.security.oauth2.clients.demo-oauth.client-secret from prefix /config/gcn-secrets-demo/
12:03:51.673 [main] DEBUG i.m.a.d.AwsDistributedConfigurationClient - Property source awssecretsmanager with #2 items
12:03:51.673 [main] TRACE i.m.a.d.AwsDistributedConfigurationClient - property micronaut.security.oauth2.clients.demo-oauth.client-id resolved
12:03:51.673 [main] TRACE i.m.a.d.AwsDistributedConfigurationClient - property micronaut.security.oauth2.clients.demo-oauth.client-secret resolved
12:03:51.927 [main] INFO  i.m.d.c.c.DistributedPropertySourceLocator - Resolved 1 configuration sources from client: compositeConfigurationClient(AWS Secrets Manager)
12:03:53.022 [main] INFO  io.micronaut.runtime.Micronaut - Startup completed in 6037ms. Server Running: http://localhost:8080
</code></pre>

<p>Test that the secret was loaded correctly by opening <a href="http://localhost:8080/oauth-client-id">http://localhost:8080/oauth-client-id</a> in your browser or using <code>curl</code>:</p>

<pre><code class="language-bash">curl http://localhost:8080/oauth-client-id
</code></pre>

<p>You should see the following response:</p>

<pre><code class="language-bash">xXx
</code></pre>
    
      <h2 id="4-generate-a-native-executable-using-graalvm">
        
        
          4. Generate a Native Executable Using GraalVM <a href="#4-generate-a-native-executable-using-graalvm" class="anchor_heading">#</a>
        
        
      </h2>

<p>GCN supports compiling a Java application ahead-of-time into a native executable using <a href="https://www.graalvm.org/native-image/">GraalVM Native Image</a>. You can use the <em><a href="https://graalvm.github.io/native-build-tools/latest/gradle-plugin.html">Gradle plugin for GraalVM Native Image building</a>/<a href="https://graalvm.github.io/native-build-tools/latest/maven-plugin.html">Maven plugin for GraalVM Native Image building</a></em>. Packaged as a native executable, it significantly reduces application startup time and memory footprint.</p>

<p>To generate a native executable, run the following command:</p>

<div id="tabs-doc5">
  <ul>
    <li class="tabs-gradle"><a name="gradle" href="#gradle">Gradle</a></li>
    <li class="tabs-maven"><a name="maven" href="#maven">Maven</a></li>
  </ul>
  <div id="gradle">
    <pre><code class="language-bash">./gradlew :aws:nativeCompile</code></pre>
    <p>The native executable is created in the <em>aws/build/native/nativeCompile/</em> directory and can be run with the following command:</p>
    <pre><code class="language-bash">aws/build/native/nativeCompile/aws</code></pre>
  </div>
  <div id="maven">
    <pre><code class="language-bash">./mvnw install -pl lib -am
./mvnw package -pl aws -Dpackaging=native-image</code></pre>
    <p>The native executable is created in the <em>aws/target/</em> directory and can be run with the following command:</p>
    <pre><code class="language-bash">aws/target/aws</code></pre>
  </div>
</div>

<p>The application starts on port 8080. Test it as described in the previous section.
The application should behave identically as if you run it from a JAR file, but with reduced startup time and smaller memory footprint.</p>
    
      <h3 id="summary">
        
        
          Summary <a href="#summary" class="anchor_heading">#</a>
        
        
      </h3>

<p>This guide demonstrated how to create a Java application that accesses secrets in Amazon Web Services (AWS) Secrets Manager. You also saw how to package this application into a native executable and deploy it from a virtual machine.</p>
    
      <h3 id="related-documentation">
        
        
          Related Documentation <a href="#related-documentation" class="anchor_heading">#</a>
        
        
      </h3>

<ul>
  <li><a href="https://micronaut-projects.github.io/micronaut-aws/latest/guide/#distributedconfigurationsecretsmanager">Micronaut AWS Secrets Manager integration</a></li>
  <li><a href="https://micronaut-projects.github.io/micronaut-security/latest/guide/#oauth">Micronaut OAuth2 Security</a></li>
  <li><a href="https://aws.amazon.com/secrets-manager/">AWS Secrets Manager</a></li>
  <li><a href="https://www.graalvm.org/native-image/">GraalVM Native Image</a></li>
</ul>

      </div>

      <div role="button" class="menu-btn menu-btn--sidebar js-show-sidebar" title="sweet hamburger">
        <div class="hamburger">
          <div class="inner"></div>
        </div>
      </div>
    </div>
  </div>
</article>



</div>

      </main>

      
<footer class="footer footer__mobile">

  <div class="container-fluid container-fluid--custom-sm">
    <div class="row">
      <div class="col-12 col-sm-12 col-md-12 col-lg-12">
        <div class="row footer-content">
          <div class="col-md-3 col-sm-4">
            <h6 class="title-footer" onclick="fadeInAndOut(this)">Learn</h6>
            <div class="grow">
              <ul class="footer-list">
                <li class="footer-list__item"><a href="/gcn/get-started/">Get Started</a></li>
                <li class="footer-list__item"><a href="/gcn/guides/">Guides</a></li>
                <li class="footer-list__item"><a href="/gcn/hands-on-labs/">Labs</a></li>
                <li class="footer-list__github">
                  <img class="footer__icon" src="/gcn/resources/img/footer/logo-github.svg" alt="Github icon">
                  <a href="https://github.com/oracle/gcn">Github</a>
                </li>
              </ul>
            </div>
          </div>
          <div class="col-md-3 col-sm-4">
            <h6 class="title-footer" onclick="fadeInAndOut(this)">About</h6>
            <div class="grow">
              <ul class="footer-list">
                <li class="footer-list__item"><a href="/gcn/about/#gcn-support" target="blank">Commercial Support</a></li>
                <li class="footer-list__item"><a href="https://www.graalvm.org/" target="blank">GraalVM Native Image</a></li>
                <li class="footer-list__item"><a href="https://micronaut.io/" target="_blank">Micronaut</a></li>
                <li class="footer-list__item"><a href="https://www.oracle.com/cloud/multicloud/what-is-multicloud/" target="_blank">Multicloud</a></li>
                <li class="footer-list__item"><a href="https://www.oracle.com/cloud/" target="blank">Oracle Cloud Infrastructure</a></li>
                <li class="footer-list__item"><a href="https://marketplace.visualstudio.com/items?itemName=oracle-labs-graalvm.graal-cloud-native-pack" target="blank">VS Code Tools</a></li>
              </ul>
            </div>
          </div>
          <div class="col-md-6 col-sm-12 aligning_1024">
            <div class="card--footer card--hovered box">
              <div>
                <div class="rubber-footer footer__oci-section">
                  <p class="title-footer quickstart">Build, test, and deploy applications on Oracle Cloud Infrastructure for free</p>
                  <a href="https://www.oracle.com/cloud/free/" target="_blank"
                    class="btn btn-primary">Try Oracle Cloud Infrastructure Free Tier</a>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="col-12 col-sm-12 col-md-12 col-lg-12">
          <div class="row">
            <div class="col-sm-12">
              <p class="copyright">
                Copyright © 2023, Oracle and/or its affiliates. All rights reserved. Oracle and Java are
                registered trademarks. Other names may be trademarks of their respective owners.
              </p>
              <div id="teconsent"></div>
            </div>
          </div>

        </div>
      </div>

    </div>
  </div>
</footer>

<script>
  function fadeInAndOut(thz) {
    var elmt = thz.nextElementSibling;//Get the element that is below the button that
    //was just clicked
    if (elmt.clientHeight) {
      elmt.style.height = 0;
    } else {
      var wrapper = elmt.querySelector('ul');
      elmt.style.height = wrapper.clientHeight + "px";
    }
    /*
        elmt.classList.toggle("acordianPanelHidden");//Toggle the class which changes
        //attributes which triggers the transition CSS
        */
  }

  // Check TRUSTe Consent for Functional or Implied Approval
  // The if test verifies if the user has given the consent
  if ( (oracle.truste.api.getGdprConsentDecision().consentDecision) &&
      (oracle.truste.api.getGdprConsentDecision().consentDecision.indexOf(0) != -1 ||
        oracle.truste.api.getGdprConsentDecision().consentDecision.indexOf(2) != -1) ) {

      //The following is a sample of a Maxymiser Tag being written to the DOM
      //If the user did not give consent, then the tag is not included and not invoked in the Browser
      document.write('<script type="text/javascript" src="//service.maxymiser.net/cdn/oracle/js/mmcore.js"><\/script>');
  }

  // Check TRUSTe Consent for Advertising or Implied Approval
  // The if test verifies if the user has given the consent
  if ( (oracle.truste.api.getGdprConsentDecision().consentDecision) &&
      (oracle.truste.api.getGdprConsentDecision().consentDecision.indexOf(0) != -1 ||
        oracle.truste.api.getGdprConsentDecision().consentDecision.indexOf(3) != -1) ) {

      //The following is a sample of a BlueKai Core Tag being written to the DOM
      //If the user did not give consent, then the tag is not included and not invoked in the Browser
      document.write('<script type="text/javascript">' +
      'window.bk_async = function() { ' +
      'BKTAG.doTag(62581, 1); }; ' +
      '(function() { ' +
      'var scripts = document.getElementsByTagName(\'script\')[0]; ' +
      'var s = document.createElement(\'script\'); ' +
      's.async = true; ' +
      's.src = "https://tags.bkrtx.com/js/bk-coretag.js"; ' +
      'scripts.parentNode.insertBefore(s, scripts); ' +
      '}()); ' +
      '<\/script>');
  }
</script>

    </div>
    <div class="overlay"></div>

    <!-- Start SiteCatalyst code -->
    <script language="JavaScript" src="https://www.oracle.com/us/assets/metrics/ora_otn.js"></script>
    <!-- End SiteCatalyst code -->

    <script src='/gcn/resources/lib/slick-slider/slick.min.js'></script>
    <script src='/gcn/resources/js/main.js'></script>
    <script src='/gcn/resources/js/ui.js'></script>
    <script src='/gcn/resources/js/filters.js'></script>
    <script src='/gcn/resources/js/sidebar.js'></script>
  </body>
</html>

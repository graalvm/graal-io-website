<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta property="og:image" content="/gcn/resources/img/graalvm.png" />
  <meta name="twitter:widgets:border-color" content="#55acee">

  <title>
    
      Deploying a Java Application to Amazon Elastic Kubernetes Cluster in VS Code
    
  </title>
  <meta name="description" content="Graal Cloud Native (GCN) is a build of a curated set of Micronaut framework modules and their required libraries for building portable cloud-native microserv..."/>
  <meta name="last_modified" content="2024-04-19 13:18:35 +0000"/>
  <meta name="last_built" content="2024-04-24 17:01:47 +0000"/>
  <link rel="stylesheet" href="/gcn/assets/main.css">
  <link rel="apple-touch-icon" sizes="180x180" href="/gcn/resources/img/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/gcn/resources/img/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/gcn/resources/img/favicon/favicon-16x16.png">
  <link rel="manifest" href="/resources/img/favicon/site.webmanifest">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
  <meta name="google-site-verification" content="-vRqwa9WYn6AaQGnl88xvrLw6ac4xoKVkZkhanmlRhU" />
  <link rel="canonical" href="https://www.graal.cloud/gcn/vscode-guides/deploy-to-aws-eks-in-vscode/">

  <!-- jQuery UI Tabs -->
  <link rel="stylesheet" href="//code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css">
  <link rel="stylesheet" href="/gcn/resources/lib/jquery/jquery-ui.css">
</head>

      <script src="/gcn/resources/lib/jquery/jquery-3.6.1.min.js"></script>
    <script src="/gcn/resources/lib/bootstrap/js/bootstrap.min.js"></script>
    <script src='/gcn/resources/lib/sticky-sidebar/resizeSensor.js'></script>
    <script src='/gcn/resources/lib/sticky-sidebar/sticky-sidebar.min.js'></script>
    <script src="/gcn/resources/lib/highlight/highlight.min.js"></script>
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <!-- Add TRUSTe Consent Script and Analytics -->
    <script async="async" type="text/javascript" src='//consent.trustarc.com/notice?domain=oracle.com&c=teconsent&js=bb&noticeType=bb&text=true&cdn=1&pcookie&gtm=1' crossorigin></script>
    <script src="https://www.oracle.com/assets/truste-oraclelib.js"></script>
    <!-- jQuery UI Tabs -->
    <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.js"></script>


  <body class="preload">
    <!-- Start SiteCatalyst code -->
    <script language="JavaScript" src="https://www.oracle.com/us/assets/metrics/ora_otn.js"></script>
    <!-- End SiteCatalyst code -->

    <div  class="wrapper wrapper--nofooter" >

      <header  class="header header--content" 
  role="banner">

  

  

    <nav class="menu">
      <div class="menu__row">
        <div>
          <a href="/gcn/">
            <img class="logo-mobile" src="/gcn/resources/img/gcn-logo-01.svg" alt="Graal Cloud Native logo">
          </a>
        </div>
        <div class="menu__container">
          <ul class="menu__list">
            <li class="menu__item">
              <a href="/gcn/about/" class="menu__link">About</a>
            </li>
            <li class="menu__item">
              <a href="/gcn/get-started/" class="menu__link">Get Started</a>
            </li>
            <li class="menu__item">
              <div class="stack-container">
                <a href="#" class="menu__link stack__header">Docs</a>
                <div class="stack-menu-learn">
                  <div class="stack-row">
                    <div class="stack-column">
                      <div class="stack__item">
                        <img src='/gcn/resources/img/header-navigation/modules.svg'>
                        <a href="/gcn/modules/" class="item-line">Modules</a>
                      </div>
                      <div class="stack__item">
                        <img src='/gcn/resources/img/header-navigation/guides.svg'>
                        <a href="/gcn/guides/" class="item-line">Guides</a>
                      </div>
                      <div class="stack__item">
                        <img src='/gcn/resources/img/header-navigation/labs.svg'>
                        <a href="/gcn/hands-on-labs/" class="item-line">Hands-On Labs</a>
                      </div>
                      <div class="stack__item">
                        <img src='/gcn/resources/img/header-navigation/tools.svg'>
                        <a href="/gcn/vscode-tools/" class="item-line">Tools</a>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </li>
            <li class="menu__item">
              <div class="stack-container">
                <a href="#" class="menu__link stack__header">Graal Projects</a>
                <div class="stack-menu">
                  <div class="stack-row">
                    <div class="stack-column">
                      <div class="stack__item">
                        <img src='/gcn/resources/img/header-navigation/graalstack.svg'>
                        <a href="https://graal.cloud/" class="item-line">Graal</a>
                      </div>
                      <div class="stack__item">
                        <img src='/gcn/resources/img/header-navigation/graalvm.svg'>
                        <a href="https://graalvm.org/" class="item-line">GraalVM</a>
                      </div>
                      <div class="stack__item">
                        <img src='/gcn/resources/img/header-navigation/graalos.svg'>
                        <a href="https://graal.cloud/graalos/" class="item-line">GraalOS</a>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </li>
            <li class="menu__launch__mobile">
              <a href="/gcn/launcher/" class="btn-launch btn btn-primary" target="blank">Create App</a>
            </li>
          </ul>
        </div>
        <div class="menu__launch">
          <a href="/gcn/launcher/" class="btn-launch btn btn-primary" target="blank">Create App</a>
        </div>
      </div>

      <div role="button" class="menu-btn menu-btn--menu js-show-menu" tabindex="-1" title="sweet hamburger">
        <div class="hamburger">
          <div class="inner"></div>
        </div>
      </div>
      <button aria-label="hamburger mobile menu" class="btn btn-mobile-menu js-show-menu">
        <div class="inner"></div>
      </button>
    </nav>

  
</header>


      <main  class="content"   aria-label="Content">
        <div class="wrapper wrapper-content">
  <article>
  <div class="row d-flex flex-wrap">
    <div class="col-sm-3 docsimpro col-bg">
      <div class="sidebar-wrap">
        <div class="sidebar">
          <div class="menuabout">
            <img id="sidebarClose" src="/gcn/resources/img/arrow_sidebar(close).svg" alt="Expand or collapse sidebar"
              class="btn-color no-display">
            <img id="sidebarOpen" src="/gcn/resources/img/arrow_sidebar.svg" alt="Expand or collapse sidebar">
          </div>
          
<div class="toc-floating">


<div class="toc-bullets">


  

  

  

  

  

  

  

  

  
    

    
      
        
          <li class="toc-bullets-main">
        
          
          <a href="/gcn/vscode-tools/installing-gcn-tools/" class="_icon-book">
            Installing Graal Cloud Native Tools
          </a>
        </li>

        
        

        
        
      
    
      
        
          <li class="toc-bullets-main">
        
          
          <a href="/gcn/vscode-tools/graal-cloud-native-extension-pack/" class="_icon-book">
            Graal Cloud Native Extensions Pack
          </a>
        </li>

        
        

        
        
      
    
      
        
          <li class="toc-bullets-main">
        
          
          <a href="/gcn/vscode-guides/" class="_icon-book">
            VS Code Guides
          </a>
        </li>

        
        

        
        
          
          <li class="toc-bullets-sub">
          
            
            <a href="/gcn/vscode-guides/creating-gcn-db-application-with-atp-connection/">
              Creating a Database Application and Connecting to an Oracle Autonomous Database
            </a>
          </li>

          
        
          
          <li class="toc-bullets-sub">
          
            
            <a href="/gcn/vscode-guides/deploy-to-aws-apprunner-in-vscode/">
              Deploying a Java Application to AWS App Runner in VS Code
            </a>
          </li>

          
        
          
          <li class="toc-bullets-sub toc-bullets-highlight">
          
            
            <a href="/gcn/vscode-guides/deploy-to-aws-eks-in-vscode/">
              Deploying a Java Application to Amazon Elastic Kubernetes Cluster in VS Code
            </a>
          </li>

          
            <div>
  <script>
    var scriptElement = document.currentScript;
    var div = $(scriptElement.parentElement);
    $(window).on("load", function () {
      $("#content-wrapper h2").each(function () {
        var li = $("<li></li>", { class: "toc-bullets-sub toc-bullets-sub-3" });
        var a = $("<a></a>", { href: "#" + $(this).attr("id") });
        a.text($(this).text().replace('#', ''));
        li.append(a);
        li.click(function (e) {
          e.preventDefault();
          var target = $(a.attr('href'));
          var scrollTo = target.offset().top - 80; // 80 - indent
          $('html, body').animate({ scrollTop: scrollTo }, 1000);
        });
        div.append(li);
      });
    });
  </script>
</div>
          
        
          
          <li class="toc-bullets-sub">
          
            
            <a href="/gcn/vscode-guides/deploy-to-google-cloud-run-in-vscode/">
              Deploying a Java Application to Google Cloud Run in VS Code
            </a>
          </li>

          
        
          
          <li class="toc-bullets-sub">
          
            
            <a href="/gcn/vscode-guides/deploy-to-google-k8s-engine-in-vscode/">
              Deploying a Java Application to Google Kubernetes Engine in VS Code
            </a>
          </li>

          
        
          
          <li class="toc-bullets-sub">
          
            
            <a href="/gcn/vscode-guides/running-db-application-and-storing-properties-in-oci-vault/">
              Running a Database Application in Oracle Cloud and Storing Properties in OCI Vault from VS Code
            </a>
          </li>

          
        
          
          <li class="toc-bullets-sub">
          
            
            <a href="/gcn/vscode-guides/setting-oci-devops-pipeline-in-vscode/">
              Setting OCI DevOps Build and Development Pipelines in VS Code
            </a>
          </li>

          
        
      
    
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

<!-- <li class="search additional-search">
  <form class="form-inline sidebar" action="/docs/search" autocomplete="on" method="get">
    <input class="input-search sidebar" type="text" id="search-box" name="query" placeholder="Search">
    <button type="submit sidebar" class="search-button"></button>
  </form>
</li> -->

</div>
  <!-- Search form -->
  <!-- <form class="search-container" action="/docs/search" autocomplete="on" method="get">
   <label for="search-box">Search</label>
    <input type="text" id="search-box" name="query">
    <button type="submit" class="searchbttn"></button>
  </form> -->
</div>

        </div>
      </div>
    </div>

    <div class="col-sm-9 docsmod">
      <div id="content-wrapper" class="docs-content docs-content--with-sidebar">
        <h1 id="deploying-a-java-application-to-amazon-elastic-kubernetes-cluster-in-vs-code">
        
        
          Deploying a Java Application to Amazon Elastic Kubernetes Cluster in VS Code
        
        
      </h1>

<p>This guide shows you how to create a Java application, containerize and deploy it to <a href="https://aws.amazon.com/eks/">Amazon Elastic Kubernetes Service (EKS)</a> from within VS Code with ease, using the <a href="https://marketplace.visualstudio.com/items?itemName=oracle-labs-graalvm.gcn">Graal Cloud Native Tools</a>. The <a href="https://micronaut-projects.github.io/micronaut-kubernetes/latest/guide/">Micronaut Kubernetes module</a> provides seamless integration with EKS.</p>

<p><br /></p>

<blockquote>
  <p><a href="https://aws.amazon.com/eks/">EKS</a> is a managed Kubernetes service for deploying containerized applications to the cloud.</p>
</blockquote>

<p><br /></p>
    
      <h3 id="prerequisites">
        
        
          Prerequisites <a href="#prerequisites" class="anchor_heading">#</a>
        
        
      </h3>

<ul>
  <li>JDK 17 or higher. See <a href="/gcn/get-started/setting-up-desktop/">Setting up Your Desktop</a>.</li>
  <li>A Docker-API compatible container runtime such as <a href="https://docs.rancherdesktop.io/getting-started/installation/">Rancher Desktop</a> or <a href="https://www.docker.io/gettingstarted/">Docker</a>.</li>
  <li>An Amazon Web Services (AWS) account. Create an account at <a href="https://portal.aws.amazon.com/billing/signup">Sign up for AWS</a>.</li>
  <li>The <a href="https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html">AWS CLI</a>.</li>
  <li>An AWS user with sufficient permissions to create and manage EKS and <a href="https://aws.amazon.com/ecr/">Amazon Elastic Container Registry (ECR)</a>.</li>
  <li><a href="https://kubernetes.io/docs/reference/kubectl/"><code>kubectl</code></a> to deploy the application to EKS.</li>
</ul>
    
      <h2 id="1-install-extensions">
        
        
          1. Install Extensions <a href="#1-install-extensions" class="anchor_heading">#</a>
        
        
      </h2>

<p>To get started, install the <a href="https://marketplace.visualstudio.com/items?itemName=oracle-labs-graalvm.gcn">Graal Cloud Native Tools</a> and <a href="https://aws.amazon.com/ru/visualstudiocode/">AWS Toolkit for Visual Studio Code</a> extensions.</p>

<ol>
  <li>Follow <a href="/gcn/vscode-tools/installing-gcn-tools/">this guide</a> to install the Graal Cloud Native Tools and its dependencies in VS Code.</li>
  <li>To install the <a href="https://aws.amazon.com/ru/visualstudiocode/">AWS Toolkit for Visual Studio Code</a> plugin, follow these steps:
    <ul>
      <li>In the VS Code Activity Bar, click the <strong>Extensions</strong> icon. This opens the Extensions view, which provides you with access to the VS Code Marketplace.</li>
      <li>In the search box, search for <strong>AWS Toolkit</strong>.</li>
      <li>Once found, choose it to see its details, then click <strong>Install</strong>.</li>
      <li>Once installed, if you’re prompted to restart the editor, click <strong>Reload Required</strong> to finish the installation.</li>
    </ul>

    <p>After you install the Toolkit for VS Code, notice the AWS icon the VS Code Activity Bar.</p>
  </li>
</ol>
    
      <h2 id="2-create-a-java-application-using-gcn-tools">
        
        
          2. Create a Java Application Using GCN Tools <a href="#2-create-a-java-application-using-gcn-tools" class="anchor_heading">#</a>
        
        
      </h2>

<p>Create a Java application to containerize and deploy to Amazon Elastic Kubernetes Service (EKS).</p>

<ol>
  <li>
    <p>Go to <strong>View</strong>, <strong>Command Palette</strong>, search for “gcn”, and invoke the <strong>OCI for GCN: Create GCN Project</strong> quick action:</p>

    <p><img src="/gcn/docs/vscode-tools/images/vs-code/oci/gcn-vscode-actions.png" alt="gcn-vscode-actions.png" /></p>
  </li>
  <li>Follow the command prompts to generate a new Maven or Gradle project. For example, to create a simple Java application:
    <ul>
      <li>Pick Micronaut version: <em>Default</em></li>
      <li>Pick application type: <em>Application</em></li>
      <li>Pick project Java: <em>GraalVM</em> or Other Java</li>
      <li>Provide a project name: <em>aws-k8s-demo</em></li>
      <li>Provide base package: <em>com.example</em></li>
      <li>Pick project services: <em>none</em>. Click <strong>OK</strong> to confirm</li>
      <li>Pick build tool: <em>Gradle (Groovy)</em></li>
      <li>Pick test framework: <em>JUnit</em></li>
      <li>Pick cloud platform: <em>AWS</em>. Click <strong>OK</strong> to confirm</li>
    </ul>
  </li>
  <li>
    <p>Finally, select the destination directory on your local disk and whether to open the created project in a new window or add it to the current workspace. The wizard creates a directory named <em>aws-k8s-demo</em> containing an application in a package named <code>com.example</code>.</p>
  </li>
  <li>
    <p>(Required only for macOS AArch64) At the beginning of the configuration file, <em>aws/build.gradle</em>, add the following dependency to use the appropriate version of JNA:</p>

    <pre><code class="language-bash"> buildscript {
     dependencies {
         classpath("com.github.docker-java:docker-java-transport-httpclient5:3.2.13") {
             because("macOS AArch64 needs a specific version of JNA")
         }
     }
 }
</code></pre>
  </li>
  <li>
    <p>(Required only for macOS AArch64) At the end of the configuration file, <em>aws/build.gradle</em>, add the following code so that Gradle builds a container image using the <code>openjdk:17-slim</code> base image (it defaults to <code>openjdk:17-alpine</code> which is not multiplatform).</p>

    <pre><code class="language-bash"> tasks.withType(com.bmuschko.gradle.docker.tasks.image.Dockerfile) {
     baseImage = 'openjdk:17-slim'
 }
</code></pre>
    
      <h3 id="21-add-a-controller">
        
        
          2.1. Add a Controller <a href="#21-add-a-controller" class="anchor_heading">#</a>
        
        
      </h3>
  </li>
</ol>

<p>To create a microservice that responds with “Hello World”, you need a controller. Create a file named <em>lib/src/main/java/com/example/HelloController.java</em> with the following contents:</p>

<pre><code class="language-java">package com.example;

import io.micronaut.http.MediaType;
import io.micronaut.http.annotation.Controller;
import io.micronaut.http.annotation.Get;
import io.micronaut.http.annotation.Produces;

@Controller // &lt;1&gt;
public class HelloController {
    @Get
    @Produces(MediaType.TEXT_PLAIN) // &lt;2&gt;
    public String index() {
        return "Hello World";
    }

    @Get ("/{name}") // &lt;3&gt;
    @Produces(MediaType.TEXT_PLAIN)
    public String index(String name) {
        return "Hello " + name;
    }
}
</code></pre>

<p><strong>1</strong> The class is defined as a controller with the <a href="https://docs.micronaut.io/4.2.1/api/io/micronaut/http/annotation/Controller.html"><code>@Controller</code></a> annotation mapped to the path <code>/</code> (the default mapping for the base URI).</p>

<p><strong>2</strong> By default, a Micronaut response uses <code>application/json</code> as <code>Content-Type</code>. To return a String, not a JSON object, set it to <code>text/plain</code>.</p>

<p><strong>3</strong> The <a href="https://docs.micronaut.io/4.2.1/api/io/micronaut/http/annotation/Get.html"><code>@Get</code></a> annotation maps the <code>index</code> method to an HTTP GET request on <code>/{name}</code>.</p>
    
      <h3 id="22-build-and-run-the-application">
        
        
          2.2. Build and Run the Application <a href="#22-build-and-run-the-application" class="anchor_heading">#</a>
        
        
      </h3>

<ol>
  <li>
    <p>Open a new Terminal window in VS Code (<strong>Terminal</strong> &gt; <strong>New Terminal</strong>). Enter the following command to build the application JAR file and run it:</p>

    <pre><code class="language-bash"> ./gradlew :aws:run
</code></pre>
    <p>It starts the application on port 8080.</p>
  </li>
  <li>
    <p>Split the Terminal window (<strong>Terminal</strong> &gt; <strong>Split Terminal</strong>) and send some <code>curl</code> requests to test the application in a split terminal:</p>

    <pre><code class="language-bash"> curl http://localhost:8080/
</code></pre>
    <p>It should output “Hello World”.</p>
    <pre><code class="language-bash"> curl http://localhost:8080/GCN/
</code></pre>
    <p>It should output “Hello GCN”.
 Press <code>CTRL+C</code> to stop the application.</p>
  </li>
</ol>
    
      <h2 id="3-create-a-shared-aws-credentials-file-and-connect-to-aws">
        
        
          3. Create a Shared AWS Credentials File and Connect to AWS <a href="#3-create-a-shared-aws-credentials-file-and-connect-to-aws" class="anchor_heading">#</a>
        
        
      </h2>

<p>Follow the instructions provided in the AWS documentation to <a href="https://docs.aws.amazon.com/toolkit-for-vscode/latest/userguide/setup-credentials.html#setup-credentials-set-access-keys">Add your AWS access keys to your environment</a>.</p>

<p>Follow the instructions provided in the AWS documentation to <a href="https://docs.aws.amazon.com/toolkit-for-vscode/latest/userguide/connect.html#connect-to-aws">Connect to AWS through the Toolkit for VS Code</a>.</p>
    
      <h2 id="4-create-a-repository-in-amazon-elastic-container-registry-ecr">
        
        
          4. Create a Repository in Amazon Elastic Container Registry (ECR) <a href="#4-create-a-repository-in-amazon-elastic-container-registry-ecr" class="anchor_heading">#</a>
        
        
      </h2>

<p><a href="https://docs.aws.amazon.com/AmazonECR/latest/userguide/what-is-ecr.html">Amazon Elastic Container Registry (Amazon ECR)</a> is an AWS-managed container image registry service. Amazon ECR supports private repositories with resource-based permissions. Amazon ECR is integrated with Amazon Elastic Container Service (Amazon ECS).</p>

<p><br /></p>

<p>The following steps walk you through what is needed to push a container image to a private Amazon ECR repository using the AWS CLI. Before you begin, make sure that you have necessary software listed in the <a href="#prerequisites">Prerequisites</a>. Also, ensure that you have your AWS account id and region identifier (both of these can be obtained from your AWS console).</p>

<ol>
  <li>
    <p>Authenticate to Amazon ECR with <code>docker</code> (it requires the AWS CLI installed, see <a href="#prerequisites">Prerequisites</a>). The AWS CLI provides a <code>get-login-password</code> command to simplify the authentication process. The Docker CLI (<code>docker</code>) can push and pull images with Amazon ECR.</p>

    <ul>
      <li>Open a Terminal window in VS Code (<strong>Terminal</strong> &gt; <strong>New Terminal</strong>) and enter the following command to authenticate:
        <pre><code class="language-bash">  aws ecr get-login-password --region &lt;region&gt; | docker login --username AWS --password-stdin &lt;aws_account_id&gt;.dkr.ecr.&lt;region&gt;.amazonaws.com
</code></pre>
      </li>
      <li>Replace <em>&lt;region&gt;</em> with your AWS region key. <code>AWS</code> is the default username. The password is composed of <em>&lt;aws_account_id&gt;</em>, which is your AWS account ID, and of the <em>&lt;region&gt;</em> key. For example:
        <pre><code>  aws ecr get-login-password --region us-east-1 | docker login --username AWS --password-stdin 1234567890.dkr.ecr.us-east-1.amazonaws.com
</code></pre>
        <blockquote>
          <p>Note: If you are a Windows user, the command is:</p>
          <pre><code class="language-shell">  (Get-ECRLoginCommand).Password | docker login --username AWS --password-stdin aws_account_id.dkr.ecr.region.amazonaws.com
</code></pre>
          <p>Read more on <a href="https://docs.aws.amazon.com/AmazonECR/latest/userguide/getting-started-cli.html">Using Amazon ECR with the AWS CLI</a>.</p>
        </blockquote>
      </li>
    </ul>
  </li>
  <li>
    <p>Create a repository in Amazon ECR that will hold your containerized application (a container image). Under your active AWS connection, focus on ECR and click <strong>Create Repository</strong>:</p>

    <p><img src="/gcn/docs/vscode-tools/images/vs-code/aws/ecr-create-repository.png" alt="Amazon ECR: Create Repository" /></p>

    <p>Enter a repository name, for example, <em>gcn-demo</em>.</p>
  </li>
  <li>
    <p>Get the repository URI. Open the ECR repositories list, right-click your new repository, and click <strong>Copy Repository URI</strong>:</p>

    <p><img src="/gcn/docs/vscode-tools/images/vs-code/aws/ecr-copy-repo-uri.png" alt="Amazon ECR: Copy Repository URI" /></p>
  </li>
  <li>
    <p>Specify the path to your new repository in the build configuration file, <em>aws/build.gradle</em>, as follows:</p>

    <pre><code class="language-bash"> dockerBuild {
     images = ["&lt;aws_account_id&gt;.dkr.ecr.&lt;region&gt;.amazonaws.com/gcn-demo:$project.version"]
 }
</code></pre>
  </li>
</ol>

<p>You are all set to build a container image for your application and push it to Amazon ECR.</p>
    
      <h2 id="5-containerize-the-application-and-push-a-container-image">
        
        
          5. Containerize the Application and Push a Container Image <a href="#5-containerize-the-application-and-push-a-container-image" class="anchor_heading">#</a>
        
        
      </h2>

<p>In this section, you create a container image of your Java application and then push it to Amazon ECR.</p>

<blockquote>
  <p>Note: The build and deployment architecture must match. You cannot build a container image on an AArch64 platform and deploy it to an Intel-based platform, such as Amazon Elastic Compute Cloud (Amazon EC2) or Amazon Elastic Kubernetes Service (Amazon EKS).</p>
</blockquote>

<ol>
  <li>Build the project in your VS Code terminal:
    <pre><code class="language-bash"> ./gradlew clean build
</code></pre>
  </li>
  <li>Build a container image of the application. Note that, because you created the application using GCN Tools in VS Code, you do not need to provide a Dockerfile. It is provided by the extension at build time.
    <pre><code class="language-bash"> ./gradlew dockerBuild
</code></pre>
  </li>
  <li>Query <code>docker</code> to list your newly built container image:
    <pre><code class="language-bash">docker images | head -n2
</code></pre>
  </li>
  <li>Push the container image to the container repository:
    <pre><code class="language-bash"> ./gradlew dockerPush
</code></pre>
  </li>
</ol>

<p>Now that your container image is stored in Amazon ECR, you can deploy it to an Amazon EKS cluster.</p>
    
      <h2 id="6-create-an-amazon-eks-cluster-and-setup-connection-to-your-cluster">
        
        
          6. Create an Amazon EKS Cluster and Setup Connection to Your Cluster <a href="#6-create-an-amazon-eks-cluster-and-setup-connection-to-your-cluster" class="anchor_heading">#</a>
        
        
      </h2>

<p>Follow the AWS documentation to <a href="https://docs.aws.amazon.com/eks/latest/userguide/getting-started-console.html">Create an Amazon EKS cluster, Configure Your Computer to Communicate with Your Cluster, and Create Nodes</a>.</p>

<blockquote>
  <p>Do not follow the <a href="https://docs.aws.amazon.com/eks/latest/userguide/getting-started-console.html#gs-console-clean-up">Step 5: Delete resources</a> chapter at this point.</p>
</blockquote>
    
      <h2 id="7-deploy-a-java-application-to-eks-cluster">
        
        
          7. Deploy a Java Application to EKS Cluster <a href="#7-deploy-a-java-application-to-eks-cluster" class="anchor_heading">#</a>
        
        
      </h2>

<ol>
  <li>
    <p>Create a Kubernetes deployment manifest file. In the project root, create a file named <em>deployment.yml</em> with the following contents:</p>

    <pre><code class="language-yml"> apiVersion: apps/v1
 kind: Deployment
 metadata:
   name: "aws-k8s-demo"
 spec:
   selector:
     matchLabels:
       app: "aws-k8s-demo"
   template:
     metadata:
       labels:
         app: "aws-k8s-demo"
     spec:
       containers:
       - name: "aws-k8s-demo"
         image: "&lt;aws_account_id&gt;.dkr.ecr.&lt;region&gt;.amazonaws.com/gcn-demo:1.0-SNAPSHOT"
</code></pre>

    <p>(Copy the repository URI from the build configuration file, <em>aws/build.gradle</em>.)
 To learn more, see <a href="https://kubernetes.io/docs/concepts/workloads/controllers/deployment/">Deployments in the Kubernetes documentation</a>.</p>
  </li>
  <li>
    <p>Create a deployment by applying the manifest:</p>

    <pre><code class="language-bash"> kubectl apply -f deployment.yml
</code></pre>
    <p>It should output the following:</p>
    <pre>
 deployment.apps/aws-k8s-demo created
 </pre>
    <p>This deployment pulls your container image from a public repository (Amazon ECR repository) and deploys three replicas (individual pods) of it to your cluster.</p>
  </li>
  <li>
    <p>Run the next command to check the status of the pods:</p>

    <pre><code class="language-bash"> kubectl get pods
</code></pre>
    <p>It should return a similar message:</p>
    <pre>
 NAME                               READY   STATUS    RESTARTS   AGE
 aws-k8s-demo-6fdf89f45-5rpsp       0/1     Pending   0          3m
 </pre>
    <p>Wait a couple of seconds for the <code>Pending</code> state to change to <code>Running</code>.
 Your application is now deployed to the EKS cluster.</p>
  </li>
  <li>
    <p>Port-forward the port to access your Kubernetes cluster directly from your local network:</p>

    <pre><code class="language-bash"> kubectl port-forward &lt;pod-name&gt; 8080:8080
</code></pre>
    <p><code>kubectl port-forward</code> uses a resource name, such as a pod name, to select a matching pod to port forward.</p>
  </li>
  <li>
    <p>Send some <code>curl</code> requests to test your application as you did in step <strong>2.2</strong>:</p>

    <pre><code class="language-bash"> curl http://localhost:8080/
</code></pre>
    <pre><code class="language-bash"> curl http://localhost:8080/GCN/
</code></pre>

    <p>The difference is that now your application is deployed to an EKS cluster and running on an Amazon EC2 Linux compute host.</p>
    
      <h2 id="8-clean-up-resources">
        
        
          8. Clean Up Resources <a href="#8-clean-up-resources" class="anchor_heading">#</a>
        
        
      </h2>
  </li>
</ol>

<p>To delete all the resources you created in this guide, run this command:</p>

<pre><code class="language-bash">kubectl delete namespaces &lt;namespace-name&gt;
</code></pre>

<!-- > Note: If you were following the [Getting started with Amazon EKS – AWS Management Console and AWS CLI](https://docs.aws.amazon.com/eks/latest/userguide/getting-started-console.html) and you want to clean up everything, do not follow the [Step 5: Delete resources](https://docs.aws.amazon.com/eks/latest/userguide/getting-started-console.html#gs-console-clean-up) chapter. -->
    
      <h3 id="summary">
        
        
          Summary <a href="#summary" class="anchor_heading">#</a>
        
        
      </h3>

<p>This guide demonstrated how to deploy a Java microservice application to Amazon Elastic Kubernetes Service (EKS) from within VS Code with ease, using the GCN Tools.</p>
    
      <h3 id="related-documentation">
        
        
          Related Documentation <a href="#related-documentation" class="anchor_heading">#</a>
        
        
      </h3>

<ul>
  <li><a href="https://micronaut-projects.github.io/micronaut-kubernetes/latest/guide/">Micronaut Kubernetes module</a></li>
  <li><a href="https://docs.aws.amazon.com/eks/">Amazon Elastic Kubernetes Service (EKS)</a></li>
  <li><a href="https://marketplace.visualstudio.com/items?itemName=oracle-labs-graalvm.gcn">Graal Cloud Native Tools</a></li>
</ul>

      </div>

      <div role="button" class="menu-btn menu-btn--sidebar js-show-sidebar" title="sweet hamburger">
        <div class="hamburger">
          <div class="inner"></div>
        </div>
      </div>
    </div>
  </div>
</article>

</div>

      </main>

      
<footer class="footer footer__mobile">

  <div class="container-fluid container-fluid--custom-sm">
    <div class="row">
      <div class="col-12 col-sm-12 col-md-12 col-lg-12">
        <div class="row footer-content">
          <div class="col-md-3 col-sm-4">
            <h6 class="title-footer" onclick="fadeInAndOut(this)">Learn</h6>
            <div class="grow">
              <ul class="footer-list">
                <li class="footer-list__item"><a href="/gcn/get-started/">Get Started</a></li>
                <li class="footer-list__item"><a href="/gcn/guides/">Guides</a></li>
                <li class="footer-list__item"><a href="/gcn/hands-on-labs/">Labs</a></li>
                <li class="footer-list__github">
                  <img class="footer__icon" src="/gcn/resources/img/footer/logo-github.svg" alt="Github icon">
                  <a href="https://github.com/oracle/gcn" target="blank">Github</a>
                </li>
                <li class="footer-list__github">
                  <img class="footer__icon" src="/gcn/resources/img/footer/slack-icon.svg" alt="Github icon">
                  <a href="https://bit.ly/odevrel_slack" target="blank">Join us at: #graal-cloud-native</a>
                </li>
              </ul>
            </div>
          </div>
          <div class="col-md-3 col-sm-4">
            <h6 class="title-footer" onclick="fadeInAndOut(this)">About</h6>
            <div class="grow">
              <ul class="footer-list">
                <li class="footer-list__item"><a href="/gcn/about/#support" target="blank">Commercial Support</a></li>
                <li class="footer-list__item"><a href="https://www.graalvm.org/" target="blank">GraalVM Native Image</a></li>
                <li class="footer-list__item"><a href="https://micronaut.io/" target="_blank">Micronaut</a></li>
                <li class="footer-list__item"><a href="https://www.oracle.com/cloud/multicloud/what-is-multicloud/" target="_blank">Multicloud</a></li>
                <li class="footer-list__item"><a href="https://www.oracle.com/cloud/" target="blank">Oracle Cloud Infrastructure</a></li>
                <li class="footer-list__item"><a href="https://marketplace.visualstudio.com/items?itemName=oracle-labs-graalvm.graal-cloud-native-pack" target="blank">VS Code Tools</a></li>
              </ul>
            </div>
          </div>
          <div class="col-md-6 col-sm-12 aligning_1024">
            <div class="card--footer card--hovered box">
              <div>
                <div class="rubber-footer footer__oci-section">
                  <p class="title-footer quickstart">Build, test, and deploy applications on Oracle Cloud Infrastructure for free</p>
                  <a href="https://www.oracle.com/cloud/free/" target="_blank"
                    class="btn btn-primary">Try Oracle Cloud Infrastructure Free Tier</a>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="col-12 col-sm-12 col-md-12 col-lg-12">
          <div class="row">
            <div class="col-sm-12">
              <p class="copyright">
                Copyright © 2023-2024, Oracle and/or its affiliates. All rights reserved.
                Oracle and Java are registered trademarks of Oracle and/or its affiliates.
                Other names may be trademarks of their respective owners.
              </p>
              <div id="teconsent"></div>
            </div>
          </div>

        </div>
      </div>

    </div>
  </div>
</footer>

<script>
  function fadeInAndOut(thz) {
    var elmt = thz.nextElementSibling;//Get the element that is below the button that
    //was just clicked
    if (elmt.clientHeight) {
      elmt.style.height = 0;
    } else {
      var wrapper = elmt.querySelector('ul');
      elmt.style.height = wrapper.clientHeight + "px";
    }
    /*
        elmt.classList.toggle("acordianPanelHidden");//Toggle the class which changes
        //attributes which triggers the transition CSS
        */
  }

  // Check TRUSTe Consent for Functional or Implied Approval
  // The if test verifies if the user has given the consent
  if ( (oracle.truste.api.getGdprConsentDecision().consentDecision) &&
      (oracle.truste.api.getGdprConsentDecision().consentDecision.indexOf(0) != -1 ||
        oracle.truste.api.getGdprConsentDecision().consentDecision.indexOf(2) != -1) ) {

      //The following is a sample of a Maxymiser Tag being written to the DOM
      //If the user did not give consent, then the tag is not included and not invoked in the Browser
      document.write('<script type="text/javascript" src="//service.maxymiser.net/cdn/oracle/js/mmcore.js"><\/script>');
  }

  // Check TRUSTe Consent for Advertising or Implied Approval
  // The if test verifies if the user has given the consent
  if ( (oracle.truste.api.getGdprConsentDecision().consentDecision) &&
      (oracle.truste.api.getGdprConsentDecision().consentDecision.indexOf(0) != -1 ||
        oracle.truste.api.getGdprConsentDecision().consentDecision.indexOf(3) != -1) ) {

      //The following is a sample of a BlueKai Core Tag being written to the DOM
      //If the user did not give consent, then the tag is not included and not invoked in the Browser
      document.write('<script type="text/javascript">' +
      'window.bk_async = function() { ' +
      'BKTAG.doTag(62581, 1); }; ' +
      '(function() { ' +
      'var scripts = document.getElementsByTagName(\'script\')[0]; ' +
      'var s = document.createElement(\'script\'); ' +
      's.async = true; ' +
      's.src = "https://tags.bkrtx.com/js/bk-coretag.js"; ' +
      'scripts.parentNode.insertBefore(s, scripts); ' +
      '}()); ' +
      '<\/script>');
  }
</script>

    </div>
    <div class="overlay"></div>

    <!-- Start SiteCatalyst code -->
    <script language="JavaScript" src="https://www.oracle.com/us/assets/metrics/ora_otn.js"></script>
    <!-- End SiteCatalyst code -->

    <script src='/gcn/resources/lib/slick-slider/slick.min.js'></script>
    <script src='/gcn/resources/js/main.js'></script>
    <script src='/gcn/resources/js/ui.js'></script>
    <script src='/gcn/resources/js/filters.js'></script>
    <script src='/gcn/resources/js/sidebar.js'></script>
    <script src='/gcn/resources/js/labs.js'></script>
    <script src='/gcn/resources/lib/highlight/highlight.min.js'></script> 
    <script>hljs.highlightAll();</script>
  </body>
</html>
